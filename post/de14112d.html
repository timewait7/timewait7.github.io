<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"timewait7.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":true,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Shell贪吃蛇实现指南我将带你一步步实现一个终端贪吃蛇游戏，通过这个项目提升shell编程能力。我们将从简单开始，逐步增加功能。 设计思路1. 整体架构 使用ANSI转义码控制光标和颜色 通过stty和read实现非阻塞键盘输入 用二维数组表示游戏区域 使用数组存储蛇身坐标 定时器控制游戏循环  2. 核心组件 游戏区域绘制 蛇的移动逻辑 食物生成 碰撞检测 分数系统  逐步实现步骤1：基础环境">
<meta property="og:type" content="article">
<meta property="og:title" content="Shell实践:贪吃蛇">
<meta property="og:url" content="http://timewait7.github.io/post/de14112d.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Shell贪吃蛇实现指南我将带你一步步实现一个终端贪吃蛇游戏，通过这个项目提升shell编程能力。我们将从简单开始，逐步增加功能。 设计思路1. 整体架构 使用ANSI转义码控制光标和颜色 通过stty和read实现非阻塞键盘输入 用二维数组表示游戏区域 使用数组存储蛇身坐标 定时器控制游戏循环  2. 核心组件 游戏区域绘制 蛇的移动逻辑 食物生成 碰撞检测 分数系统  逐步实现步骤1：基础环境">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-12-18T15:15:36.000Z">
<meta property="article:modified_time" content="2025-12-18T15:17:38.675Z">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://timewait7.github.io/post/de14112d.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://timewait7.github.io/post/de14112d.html","path":"post/de14112d.html","title":"Shell实践:贪吃蛇"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Shell实践:贪吃蛇 | Hexo</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hexo</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-archives"><a href="/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Shell%E8%B4%AA%E5%90%83%E8%9B%87%E5%AE%9E%E7%8E%B0%E6%8C%87%E5%8D%97"><span class="nav-number">1.</span> <span class="nav-text">Shell贪吃蛇实现指南</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="nav-number">1.1.</span> <span class="nav-text">设计思路</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84"><span class="nav-number">1.1.1.</span> <span class="nav-text">1. 整体架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="nav-number">1.1.2.</span> <span class="nav-text">2. 核心组件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%90%E6%AD%A5%E5%AE%9E%E7%8E%B0"><span class="nav-number">1.2.</span> <span class="nav-text">逐步实现</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A41%EF%BC%9A%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83%E8%AE%BE%E7%BD%AE"><span class="nav-number">1.2.1.</span> <span class="nav-text">步骤1：基础环境设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A42%EF%BC%9A%E6%B8%B8%E6%88%8F%E5%8C%BA%E5%9F%9F%E7%BB%98%E5%88%B6%E5%87%BD%E6%95%B0"><span class="nav-number">1.2.2.</span> <span class="nav-text">步骤2：游戏区域绘制函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A43%EF%BC%9A%E9%A3%9F%E7%89%A9%E7%94%9F%E6%88%90%E4%B8%8E%E7%BB%98%E5%88%B6"><span class="nav-number">1.2.3.</span> <span class="nav-text">步骤3：食物生成与绘制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A44%EF%BC%9A%E8%BE%93%E5%85%A5%E5%A4%84%E7%90%86"><span class="nav-number">1.2.4.</span> <span class="nav-text">步骤4：输入处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A45%EF%BC%9A%E8%9B%87%E7%9A%84%E7%A7%BB%E5%8A%A8%E9%80%BB%E8%BE%91"><span class="nav-number">1.2.5.</span> <span class="nav-text">步骤5：蛇的移动逻辑</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A46%EF%BC%9A%E6%B8%B8%E6%88%8F%E4%B8%BB%E5%BE%AA%E7%8E%AF"><span class="nav-number">1.2.6.</span> <span class="nav-text">步骤6：游戏主循环</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A47%EF%BC%9A%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81%E6%95%B4%E5%90%88%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="nav-number">1.2.7.</span> <span class="nav-text">步骤7：完整代码整合与使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A9%E5%B1%95%E5%8A%9F%E8%83%BD%E5%BB%BA%E8%AE%AE"><span class="nav-number">1.3.</span> <span class="nav-text">扩展功能建议</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E8%A6%81%E7%82%B9"><span class="nav-number">1.4.</span> <span class="nav-text">学习要点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Shell%E8%B4%AA%E5%90%83%E8%9B%87%E6%89%A9%E5%B1%95%E5%8A%9F%E8%83%BD"><span class="nav-number">2.</span> <span class="nav-text">Shell贪吃蛇扩展功能</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A9%E5%B1%951%EF%BC%9A%E9%9A%BE%E5%BA%A6%E7%BA%A7%E5%88%AB%E5%92%8C%E9%80%9F%E5%BA%A6%E6%8E%A7%E5%88%B6"><span class="nav-number">2.1.</span> <span class="nav-text">扩展1：难度级别和速度控制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E9%9A%BE%E5%BA%A6%E9%80%89%E6%8B%A9%E8%8F%9C%E5%8D%95"><span class="nav-number">2.1.1.</span> <span class="nav-text">添加难度选择菜单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E7%A7%BB%E5%8A%A8%E9%80%BB%E8%BE%91%E6%94%AF%E6%8C%81%E6%97%A0%E5%B0%BD%E6%A8%A1%E5%BC%8F"><span class="nav-number">2.1.2.</span> <span class="nav-text">修改移动逻辑支持无尽模式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A9%E5%B1%952%EF%BC%9A%E6%B7%BB%E5%8A%A0%E9%9A%9C%E7%A2%8D%E7%89%A9"><span class="nav-number">2.2.</span> <span class="nav-text">扩展2：添加障碍物</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A9%E5%B1%953%EF%BC%9A%E9%AB%98%E5%88%86%E8%AE%B0%E5%BD%95%E7%B3%BB%E7%BB%9F"><span class="nav-number">2.3.</span> <span class="nav-text">扩展3：高分记录系统</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A9%E5%B1%954%EF%BC%9A%E6%9A%82%E5%81%9C%E5%92%8C%E5%B8%AE%E5%8A%A9%E5%8A%9F%E8%83%BD"><span class="nav-number">2.4.</span> <span class="nav-text">扩展4：暂停和帮助功能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A9%E5%B1%955%EF%BC%9A%E8%A7%86%E8%A7%89%E6%95%88%E6%9E%9C%E5%A2%9E%E5%BC%BA"><span class="nav-number">2.5.</span> <span class="nav-text">扩展5：视觉效果增强</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%A9%E5%B1%956%EF%BC%9A%E6%B8%B8%E6%88%8F%E4%BF%A1%E6%81%AF%E6%98%BE%E7%A4%BA%E5%A2%9E%E5%BC%BA"><span class="nav-number">2.6.</span> <span class="nav-text">扩展6：游戏信息显示增强</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BB%E5%87%BD%E6%95%B0%E4%BF%AE%E6%94%B9"><span class="nav-number">2.7.</span> <span class="nav-text">主函数修改</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"><span class="nav-number">2.8.</span> <span class="nav-text">使用说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%B0%E5%A2%9E%E5%8A%9F%E8%83%BD%E6%80%BB%E7%BB%93"><span class="nav-number">2.9.</span> <span class="nav-text">新增功能总结</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/">
          <span class="site-state-item-count">61</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://timewait7.github.io/post/de14112d.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Shell实践:贪吃蛇 | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Shell实践:贪吃蛇
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-12-18 23:15:36" itemprop="dateCreated datePublished" datetime="2025-12-18T23:15:36+08:00">2025-12-18</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>4.7k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>17 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="Shell贪吃蛇实现指南"><a href="#Shell贪吃蛇实现指南" class="headerlink" title="Shell贪吃蛇实现指南"></a>Shell贪吃蛇实现指南</h1><p>我将带你一步步实现一个终端贪吃蛇游戏，通过这个项目提升shell编程能力。我们将从简单开始，逐步增加功能。</p>
<h2 id="设计思路"><a href="#设计思路" class="headerlink" title="设计思路"></a>设计思路</h2><h3 id="1-整体架构"><a href="#1-整体架构" class="headerlink" title="1. 整体架构"></a>1. 整体架构</h3><ul>
<li>使用ANSI转义码控制光标和颜色</li>
<li>通过<code>stty</code>和<code>read</code>实现非阻塞键盘输入</li>
<li>用二维数组表示游戏区域</li>
<li>使用数组存储蛇身坐标</li>
<li>定时器控制游戏循环</li>
</ul>
<h3 id="2-核心组件"><a href="#2-核心组件" class="headerlink" title="2. 核心组件"></a>2. 核心组件</h3><ul>
<li>游戏区域绘制</li>
<li>蛇的移动逻辑</li>
<li>食物生成</li>
<li>碰撞检测</li>
<li>分数系统</li>
</ul>
<h2 id="逐步实现"><a href="#逐步实现" class="headerlink" title="逐步实现"></a>逐步实现</h2><h3 id="步骤1：基础环境设置"><a href="#步骤1：基础环境设置" class="headerlink" title="步骤1：基础环境设置"></a>步骤1：基础环境设置</h3><p>首先创建一个新文件并设置基础结构：</p>
<p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line"># 文件名：snake_game.sh</span><br><span class="line"></span><br><span class="line"># 设置游戏区域大小</span><br><span class="line">readonly WIDTH=30</span><br><span class="line">readonly HEIGHT=20</span><br><span class="line"></span><br><span class="line"># 游戏状态</span><br><span class="line">score=0</span><br><span class="line">game_over=0</span><br><span class="line">direction=&quot;right&quot;</span><br><span class="line"></span><br><span class="line"># 初始化蛇</span><br><span class="line">snake_x=(15 14 13)</span><br><span class="line">snake_y=(10 10 10)</span><br><span class="line">snake_length=3</span><br><span class="line"></span><br><span class="line"># 食物位置</span><br><span class="line">food_x=0</span><br><span class="line">food_y=0</span><br><span class="line"></span><br><span class="line"># 设置终端</span><br><span class="line">init_terminal() &#123;</span><br><span class="line">    # 隐藏光标</span><br><span class="line">    echo -ne &quot;\033[?25l&quot;</span><br><span class="line">    </span><br><span class="line">    # 设置非阻塞输入</span><br><span class="line">    stty -echo -icanon time 0 min 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 恢复终端</span><br><span class="line">cleanup() &#123;</span><br><span class="line">    # 显示光标</span><br><span class="line">    echo -ne &quot;\033[?25h&quot;</span><br><span class="line">    </span><br><span class="line">    # 恢复终端设置</span><br><span class="line">    stty echo icanon</span><br><span class="line">    </span><br><span class="line">    # 清屏并重置光标</span><br><span class="line">    echo -e &quot;\033[2J\033[H&quot;</span><br><span class="line">    exit 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 捕获退出信号</span><br><span class="line">trap cleanup EXIT INT TERM</span><br><span class="line"></span><br><span class="line">init_terminal</span><br></pre></td></tr></table></figure>



<h3 id="步骤2：游戏区域绘制函数"><a href="#步骤2：游戏区域绘制函数" class="headerlink" title="步骤2：游戏区域绘制函数"></a>步骤2：游戏区域绘制函数</h3><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"># 绘制边框</span><br><span class="line">draw_border() &#123;</span><br><span class="line">    # 设置颜色</span><br><span class="line">    echo -ne &quot;\033[1;34m&quot;</span><br><span class="line">    </span><br><span class="line">    # 绘制上边框</span><br><span class="line">    echo -ne &quot;\033[1;1H&quot;</span><br><span class="line">    echo -n &quot;+&quot;</span><br><span class="line">    for ((i=1; i&lt;=WIDTH; i++)); do</span><br><span class="line">        echo -n &quot;-&quot;</span><br><span class="line">    done</span><br><span class="line">    echo &quot;+&quot;</span><br><span class="line">    </span><br><span class="line">    # 绘制两侧边框</span><br><span class="line">    for ((i=1; i&lt;=HEIGHT; i++)); do</span><br><span class="line">        echo -ne &quot;\033[$((i+1));1H&quot;</span><br><span class="line">        echo -n &quot;|&quot;</span><br><span class="line">        echo -ne &quot;\033[$((i+1));$((WIDTH+2))H&quot;</span><br><span class="line">        echo -n &quot;|&quot;</span><br><span class="line">    done</span><br><span class="line">    </span><br><span class="line">    # 绘制下边框</span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT+2));1H&quot;</span><br><span class="line">    echo -n &quot;+&quot;</span><br><span class="line">    for ((i=1; i&lt;=WIDTH; i++)); do</span><br><span class="line">        echo -n &quot;-&quot;</span><br><span class="line">    done</span><br><span class="line">    echo &quot;+&quot;</span><br><span class="line">    </span><br><span class="line">    # 重置颜色</span><br><span class="line">    echo -ne &quot;\033[0m&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 绘制蛇</span><br><span class="line">draw_snake() &#123;</span><br><span class="line">    # 绘制蛇头（使用不同颜色）</span><br><span class="line">    echo -ne &quot;\033[$((snake_y[0]+1));$((snake_x[0]+1))H&quot;</span><br><span class="line">    echo -ne &quot;\033[1;32m@\033[0m&quot;</span><br><span class="line">    </span><br><span class="line">    # 绘制蛇身</span><br><span class="line">    for ((i=1; i&lt;snake_length; i++)); do</span><br><span class="line">        echo -ne &quot;\033[$((snake_y[i]+1));$((snake_x[i]+1))H&quot;</span><br><span class="line">        echo -ne &quot;\033[1;33mo\033[0m&quot;</span><br><span class="line">    done</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 清除蛇尾</span><br><span class="line">clear_tail() &#123;</span><br><span class="line">    if [ $&#123;#snake_x[@]&#125; -gt $snake_length ]; then</span><br><span class="line">        local tail_index=$snake_length</span><br><span class="line">        echo -ne &quot;\033[$((snake_y[tail_index]+1));$((snake_x[tail_index]+1))H&quot;</span><br><span class="line">        echo -n &quot; &quot;</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="步骤3：食物生成与绘制"><a href="#步骤3：食物生成与绘制" class="headerlink" title="步骤3：食物生成与绘制"></a>步骤3：食物生成与绘制</h3><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># 生成食物</span><br><span class="line">generate_food() &#123;</span><br><span class="line">    local valid=0</span><br><span class="line">    </span><br><span class="line">    while [ $valid -eq 0 ]; do</span><br><span class="line">        valid=1</span><br><span class="line">        food_x=$((RANDOM % WIDTH))</span><br><span class="line">        food_y=$((RANDOM % HEIGHT))</span><br><span class="line">        </span><br><span class="line">        # 检查食物是否与蛇身重叠</span><br><span class="line">        for ((i=0; i&lt;snake_length; i++)); do</span><br><span class="line">            if [ $&#123;snake_x[$i]&#125; -eq $food_x ] &amp;&amp; [ $&#123;snake_y[$i]&#125; -eq $food_y ]; then</span><br><span class="line">                valid=0</span><br><span class="line">                break</span><br><span class="line">            fi</span><br><span class="line">        done</span><br><span class="line">    done</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 绘制食物</span><br><span class="line">draw_food() &#123;</span><br><span class="line">    echo -ne &quot;\033[$((food_y+1));$((food_x+1))H&quot;</span><br><span class="line">    echo -ne &quot;\033[1;31m*\033[0m&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="步骤4：输入处理"><a href="#步骤4：输入处理" class="headerlink" title="步骤4：输入处理"></a>步骤4：输入处理</h3><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># 处理键盘输入</span><br><span class="line">handle_input() &#123;</span><br><span class="line">    local key</span><br><span class="line">    IFS= read -rsn1 -t 0.1 key</span><br><span class="line">    </span><br><span class="line">    case &quot;$key&quot; in</span><br><span class="line">        &quot;w&quot;|&quot;W&quot;)</span><br><span class="line">            if [ &quot;$direction&quot; != &quot;down&quot; ]; then</span><br><span class="line">                direction=&quot;up&quot;</span><br><span class="line">            fi</span><br><span class="line">            ;;</span><br><span class="line">        &quot;s&quot;|&quot;S&quot;)</span><br><span class="line">            if [ &quot;$direction&quot; != &quot;up&quot; ]; then</span><br><span class="line">                direction=&quot;down&quot;</span><br><span class="line">            fi</span><br><span class="line">            ;;</span><br><span class="line">        &quot;a&quot;|&quot;A&quot;)</span><br><span class="line">            if [ &quot;$direction&quot; != &quot;right&quot; ]; then</span><br><span class="line">                direction=&quot;left&quot;</span><br><span class="line">            fi</span><br><span class="line">            ;;</span><br><span class="line">        &quot;d&quot;|&quot;D&quot;)</span><br><span class="line">            if [ &quot;$direction&quot; != &quot;left&quot; ]; then</span><br><span class="line">                direction=&quot;right&quot;</span><br><span class="line">            fi</span><br><span class="line">            ;;</span><br><span class="line">        &quot;q&quot;|&quot;Q&quot;)</span><br><span class="line">            game_over=1</span><br><span class="line">            ;;</span><br><span class="line">    esac</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="步骤5：蛇的移动逻辑"><a href="#步骤5：蛇的移动逻辑" class="headerlink" title="步骤5：蛇的移动逻辑"></a>步骤5：蛇的移动逻辑</h3><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"># 移动蛇</span><br><span class="line">move_snake() &#123;</span><br><span class="line">    # 保存旧位置用于清除尾巴</span><br><span class="line">    local old_tail_x=$&#123;snake_x[-1]&#125;</span><br><span class="line">    local old_tail_y=$&#123;snake_y[-1]&#125;</span><br><span class="line">    </span><br><span class="line">    # 移动蛇身（除了头部）</span><br><span class="line">    for ((i=snake_length-1; i&gt;0; i--)); do</span><br><span class="line">        snake_x[$i]=$&#123;snake_x[$((i-1))]&#125;</span><br><span class="line">        snake_y[$i]=$&#123;snake_y[$((i-1))]&#125;</span><br><span class="line">    done</span><br><span class="line">    </span><br><span class="line">    # 根据方向移动头部</span><br><span class="line">    case &quot;$direction&quot; in</span><br><span class="line">        &quot;up&quot;)</span><br><span class="line">            snake_y[0]=$((snake_y[0] - 1))</span><br><span class="line">            ;;</span><br><span class="line">        &quot;down&quot;)</span><br><span class="line">            snake_y[0]=$((snake_y[0] + 1))</span><br><span class="line">            ;;</span><br><span class="line">        &quot;left&quot;)</span><br><span class="line">            snake_x[0]=$((snake_x[0] - 1))</span><br><span class="line">            ;;</span><br><span class="line">        &quot;right&quot;)</span><br><span class="line">            snake_x[0]=$((snake_x[0] + 1))</span><br><span class="line">            ;;</span><br><span class="line">    esac</span><br><span class="line">    </span><br><span class="line">    # 清除旧的尾巴</span><br><span class="line">    echo -ne &quot;\033[$((old_tail_y+1));$((old_tail_x+1))H&quot;</span><br><span class="line">    echo -n &quot; &quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 检查碰撞</span><br><span class="line">check_collision() &#123;</span><br><span class="line">    # 检查墙壁碰撞</span><br><span class="line">    if [ $&#123;snake_x[0]&#125; -lt 0 ] || [ $&#123;snake_x[0]&#125; -ge $WIDTH ] || \</span><br><span class="line">       [ $&#123;snake_y[0]&#125; -lt 0 ] || [ $&#123;snake_y[0]&#125; -ge $HEIGHT ]; then</span><br><span class="line">        game_over=1</span><br><span class="line">        return</span><br><span class="line">    fi</span><br><span class="line">    </span><br><span class="line">    # 检查自身碰撞</span><br><span class="line">    for ((i=1; i&lt;snake_length; i++)); do</span><br><span class="line">        if [ $&#123;snake_x[0]&#125; -eq $&#123;snake_x[$i]&#125; ] &amp;&amp; [ $&#123;snake_y[0]&#125; -eq $&#123;snake_y[$i]&#125; ]; then</span><br><span class="line">            game_over=1</span><br><span class="line">            return</span><br><span class="line">        fi</span><br><span class="line">    done</span><br><span class="line">    </span><br><span class="line">    # 检查是否吃到食物</span><br><span class="line">    if [ $&#123;snake_x[0]&#125; -eq $food_x ] &amp;&amp; [ $&#123;snake_y[0]&#125; -eq $food_y ]; then</span><br><span class="line">        score=$((score + 10))</span><br><span class="line">        snake_x+=($&#123;snake_x[-1]&#125;)</span><br><span class="line">        snake_y+=($&#123;snake_y[-1]&#125;)</span><br><span class="line">        snake_length=$((snake_length + 1))</span><br><span class="line">        generate_food</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="步骤6：游戏主循环"><a href="#步骤6：游戏主循环" class="headerlink" title="步骤6：游戏主循环"></a>步骤6：游戏主循环</h3><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"># 显示游戏信息</span><br><span class="line">display_info() &#123;</span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT+4));1H&quot;</span><br><span class="line">    echo -e &quot;\033[1;36m分数: $score   长度: $snake_length   方向: $direction\033[0m&quot;</span><br><span class="line">    echo -e &quot;控制: W/A/S/D移动，Q退出&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 游戏结束画面</span><br><span class="line">game_over_screen() &#123;</span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT/2));$((WIDTH/2-5))H&quot;</span><br><span class="line">    echo -e &quot;\033[1;41m游戏结束!\033[0m&quot;</span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT/2+1));$((WIDTH/2-8))H&quot;</span><br><span class="line">    echo -e &quot;\033[1;33m最终分数: $score\033[0m&quot;</span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT/2+2));$((WIDTH/2-10))H&quot;</span><br><span class="line">    echo -e &quot;按任意键退出...&quot;</span><br><span class="line">    read -n1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 主游戏循环</span><br><span class="line">main() &#123;</span><br><span class="line">    # 清屏</span><br><span class="line">    echo -e &quot;\033[2J&quot;</span><br><span class="line">    </span><br><span class="line">    # 生成初始食物</span><br><span class="line">    generate_food</span><br><span class="line">    </span><br><span class="line">    # 游戏主循环</span><br><span class="line">    while [ $game_over -eq 0 ]; do</span><br><span class="line">        # 绘制游戏区域</span><br><span class="line">        draw_border</span><br><span class="line">        draw_food</span><br><span class="line">        draw_snake</span><br><span class="line">        </span><br><span class="line">        # 显示游戏信息</span><br><span class="line">        display_info</span><br><span class="line">        </span><br><span class="line">        # 处理输入</span><br><span class="line">        handle_input</span><br><span class="line">        </span><br><span class="line">        # 移动蛇</span><br><span class="line">        move_snake</span><br><span class="line">        </span><br><span class="line">        # 检查碰撞</span><br><span class="line">        check_collision</span><br><span class="line">        </span><br><span class="line">        # 控制游戏速度</span><br><span class="line">        sleep 0.1</span><br><span class="line">    done</span><br><span class="line">    </span><br><span class="line">    # 游戏结束</span><br><span class="line">    game_over_screen</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 启动游戏</span><br><span class="line">main</span><br></pre></td></tr></table></figure>



<h3 id="步骤7：完整代码整合与使用"><a href="#步骤7：完整代码整合与使用" class="headerlink" title="步骤7：完整代码整合与使用"></a>步骤7：完整代码整合与使用</h3><p>将以上所有代码片段按顺序保存到<code>snake_game.sh</code>文件中，然后：</p>
<p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 给予执行权限</span><br><span class="line">chmod +x snake_game.sh</span><br><span class="line"></span><br><span class="line"># 运行游戏</span><br><span class="line">./snake_game.sh</span><br></pre></td></tr></table></figure>



<h2 id="扩展功能建议"><a href="#扩展功能建议" class="headerlink" title="扩展功能建议"></a>扩展功能建议</h2><p>如果你想进一步提升这个游戏，可以考虑：</p>
<ol>
<li><strong>难度级别</strong>：添加速度随分数增加的机制</li>
<li><strong>障碍物</strong>：在游戏区域中添加固定障碍物</li>
<li><strong>高分记录</strong>：将最高分保存到文件中</li>
<li><strong>开始菜单</strong>：添加游戏开始菜单和暂停功能</li>
<li><strong>音效</strong>：使用系统蜂鸣器添加简单音效</li>
</ol>
<h2 id="学习要点"><a href="#学习要点" class="headerlink" title="学习要点"></a>学习要点</h2><p>通过这个项目，你可以学到：</p>
<ol>
<li><strong>ANSI转义码</strong>：控制终端颜色、光标位置</li>
<li><strong>非阻塞输入</strong>：使用<code>stty</code>和<code>read</code>实现</li>
<li><strong>数组操作</strong>：存储和处理蛇身坐标</li>
<li><strong>信号处理</strong>：使用<code>trap</code>处理退出信号</li>
<li><strong>游戏循环</strong>：实现基本的游戏循环结构</li>
</ol>
<p>这个实现使用了纯Bash功能，没有依赖外部命令（除了基本的shell内置命令），适合学习shell编程的核心概念。祝你编程愉快！</p>
<p>继续扩展</p>
<p>我们将继续扩展贪吃蛇游戏，增加以下功能：</p>
<ol>
<li>难度级别：随着分数增加，蛇的移动速度加快。</li>
<li>障碍物：在游戏区域中随机生成障碍物，碰到障碍物游戏结束。</li>
<li>高分记录：将最高分保存到文件中，并在游戏结束时显示。</li>
<li>开始菜单和暂停功能：添加开始菜单，游戏暂停功能。</li>
</ol>
<p>我们将逐步实现这些扩展功能。</p>
<p>步骤1：调整游戏循环速度（难度级别）<br>我们可以根据分数来调整游戏循环中sleep的时间，分数越高，sleep时间越短，蛇移动越快。</p>
<p>步骤2：添加障碍物<br>我们将在游戏区域中随机生成几个障碍物，障碍物用’#’表示，蛇撞到障碍物游戏结束。</p>
<p>步骤3：高分记录<br>我们将在用户家目录下创建一个隐藏文件来保存最高分，每次游戏结束时比较当前分数和最高分，并更新。</p>
<p>步骤4：开始菜单和暂停功能<br>添加一个简单的开始菜单，可以选择开始游戏、查看最高分和退出。在游戏过程中，可以按空格键暂停。</p>
<p>由于代码会变得较长，我将重新组织代码结构，并添加上述功能。</p>
<p>注意：为了保持代码清晰，我们将函数模块化，并添加注释。</p>
<p>让我们开始修改代码。</p>
<p>由于原有代码已经有一些基础，我们在此基础上进行修改。</p>
<p>首先，我们定义一些新的全局变量。</p>
<p>然后，我们修改主循环，加入速度控制。</p>
<p>我们还需要修改碰撞检测，加入对障碍物的检测。</p>
<p>由于添加了菜单，我们需要改变游戏的启动方式。</p>
<p>我们将分步骤进行，并且尽量保持代码的清晰。</p>
<p>由于在终端中实现菜单和暂停可能会涉及到更多的终端控制，我们将使用简单的文本菜单。</p>
<p>考虑到代码长度，我们将只给出关键部分的代码，并尽量保持注释。</p>
<p>下面，我们将按照以下顺序进行：</p>
<ol>
<li>添加开始菜单</li>
<li>添加障碍物</li>
<li>添加难度级别（速度控制）</li>
<li>添加高分记录</li>
<li>添加暂停功能</li>
</ol>
<p>由于这是一个逐步的过程，我们将先构建菜单，然后逐步加入其他功能。</p>
<p>注意：为了简化，我们可能会调整原有代码的结构。</p>
<p>我们重新组织代码，将游戏的主要部分放在一个函数中，以便在菜单中调用。</p>
<p>由于修改较大，我将给出完整的代码框架，但只详细解释新增的部分。</p>
<p>让我们开始编写代码。</p>
<h1 id="Shell贪吃蛇扩展功能"><a href="#Shell贪吃蛇扩展功能" class="headerlink" title="Shell贪吃蛇扩展功能"></a>Shell贪吃蛇扩展功能</h1><p>让我们继续扩展贪吃蛇游戏，增加更多功能和改进用户体验。</p>
<h2 id="扩展1：难度级别和速度控制"><a href="#扩展1：难度级别和速度控制" class="headerlink" title="扩展1：难度级别和速度控制"></a>扩展1：难度级别和速度控制</h2><h3 id="添加难度选择菜单"><a href="#添加难度选择菜单" class="headerlink" title="添加难度选择菜单"></a>添加难度选择菜单</h3><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"># 在游戏初始化部分添加</span><br><span class="line">difficulty=&quot;normal&quot;</span><br><span class="line">speed=0.1  # 默认速度</span><br><span class="line"></span><br><span class="line"># 难度选择菜单</span><br><span class="line">show_menu() &#123;</span><br><span class="line">    echo -e &quot;\033[2J\033[H&quot;</span><br><span class="line">    echo -e &quot;\033[1;36m==============================\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;36m        Shell贪吃蛇\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;36m==============================\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;33m1. 简单模式 (慢速)\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;32m2. 普通模式 (中速)\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;31m3. 困难模式 (快速)\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;35m4. 无尽模式 (无边界)\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;34m5. 查看最高分\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;37mQ. 退出游戏\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;36m==============================\033[0m&quot;</span><br><span class="line">    echo -n &quot;请选择: &quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 选择难度</span><br><span class="line">select_difficulty() &#123;</span><br><span class="line">    show_menu</span><br><span class="line">    </span><br><span class="line">    while true; do</span><br><span class="line">        read -n1 choice</span><br><span class="line">        case &quot;$choice&quot; in</span><br><span class="line">            &quot;1&quot;)</span><br><span class="line">                difficulty=&quot;easy&quot;</span><br><span class="line">                speed=0.15</span><br><span class="line">                return 0</span><br><span class="line">                ;;</span><br><span class="line">            &quot;2&quot;)</span><br><span class="line">                difficulty=&quot;normal&quot;</span><br><span class="line">                speed=0.1</span><br><span class="line">                return 0</span><br><span class="line">                ;;</span><br><span class="line">            &quot;3&quot;)</span><br><span class="line">                difficulty=&quot;hard&quot;</span><br><span class="line">                speed=0.06</span><br><span class="line">                return 0</span><br><span class="line">                ;;</span><br><span class="line">            &quot;4&quot;)</span><br><span class="line">                difficulty=&quot;endless&quot;</span><br><span class="line">                speed=0.1</span><br><span class="line">                return 0</span><br><span class="line">                ;;</span><br><span class="line">            &quot;5&quot;)</span><br><span class="line">                show_high_scores</span><br><span class="line">                show_menu</span><br><span class="line">                ;;</span><br><span class="line">            &quot;q&quot;|&quot;Q&quot;)</span><br><span class="line">                exit 0</span><br><span class="line">                ;;</span><br><span class="line">        esac</span><br><span class="line">    done</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="修改移动逻辑支持无尽模式"><a href="#修改移动逻辑支持无尽模式" class="headerlink" title="修改移动逻辑支持无尽模式"></a>修改移动逻辑支持无尽模式</h3><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"># 修改移动函数，支持穿墙</span><br><span class="line">move_snake() &#123;</span><br><span class="line">    # 保存旧位置用于清除尾巴</span><br><span class="line">    local old_tail_x=$&#123;snake_x[-1]&#125;</span><br><span class="line">    local old_tail_y=$&#123;snake_y[-1]&#125;</span><br><span class="line">    </span><br><span class="line">    # 移动蛇身（除了头部）</span><br><span class="line">    for ((i=snake_length-1; i&gt;0; i--)); do</span><br><span class="line">        snake_x[$i]=$&#123;snake_x[$((i-1))]&#125;</span><br><span class="line">        snake_y[$i]=$&#123;snake_y[$((i-1))]&#125;</span><br><span class="line">    done</span><br><span class="line">    </span><br><span class="line">    # 根据方向移动头部</span><br><span class="line">    case &quot;$direction&quot; in</span><br><span class="line">        &quot;up&quot;)</span><br><span class="line">            snake_y[0]=$((snake_y[0] - 1))</span><br><span class="line">            ;;</span><br><span class="line">        &quot;down&quot;)</span><br><span class="line">            snake_y[0]=$((snake_y[0] + 1))</span><br><span class="line">            ;;</span><br><span class="line">        &quot;left&quot;)</span><br><span class="line">            snake_x[0]=$((snake_x[0] - 1))</span><br><span class="line">            ;;</span><br><span class="line">        &quot;right&quot;)</span><br><span class="line">            snake_x[0]=$((snake_x[0] + 1))</span><br><span class="line">            ;;</span><br><span class="line">    esac</span><br><span class="line">    </span><br><span class="line">    # 无尽模式：穿墙效果</span><br><span class="line">    if [ &quot;$difficulty&quot; = &quot;endless&quot; ]; then</span><br><span class="line">        if [ $&#123;snake_x[0]&#125; -lt 0 ]; then</span><br><span class="line">            snake_x[0]=$((WIDTH - 1))</span><br><span class="line">        elif [ $&#123;snake_x[0]&#125; -ge $WIDTH ]; then</span><br><span class="line">            snake_x[0]=0</span><br><span class="line">        fi</span><br><span class="line">        </span><br><span class="line">        if [ $&#123;snake_y[0]&#125; -lt 0 ]; then</span><br><span class="line">            snake_y[0]=$((HEIGHT - 1))</span><br><span class="line">        elif [ $&#123;snake_y[0]&#125; -ge $HEIGHT ]; then</span><br><span class="line">            snake_y[0]=0</span><br><span class="line">        fi</span><br><span class="line">    fi</span><br><span class="line">    </span><br><span class="line">    # 清除旧的尾巴</span><br><span class="line">    echo -ne &quot;\033[$((old_tail_y+1));$((old_tail_x+1))H&quot;</span><br><span class="line">    echo -n &quot; &quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 修改碰撞检测，无尽模式去掉墙壁碰撞</span><br><span class="line">check_collision() &#123;</span><br><span class="line">    # 无尽模式没有墙壁碰撞</span><br><span class="line">    if [ &quot;$difficulty&quot; != &quot;endless&quot; ]; then</span><br><span class="line">        # 检查墙壁碰撞</span><br><span class="line">        if [ $&#123;snake_x[0]&#125; -lt 0 ] || [ $&#123;snake_x[0]&#125; -ge $WIDTH ] || \</span><br><span class="line">           [ $&#123;snake_y[0]&#125; -lt 0 ] || [ $&#123;snake_y[0]&#125; -ge $HEIGHT ]; then</span><br><span class="line">            game_over=1</span><br><span class="line">            return</span><br><span class="line">        fi</span><br><span class="line">    fi</span><br><span class="line">    </span><br><span class="line">    # 检查自身碰撞</span><br><span class="line">    for ((i=1; i&lt;snake_length; i++)); do</span><br><span class="line">        if [ $&#123;snake_x[0]&#125; -eq $&#123;snake_x[$i]&#125; ] &amp;&amp; [ $&#123;snake_y[0]&#125; -eq $&#123;snake_y[$i]&#125; ]; then</span><br><span class="line">            game_over=1</span><br><span class="line">            return</span><br><span class="line">        fi</span><br><span class="line">    done</span><br><span class="line">    </span><br><span class="line">    # 检查是否吃到食物</span><br><span class="line">    if [ $&#123;snake_x[0]&#125; -eq $food_x ] &amp;&amp; [ $&#123;snake_y[0]&#125; -eq $food_y ]; then</span><br><span class="line">        score=$((score + 10))</span><br><span class="line">        snake_x+=($&#123;snake_x[-1]&#125;)</span><br><span class="line">        snake_y+=($&#123;snake_y[-1]&#125;)</span><br><span class="line">        snake_length=$((snake_length + 1))</span><br><span class="line">        generate_food</span><br><span class="line">        </span><br><span class="line">        # 难度增加：每得50分速度加快</span><br><span class="line">        if [ $score -ne 0 ] &amp;&amp; [ $((score % 50)) -eq 0 ]; then</span><br><span class="line">            if [ &quot;$difficulty&quot; != &quot;endless&quot; ]; then</span><br><span class="line">                speed=$(echo &quot;$speed * 0.9&quot; | bc -l)</span><br><span class="line">                if [ &quot;$(echo &quot;$speed &lt; 0.03&quot; | bc -l)&quot; -eq 1 ]; then</span><br><span class="line">                    speed=0.03</span><br><span class="line">                fi</span><br><span class="line">            fi</span><br><span class="line">        fi</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="扩展2：添加障碍物"><a href="#扩展2：添加障碍物" class="headerlink" title="扩展2：添加障碍物"></a>扩展2：添加障碍物</h2><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"># 添加障碍物数组</span><br><span class="line">declare -a obstacles_x</span><br><span class="line">declare -a obstacles_y</span><br><span class="line">obstacle_count=5</span><br><span class="line"></span><br><span class="line"># 生成障碍物</span><br><span class="line">generate_obstacles() &#123;</span><br><span class="line">    obstacles_x=()</span><br><span class="line">    obstacles_y=()</span><br><span class="line">    </span><br><span class="line">    for ((i=0; i&lt;obstacle_count; i++)); do</span><br><span class="line">        local valid=0</span><br><span class="line">        while [ $valid -eq 0 ]; do</span><br><span class="line">            valid=1</span><br><span class="line">            local ox=$((RANDOM % (WIDTH-4) + 2))</span><br><span class="line">            local oy=$((RANDOM % (HEIGHT-2) + 1))</span><br><span class="line">            </span><br><span class="line">            # 障碍物不能生成在蛇头位置</span><br><span class="line">            if [ $ox -eq $&#123;snake_x[0]&#125; ] &amp;&amp; [ $oy -eq $&#123;snake_y[0]&#125; ]; then</span><br><span class="line">                valid=0</span><br><span class="line">                continue</span><br><span class="line">            fi</span><br><span class="line">            </span><br><span class="line">            # 障碍物不能生成在食物位置</span><br><span class="line">            if [ $ox -eq $food_x ] &amp;&amp; [ $oy -eq $food_y ]; then</span><br><span class="line">                valid=0</span><br><span class="line">                continue</span><br><span class="line">            fi</span><br><span class="line">            </span><br><span class="line">            # 障碍物之间不能太近</span><br><span class="line">            for ((j=0; j&lt;$&#123;#obstacles_x[@]&#125;; j++)); do</span><br><span class="line">                local dx=$((ox - $&#123;obstacles_x[$j]&#125;))</span><br><span class="line">                local dy=$((oy - $&#123;obstacles_y[$j]&#125;))</span><br><span class="line">                if [ $((dx*dx + dy*dy)) -lt 25 ]; then  # 距离小于5</span><br><span class="line">                    valid=0</span><br><span class="line">                    break</span><br><span class="line">                fi</span><br><span class="line">            done</span><br><span class="line">            </span><br><span class="line">            if [ $valid -eq 1 ]; then</span><br><span class="line">                obstacles_x+=($ox)</span><br><span class="line">                obstacles_y+=($oy)</span><br><span class="line">            fi</span><br><span class="line">        done</span><br><span class="line">    done</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 绘制障碍物</span><br><span class="line">draw_obstacles() &#123;</span><br><span class="line">    for ((i=0; i&lt;$&#123;#obstacles_x[@]&#125;; i++)); do</span><br><span class="line">        echo -ne &quot;\033[$((obstacles_y[i]+1));$((obstacles_x[i]+1))H&quot;</span><br><span class="line">        echo -ne &quot;\033[1;41m#\033[0m&quot;</span><br><span class="line">    done</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 修改碰撞检测，加入障碍物检测</span><br><span class="line">check_collision() &#123;</span><br><span class="line">    # ... 之前的墙壁碰撞检测 ...</span><br><span class="line">    </span><br><span class="line">    # 检查障碍物碰撞</span><br><span class="line">    for ((i=0; i&lt;$&#123;#obstacles_x[@]&#125;; i++)); do</span><br><span class="line">        if [ $&#123;snake_x[0]&#125; -eq $&#123;obstacles_x[$i]&#125; ] &amp;&amp; [ $&#123;snake_y[0]&#125; -eq $&#123;obstacles_y[$i]&#125; ]; then</span><br><span class="line">            game_over=1</span><br><span class="line">            return</span><br><span class="line">        fi</span><br><span class="line">    done</span><br><span class="line">    </span><br><span class="line">    # ... 之前的自身碰撞和食物检测 ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="扩展3：高分记录系统"><a href="#扩展3：高分记录系统" class="headerlink" title="扩展3：高分记录系统"></a>扩展3：高分记录系统</h2><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"># 高分记录文件</span><br><span class="line">HIGH_SCORE_FILE=&quot;$HOME/.snake_high_scores&quot;</span><br><span class="line"></span><br><span class="line"># 保存高分</span><br><span class="line">save_high_score() &#123;</span><br><span class="line">    local name=&quot;$1&quot;</span><br><span class="line">    local score=$2</span><br><span class="line">    local difficulty=&quot;$3&quot;</span><br><span class="line">    local date=$(date +&quot;%Y-%m-%d %H:%M:%S&quot;)</span><br><span class="line">    </span><br><span class="line">    # 如果文件不存在则创建</span><br><span class="line">    if [ ! -f &quot;$HIGH_SCORE_FILE&quot; ]; then</span><br><span class="line">        echo &quot;排名,玩家,分数,难度,日期&quot; &gt; &quot;$HIGH_SCORE_FILE&quot;</span><br><span class="line">        echo &quot;1,$name,$score,$difficulty,$date&quot; &gt;&gt; &quot;$HIGH_SCORE_FILE&quot;</span><br><span class="line">    else</span><br><span class="line">        # 读取现有记录</span><br><span class="line">        local temp_file=$(mktemp)</span><br><span class="line">        local inserted=0</span><br><span class="line">        local rank=1</span><br><span class="line">        </span><br><span class="line">        # 复制表头</span><br><span class="line">        head -1 &quot;$HIGH_SCORE_FILE&quot; &gt; &quot;$temp_file&quot;</span><br><span class="line">        </span><br><span class="line">        # 插入新记录</span><br><span class="line">        while IFS=&#x27;,&#x27; read -r r_rank r_name r_score r_difficulty r_date; do</span><br><span class="line">            if [ &quot;$r_rank&quot; = &quot;排名&quot; ]; then</span><br><span class="line">                continue  # 跳过表头</span><br><span class="line">            fi</span><br><span class="line">            </span><br><span class="line">            if [ $inserted -eq 0 ] &amp;&amp; [ $score -gt $r_score ]; then</span><br><span class="line">                echo &quot;$rank,$name,$score,$difficulty,$date&quot; &gt;&gt; &quot;$temp_file&quot;</span><br><span class="line">                inserted=1</span><br><span class="line">                rank=$((rank+1))</span><br><span class="line">            fi</span><br><span class="line">            </span><br><span class="line">            if [ $rank -le 10 ]; then  # 只保留前10名</span><br><span class="line">                echo &quot;$rank,$r_name,$r_score,$r_difficulty,$r_date&quot; &gt;&gt; &quot;$temp_file&quot;</span><br><span class="line">                rank=$((rank+1))</span><br><span class="line">            fi</span><br><span class="line">        done &lt; &lt;(tail -n +2 &quot;$HIGH_SCORE_FILE&quot;)</span><br><span class="line">        </span><br><span class="line">        # 如果还没有插入且排名未满</span><br><span class="line">        if [ $inserted -eq 0 ] &amp;&amp; [ $rank -le 10 ]; then</span><br><span class="line">            echo &quot;$rank,$name,$score,$difficulty,$date&quot; &gt;&gt; &quot;$temp_file&quot;</span><br><span class="line">        fi</span><br><span class="line">        </span><br><span class="line">        mv &quot;$temp_file&quot; &quot;$HIGH_SCORE_FILE&quot;</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 显示高分榜</span><br><span class="line">show_high_scores() &#123;</span><br><span class="line">    echo -e &quot;\033[2J\033[H&quot;</span><br><span class="line">    echo -e &quot;\033[1;36m==============================\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;36m          高分榜\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;36m==============================\033[0m&quot;</span><br><span class="line">    </span><br><span class="line">    if [ ! -f &quot;$HIGH_SCORE_FILE&quot; ] || [ ! -s &quot;$HIGH_SCORE_FILE&quot; ]; then</span><br><span class="line">        echo -e &quot;\033[1;33m暂无记录\033[0m&quot;</span><br><span class="line">    else</span><br><span class="line">        # 显示表格</span><br><span class="line">        echo -e &quot;\033[1;34m排名\t玩家\t分数\t难度\t日期\033[0m&quot;</span><br><span class="line">        echo -e &quot;\033[1;37m--------------------------------\033[0m&quot;</span><br><span class="line">        </span><br><span class="line">        # 读取并显示记录</span><br><span class="line">        while IFS=&#x27;,&#x27; read -r rank name score diff date; do</span><br><span class="line">            if [ &quot;$rank&quot; = &quot;排名&quot; ]; then</span><br><span class="line">                continue  # 跳过表头</span><br><span class="line">            fi</span><br><span class="line">            </span><br><span class="line">            # 根据排名设置不同颜色</span><br><span class="line">            case $rank in</span><br><span class="line">                1) color=&quot;\033[1;33m&quot; ;;  # 金色</span><br><span class="line">                2) color=&quot;\033[1;37m&quot; ;;  # 银色</span><br><span class="line">                3) color=&quot;\033[1;31m&quot; ;;  # 铜色</span><br><span class="line">                *) color=&quot;\033[0;37m&quot; ;;  # 白色</span><br><span class="line">            esac</span><br><span class="line">            </span><br><span class="line">            printf &quot;$&#123;color&#125;%-4s\t%-8s\t%-6s\t%-6s\t%-16s\033[0m\n&quot; &quot;$rank&quot; &quot;$name&quot; &quot;$score&quot; &quot;$diff&quot; &quot;$date&quot;</span><br><span class="line">        done &lt; &quot;$HIGH_SCORE_FILE&quot;</span><br><span class="line">    fi</span><br><span class="line">    </span><br><span class="line">    echo -e &quot;\n按任意键返回...&quot;</span><br><span class="line">    read -n1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 修改游戏结束函数</span><br><span class="line">game_over_screen() &#123;</span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT/2));$((WIDTH/2-5))H&quot;</span><br><span class="line">    echo -e &quot;\033[1;41m游戏结束!\033[0m&quot;</span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT/2+1));$((WIDTH/2-8))H&quot;</span><br><span class="line">    echo -e &quot;\033[1;33m最终分数: $score\033[0m&quot;</span><br><span class="line">    </span><br><span class="line">    # 检查是否进入高分榜</span><br><span class="line">    if [ -f &quot;$HIGH_SCORE_FILE&quot; ]; then</span><br><span class="line">        local lowest_score=0</span><br><span class="line">        if [ $(wc -l &lt; &quot;$HIGH_SCORE_FILE&quot;) -gt 1 ]; then</span><br><span class="line">            # 获取最低分（跳过表头）</span><br><span class="line">            lowest_score=$(tail -n 1 &quot;$HIGH_SCORE_FILE&quot; | cut -d&#x27;,&#x27; -f3)</span><br><span class="line">        fi</span><br><span class="line">    fi</span><br><span class="line">    </span><br><span class="line">    if [ ! -f &quot;$HIGH_SCORE_FILE&quot; ] || [ $score -gt $lowest_score ] || [ $(wc -l &lt; &quot;$HIGH_SCORE_FILE&quot; 2&gt;/dev/null) -lt 11 ]; then</span><br><span class="line">        echo -ne &quot;\033[$((HEIGHT/2+2));$((WIDTH/2-10))H&quot;</span><br><span class="line">        echo -e &quot;\033[1;32m恭喜！你进入了高分榜！\033[0m&quot;</span><br><span class="line">        echo -ne &quot;\033[$((HEIGHT/2+3));$((WIDTH/2-8))H&quot;</span><br><span class="line">        echo -n &quot;请输入你的名字: &quot;</span><br><span class="line">        </span><br><span class="line">        read player_name</span><br><span class="line">        if [ -z &quot;$player_name&quot; ]; then</span><br><span class="line">            player_name=&quot;匿名玩家&quot;</span><br><span class="line">        fi</span><br><span class="line">        </span><br><span class="line">        save_high_score &quot;$player_name&quot; &quot;$score&quot; &quot;$difficulty&quot;</span><br><span class="line">    fi</span><br><span class="line">    </span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT/2+5));$((WIDTH/2-10))H&quot;</span><br><span class="line">    echo -e &quot;按任意键返回菜单...&quot;</span><br><span class="line">    read -n1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="扩展4：暂停和帮助功能"><a href="#扩展4：暂停和帮助功能" class="headerlink" title="扩展4：暂停和帮助功能"></a>扩展4：暂停和帮助功能</h2><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"># 暂停游戏</span><br><span class="line">pause_game() &#123;</span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT/2));$((WIDTH/2-5))H&quot;</span><br><span class="line">    echo -e &quot;\033[1;43;30m游戏暂停\033[0m&quot;</span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT/2+1));$((WIDTH/2-10))H&quot;</span><br><span class="line">    echo -e &quot;按任意键继续...&quot;</span><br><span class="line">    </span><br><span class="line">    # 临时恢复终端设置以便读取输入</span><br><span class="line">    stty echo icanon</span><br><span class="line">    read -n1</span><br><span class="line">    stty -echo -icanon time 0 min 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 显示帮助信息</span><br><span class="line">show_help() &#123;</span><br><span class="line">    echo -ne &quot;\033[2J\033[H&quot;</span><br><span class="line">    echo -e &quot;\033[1;36m==============================\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;36m          游戏帮助\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;36m==============================\033[0m&quot;</span><br><span class="line">    echo -e &quot;\033[1;33m控制方式:\033[0m&quot;</span><br><span class="line">    echo -e &quot;  W/↑    - 向上移动&quot;</span><br><span class="line">    echo -e &quot;  S/↓    - 向下移动&quot;</span><br><span class="line">    echo -e &quot;  A/←    - 向左移动&quot;</span><br><span class="line">    echo -e &quot;  D/→    - 向右移动&quot;</span><br><span class="line">    echo -e &quot;  P      - 暂停游戏&quot;</span><br><span class="line">    echo -e &quot;  H      - 显示帮助&quot;</span><br><span class="line">    echo -e &quot;  Q      - 退出游戏&quot;</span><br><span class="line">    echo -e &quot;&quot;</span><br><span class="line">    echo -e &quot;\033[1;33m游戏元素:\033[0m&quot;</span><br><span class="line">    echo -e &quot;  \033[1;32m@\033[0m - 蛇头&quot;</span><br><span class="line">    echo -e &quot;  \033[1;33mo\033[0m - 蛇身&quot;</span><br><span class="line">    echo -e &quot;  \033[1;31m*\033[0m - 食物 (+10分)&quot;</span><br><span class="line">    echo -e &quot;  \033[1;41m#\033[0m - 障碍物 (游戏结束)&quot;</span><br><span class="line">    echo -e &quot;&quot;</span><br><span class="line">    echo -e &quot;\033[1;33m游戏规则:\033[0m&quot;</span><br><span class="line">    echo -e &quot;  1. 控制蛇吃到食物可以增加长度和分数&quot;</span><br><span class="line">    echo -e &quot;  2. 碰到墙壁、障碍物或自己的身体会游戏结束&quot;</span><br><span class="line">    echo -e &quot;  3. 无尽模式下蛇可以穿过墙壁&quot;</span><br><span class="line">    echo -e &quot;&quot;</span><br><span class="line">    echo -e &quot;按任意键返回游戏...&quot;</span><br><span class="line">    read -n1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 修改输入处理函数</span><br><span class="line">handle_input() &#123;</span><br><span class="line">    local key</span><br><span class="line">    IFS= read -rsn1 -t 0.1 key</span><br><span class="line">    </span><br><span class="line">    # 支持方向键</span><br><span class="line">    if [[ &quot;$key&quot; == $&#x27;\033&#x27; ]]; then</span><br><span class="line">        read -rsn2 key</span><br><span class="line">        case &quot;$key&quot; in</span><br><span class="line">            &quot;[A&quot;)  # 上箭头</span><br><span class="line">                if [ &quot;$direction&quot; != &quot;down&quot; ]; then</span><br><span class="line">                    direction=&quot;up&quot;</span><br><span class="line">                fi</span><br><span class="line">                ;;</span><br><span class="line">            &quot;[B&quot;)  # 下箭头</span><br><span class="line">                if [ &quot;$direction&quot; != &quot;up&quot; ]; then</span><br><span class="line">                    direction=&quot;down&quot;</span><br><span class="line">                fi</span><br><span class="line">                ;;</span><br><span class="line">            &quot;[C&quot;)  # 右箭头</span><br><span class="line">                if [ &quot;$direction&quot; != &quot;left&quot; ]; then</span><br><span class="line">                    direction=&quot;right&quot;</span><br><span class="line">                fi</span><br><span class="line">                ;;</span><br><span class="line">            &quot;[D&quot;)  # 左箭头</span><br><span class="line">                if [ &quot;$direction&quot; != &quot;right&quot; ]; then</span><br><span class="line">                    direction=&quot;left&quot;</span><br><span class="line">                fi</span><br><span class="line">                ;;</span><br><span class="line">        esac</span><br><span class="line">        return</span><br><span class="line">    fi</span><br><span class="line">    </span><br><span class="line">    case &quot;$key&quot; in</span><br><span class="line">        &quot;w&quot;|&quot;W&quot;)</span><br><span class="line">            if [ &quot;$direction&quot; != &quot;down&quot; ]; then</span><br><span class="line">                direction=&quot;up&quot;</span><br><span class="line">            fi</span><br><span class="line">            ;;</span><br><span class="line">        &quot;s&quot;|&quot;S&quot;)</span><br><span class="line">            if [ &quot;$direction&quot; != &quot;up&quot; ]; then</span><br><span class="line">                direction=&quot;down&quot;</span><br><span class="line">            fi</span><br><span class="line">            ;;</span><br><span class="line">        &quot;a&quot;|&quot;A&quot;)</span><br><span class="line">            if [ &quot;$direction&quot; != &quot;right&quot; ]; then</span><br><span class="line">                direction=&quot;left&quot;</span><br><span class="line">            fi</span><br><span class="line">            ;;</span><br><span class="line">        &quot;d&quot;|&quot;D&quot;)</span><br><span class="line">            if [ &quot;$direction&quot; != &quot;left&quot; ]; then</span><br><span class="line">                direction=&quot;right&quot;</span><br><span class="line">            fi</span><br><span class="line">            ;;</span><br><span class="line">        &quot;p&quot;|&quot;P&quot;)</span><br><span class="line">            pause_game</span><br><span class="line">            ;;</span><br><span class="line">        &quot;h&quot;|&quot;H&quot;)</span><br><span class="line">            show_help</span><br><span class="line">            ;;</span><br><span class="line">        &quot;q&quot;|&quot;Q&quot;)</span><br><span class="line">            game_over=1</span><br><span class="line">            ;;</span><br><span class="line">    esac</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="扩展5：视觉效果增强"><a href="#扩展5：视觉效果增强" class="headerlink" title="扩展5：视觉效果增强"></a>扩展5：视觉效果增强</h2><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"># 添加特殊食物（加分更多）</span><br><span class="line">special_food_x=-1</span><br><span class="line">special_food_y=-1</span><br><span class="line">special_food_timer=0</span><br><span class="line">special_food_active=0</span><br><span class="line"></span><br><span class="line"># 生成特殊食物</span><br><span class="line">generate_special_food() &#123;</span><br><span class="line">    if [ $((RANDOM % 100)) -lt 5 ] &amp;&amp; [ $special_food_active -eq 0 ] &amp;&amp; [ $score -gt 50 ]; then  # 5%几率</span><br><span class="line">        local valid=0</span><br><span class="line">        while [ $valid -eq 0 ]; do</span><br><span class="line">            valid=1</span><br><span class="line">            special_food_x=$((RANDOM % WIDTH))</span><br><span class="line">            special_food_y=$((RANDOM % HEIGHT))</span><br><span class="line">            </span><br><span class="line">            # 不能和普通食物重合</span><br><span class="line">            if [ $special_food_x -eq $food_x ] &amp;&amp; [ $special_food_y -eq $food_y ]; then</span><br><span class="line">                valid=0</span><br><span class="line">                continue</span><br><span class="line">            fi</span><br><span class="line">            </span><br><span class="line">            # 不能和蛇身重合</span><br><span class="line">            for ((i=0; i&lt;snake_length; i++)); do</span><br><span class="line">                if [ $special_food_x -eq $&#123;snake_x[$i]&#125; ] &amp;&amp; [ $special_food_y -eq $&#123;snake_y[$i]&#125; ]; then</span><br><span class="line">                    valid=0</span><br><span class="line">                    break</span><br><span class="line">                fi</span><br><span class="line">            done</span><br><span class="line">        done</span><br><span class="line">        </span><br><span class="line">        special_food_active=1</span><br><span class="line">        special_food_timer=50  # 50帧时间</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 绘制特殊食物</span><br><span class="line">draw_special_food() &#123;</span><br><span class="line">    if [ $special_food_active -eq 1 ]; then</span><br><span class="line">        # 闪烁效果</span><br><span class="line">        if [ $((special_food_timer % 4)) -lt 2 ]; then</span><br><span class="line">            echo -ne &quot;\033[$((special_food_y+1));$((special_food_x+1))H&quot;</span><br><span class="line">            echo -ne &quot;\033[1;35m★\033[0m&quot;</span><br><span class="line">        fi</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 更新特殊食物计时器</span><br><span class="line">update_special_food() &#123;</span><br><span class="line">    if [ $special_food_active -eq 1 ]; then</span><br><span class="line">        special_food_timer=$((special_food_timer - 1))</span><br><span class="line">        if [ $special_food_timer -le 0 ]; then</span><br><span class="line">            special_food_active=0</span><br><span class="line">            # 清除特殊食物</span><br><span class="line">            echo -ne &quot;\033[$((special_food_y+1));$((special_food_x+1))H&quot;</span><br><span class="line">            echo -n &quot; &quot;</span><br><span class="line">        fi</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 修改食物检测，加入特殊食物</span><br><span class="line">check_collision() &#123;</span><br><span class="line">    # ... 之前的碰撞检测 ...</span><br><span class="line">    </span><br><span class="line">    # 检查是否吃到特殊食物</span><br><span class="line">    if [ $special_food_active -eq 1 ] &amp;&amp; [ $&#123;snake_x[0]&#125; -eq $special_food_x ] &amp;&amp; [ $&#123;snake_y[0]&#125; -eq $special_food_y ]; then</span><br><span class="line">        score=$((score + 50))</span><br><span class="line">        snake_x+=($&#123;snake_x[-1]&#125;)</span><br><span class="line">        snake_y+=($&#123;snake_y[-1]&#125;)</span><br><span class="line">        snake_x+=($&#123;snake_x[-1]&#125;)</span><br><span class="line">        snake_y+=($&#123;snake_y[-1]&#125;)</span><br><span class="line">        snake_length=$((snake_length + 2))</span><br><span class="line">        special_food_active=0</span><br><span class="line">        echo -ne &quot;\033[$((special_food_y+1));$((special_food_x+1))H&quot;</span><br><span class="line">        echo -n &quot; &quot;</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="扩展6：游戏信息显示增强"><a href="#扩展6：游戏信息显示增强" class="headerlink" title="扩展6：游戏信息显示增强"></a>扩展6：游戏信息显示增强</h2><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 增强的游戏信息显示</span><br><span class="line">display_info() &#123;</span><br><span class="line">    # 绘制信息边框</span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT+3));1H&quot;</span><br><span class="line">    echo -e &quot;\033[1;34m+$(printf &#x27;%.0s-&#x27; &#123;1..60&#125;)+\033[0m&quot;</span><br><span class="line">    </span><br><span class="line">    # 显示游戏信息</span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT+4));2H&quot;</span><br><span class="line">    printf &quot;\033[1;36m分数: %-6d 长度: %-3d 难度: %-8s 速度: %.3f\033[0m&quot; $score $snake_length $difficulty $speed</span><br><span class="line">    </span><br><span class="line">    # 显示控制提示</span><br><span class="line">    echo -ne &quot;\033[$((HEIGHT+5));2H&quot;</span><br><span class="line">    echo -e &quot;\033[1;33m控制: W/A/S/D或方向键移动 | P暂停 | H帮助 | Q退出\033[0m&quot;</span><br><span class="line">    </span><br><span class="line">    # 显示特殊食物倒计时</span><br><span class="line">    if [ $special_food_active -eq 1 ]; then</span><br><span class="line">        echo -ne &quot;\033[$((HEIGHT+6));2H&quot;</span><br><span class="line">        printf &quot;\033[1;35m特殊食物: ★ (剩余时间: %2d)\033[0m&quot; $special_food_timer</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="主函数修改"><a href="#主函数修改" class="headerlink" title="主函数修改"></a>主函数修改</h2><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"># 修改主函数</span><br><span class="line">main() &#123;</span><br><span class="line">    # 显示菜单</span><br><span class="line">    select_difficulty</span><br><span class="line">    </span><br><span class="line">    # 重置游戏状态</span><br><span class="line">    score=0</span><br><span class="line">    game_over=0</span><br><span class="line">    direction=&quot;right&quot;</span><br><span class="line">    snake_x=(15 14 13)</span><br><span class="line">    snake_y=(10 10 10)</span><br><span class="line">    snake_length=3</span><br><span class="line">    special_food_active=0</span><br><span class="line">    </span><br><span class="line">    # 清屏</span><br><span class="line">    echo -e &quot;\033[2J&quot;</span><br><span class="line">    </span><br><span class="line">    # 生成初始食物和障碍物</span><br><span class="line">    generate_food</span><br><span class="line">    if [ &quot;$difficulty&quot; = &quot;hard&quot; ] || [ &quot;$difficulty&quot; = &quot;normal&quot; ]; then</span><br><span class="line">        generate_obstacles</span><br><span class="line">    fi</span><br><span class="line">    </span><br><span class="line">    # 游戏主循环</span><br><span class="line">    while [ $game_over -eq 0 ]; do</span><br><span class="line">        # 绘制游戏区域</span><br><span class="line">        draw_border</span><br><span class="line">        draw_food</span><br><span class="line">        if [ &quot;$difficulty&quot; = &quot;hard&quot; ] || [ &quot;$difficulty&quot; = &quot;normal&quot; ]; then</span><br><span class="line">            draw_obstacles</span><br><span class="line">        fi</span><br><span class="line">        draw_special_food</span><br><span class="line">        draw_snake</span><br><span class="line">        </span><br><span class="line">        # 显示游戏信息</span><br><span class="line">        display_info</span><br><span class="line">        </span><br><span class="line">        # 处理输入</span><br><span class="line">        handle_input</span><br><span class="line">        </span><br><span class="line">        # 移动蛇</span><br><span class="line">        move_snake</span><br><span class="line">        </span><br><span class="line">        # 检查碰撞</span><br><span class="line">        check_collision</span><br><span class="line">        </span><br><span class="line">        # 更新特殊食物</span><br><span class="line">        update_special_food</span><br><span class="line">        </span><br><span class="line">        # 偶尔生成特殊食物</span><br><span class="line">        if [ $((RANDOM % 20)) -eq 0 ]; then</span><br><span class="line">            generate_special_food</span><br><span class="line">        fi</span><br><span class="line">        </span><br><span class="line">        # 控制游戏速度</span><br><span class="line">        sleep $speed</span><br><span class="line">    done</span><br><span class="line">    </span><br><span class="line">    # 游戏结束</span><br><span class="line">    game_over_screen</span><br><span class="line">    </span><br><span class="line">    # 返回菜单</span><br><span class="line">    main</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><ol>
<li>将以上所有代码整合到一个文件中</li>
<li>给予执行权限：<code>chmod +x snake_game.sh</code></li>
<li>运行游戏：<code>./snake_game.sh</code></li>
</ol>
<h2 id="新增功能总结"><a href="#新增功能总结" class="headerlink" title="新增功能总结"></a>新增功能总结</h2><ol>
<li><strong>难度系统</strong>：简单、普通、困难、无尽四种模式</li>
<li><strong>速度控制</strong>：随分数增加而加快</li>
<li><strong>障碍物系统</strong>：增加游戏挑战性</li>
<li><strong>高分记录</strong>：保存前10名成绩</li>
<li><strong>暂停功能</strong>：按P键暂停游戏</li>
<li><strong>帮助系统</strong>：按H键查看游戏说明</li>
<li><strong>特殊食物</strong>：加分更多的闪烁食物</li>
<li><strong>视觉效果</strong>：更好的界面和动画效果</li>
<li><strong>方向键支持</strong>：支持键盘方向键控制</li>
</ol>
<p>这个扩展版本增加了游戏的趣味性和挑战性，同时提升了用户体验。你可以继续在此基础上添加更多功能，比如不同的蛇皮肤、更多障碍物类型、关卡系统等。</p>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">
    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/post/9f126af1.html" rel="prev" title="C语言HTTP服务器设计与实现">
                  <i class="fa fa-angle-left"></i> C语言HTTP服务器设计与实现
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/post/8cf8cd8d.html" rel="next" title="Shell实践-俄罗斯方块">
                  Shell实践-俄罗斯方块 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa-regular fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder"></span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">467k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">28:19</span>
  </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.0/mermaid.min.js","integrity":"sha256-stuqcu2FrjYCXDOytWFA5SoUE/r3nkp6gTglzNSlavU="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>

  <script class="next-config" data-name="wavedrom" type="application/json">{"enable":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.5.0/wavedrom.min.js","integrity":"sha256-INLAoJc6quTNfiMWkGZniYO2cxE8mHpddnLow1m6RFs="}}</script>
  <script class="next-config" data-name="wavedrom_skin" type="application/json">{"enable":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.5.0/skins/default.js","integrity":"sha256-fduc/Zszk5ezWws2uInY/ALWVmIrmV6VTgXbsYSReFI="}}</script>
  <script src="/js/third-party/tags/wavedrom.js"></script>




  





</body>
</html>
