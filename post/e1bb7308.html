<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"timewait7.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":true,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="æˆ‘æ¥è®¾è®¡å¹¶å®ç°ä¸€ä¸ªã€ŒRPGæ¸¸æˆåˆ¶ä½œå·¥å…·ã€ï¼Œè¿™ä¸ªé¡¹ç›®å°†æ¶µç›–Pythonçš„å¤§éƒ¨åˆ†æ ¸å¿ƒæŠ€æœ¯æ ˆï¼š ğŸ“¦ é¡¹ç›®åç§°ï¼šPyRPG Maker - Python RPGæ¸¸æˆåˆ¶ä½œå·¥å…·ğŸ¯ é¡¹ç›®ç‰¹ç‚¹ å®Œæ•´æŠ€æœ¯æ ˆè¦†ç›–ï¼šGUIã€æ•°æ®åº“ã€ç½‘ç»œã€å¤šçº¿ç¨‹ã€ç®—æ³•ã€è®¾è®¡æ¨¡å¼ æ¨¡å—åŒ–è®¾è®¡ï¼šå„ç»„ä»¶å¯ç‹¬ç«‹å­¦ä¹  å®ç”¨æ€§å¼ºï¼šå¯å®é™…åˆ¶ä½œå’Œè¿è¡ŒRPGæ¸¸æˆ å¯æ‰©å±•æ€§å¥½ï¼šæ˜“äºæ·»åŠ æ–°åŠŸèƒ½  ğŸ—ï¸ æ¶æ„è®¾è®¡text 1234567891011121">
<meta property="og:type" content="article">
<meta property="og:title" content="Python RPGæ¸¸æˆåˆ¶ä½œå·¥å…·è®¾è®¡ä¸å®ç°">
<meta property="og:url" content="http://timewait7.github.io/post/e1bb7308.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="æˆ‘æ¥è®¾è®¡å¹¶å®ç°ä¸€ä¸ªã€ŒRPGæ¸¸æˆåˆ¶ä½œå·¥å…·ã€ï¼Œè¿™ä¸ªé¡¹ç›®å°†æ¶µç›–Pythonçš„å¤§éƒ¨åˆ†æ ¸å¿ƒæŠ€æœ¯æ ˆï¼š ğŸ“¦ é¡¹ç›®åç§°ï¼šPyRPG Maker - Python RPGæ¸¸æˆåˆ¶ä½œå·¥å…·ğŸ¯ é¡¹ç›®ç‰¹ç‚¹ å®Œæ•´æŠ€æœ¯æ ˆè¦†ç›–ï¼šGUIã€æ•°æ®åº“ã€ç½‘ç»œã€å¤šçº¿ç¨‹ã€ç®—æ³•ã€è®¾è®¡æ¨¡å¼ æ¨¡å—åŒ–è®¾è®¡ï¼šå„ç»„ä»¶å¯ç‹¬ç«‹å­¦ä¹  å®ç”¨æ€§å¼ºï¼šå¯å®é™…åˆ¶ä½œå’Œè¿è¡ŒRPGæ¸¸æˆ å¯æ‰©å±•æ€§å¥½ï¼šæ˜“äºæ·»åŠ æ–°åŠŸèƒ½  ğŸ—ï¸ æ¶æ„è®¾è®¡text 1234567891011121">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-12-17T12:46:36.000Z">
<meta property="article:modified_time" content="2025-12-17T12:46:58.338Z">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://timewait7.github.io/post/e1bb7308.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://timewait7.github.io/post/e1bb7308.html","path":"post/e1bb7308.html","title":"Python RPGæ¸¸æˆåˆ¶ä½œå·¥å…·è®¾è®¡ä¸å®ç°"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Python RPGæ¸¸æˆåˆ¶ä½œå·¥å…·è®¾è®¡ä¸å®ç° | Hexo</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hexo</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-archives"><a href="/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%A6-%E9%A1%B9%E7%9B%AE%E5%90%8D%E7%A7%B0%EF%BC%9APyRPG-Maker-Python-RPG%E6%B8%B8%E6%88%8F%E5%88%B6%E4%BD%9C%E5%B7%A5%E5%85%B7"><span class="nav-number">1.</span> <span class="nav-text">ğŸ“¦ é¡¹ç›®åç§°ï¼šPyRPG Maker - Python RPGæ¸¸æˆåˆ¶ä½œå·¥å…·</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8E%AF-%E9%A1%B9%E7%9B%AE%E7%89%B9%E7%82%B9"><span class="nav-number">1.1.</span> <span class="nav-text">ğŸ¯ é¡¹ç›®ç‰¹ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%8F%97%EF%B8%8F-%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="nav-number">2.</span> <span class="nav-text">ğŸ—ï¸ æ¶æ„è®¾è®¡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%9A%80-%E5%AE%8C%E6%95%B4%E5%AE%9E%E7%8E%B0%EF%BC%88%E7%AE%80%E5%8C%96%E7%89%88%EF%BC%89"><span class="nav-number">3.</span> <span class="nav-text">ğŸš€ å®Œæ•´å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%E5%92%8C%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86"><span class="nav-number">3.1.</span> <span class="nav-text">1. åŸºç¡€æ¶æ„å’Œé…ç½®ç®¡ç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">3.2.</span> <span class="nav-text">2. æ•°æ®æ¨¡å‹å’Œæ•°æ®åº“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%B8%B8%E6%88%8F%E5%BC%95%E6%93%8E%E6%A0%B8%E5%BF%83"><span class="nav-number">3.3.</span> <span class="nav-text">3. æ¸¸æˆå¼•æ“æ ¸å¿ƒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-GUI%E7%95%8C%E9%9D%A2%EF%BC%88%E4%BD%BF%E7%94%A8PyQt5%EF%BC%89"><span class="nav-number">3.4.</span> <span class="nav-text">4. GUIç•Œé¢ï¼ˆä½¿ç”¨PyQt5ï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E5%9C%B0%E5%9B%BE%E7%BC%96%E8%BE%91%E5%99%A8%E7%BB%84%E4%BB%B6"><span class="nav-number">3.5.</span> <span class="nav-text">5. åœ°å›¾ç¼–è¾‘å™¨ç»„ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E8%84%9A%E6%9C%AC%E7%B3%BB%E7%BB%9F%E5%92%8C%E4%BA%8B%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">3.6.</span> <span class="nav-text">6. è„šæœ¬ç³»ç»Ÿå’Œäº‹ä»¶ç³»ç»Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-%E7%BD%91%E7%BB%9C%E5%8A%9F%E8%83%BD%EF%BC%88%E5%A4%9A%E4%BA%BA%E6%B8%B8%E6%88%8F%EF%BC%89"><span class="nav-number">3.7.</span> <span class="nav-text">7. ç½‘ç»œåŠŸèƒ½ï¼ˆå¤šäººæ¸¸æˆï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-%E4%B8%BB%E7%A8%8B%E5%BA%8F%E5%85%A5%E5%8F%A3"><span class="nav-number">3.8.</span> <span class="nav-text">8. ä¸»ç¨‹åºå…¥å£</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%8B-%E8%BF%90%E8%A1%8C%E5%92%8C%E5%AE%89%E8%A3%85%E8%AF%B4%E6%98%8E"><span class="nav-number">4.</span> <span class="nav-text">ğŸ“‹ è¿è¡Œå’Œå®‰è£…è¯´æ˜</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96"><span class="nav-number">4.1.</span> <span class="nav-text">1. å®‰è£…ä¾èµ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="nav-number">4.2.</span> <span class="nav-text">2. é¡¹ç›®ç»“æ„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E8%BF%90%E8%A1%8C%E9%A1%B9%E7%9B%AE"><span class="nav-number">4.3.</span> <span class="nav-text">3. è¿è¡Œé¡¹ç›®</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%8E%AF-%E6%B6%B5%E7%9B%96%E7%9A%84%E6%8A%80%E6%9C%AF%E6%A0%88"><span class="nav-number">5.</span> <span class="nav-text">ğŸ¯ æ¶µç›–çš„æŠ€æœ¯æ ˆ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9C%85-%E5%9F%BA%E7%A1%80%E6%A0%B8%E5%BF%83"><span class="nav-number">5.1.</span> <span class="nav-text">âœ… åŸºç¡€æ ¸å¿ƒ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9C%85-%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7"><span class="nav-number">5.2.</span> <span class="nav-text">âœ… é«˜çº§ç‰¹æ€§</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9C%85-GUI%E5%BC%80%E5%8F%91"><span class="nav-number">5.3.</span> <span class="nav-text">âœ… GUIå¼€å‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9C%85-%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="nav-number">5.4.</span> <span class="nav-text">âœ… æ•°æ®å¤„ç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9C%85-%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91"><span class="nav-number">5.5.</span> <span class="nav-text">âœ… æ¸¸æˆå¼€å‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9C%85-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B"><span class="nav-number">5.6.</span> <span class="nav-text">âœ… ç½‘ç»œç¼–ç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%9C%85-%E5%B7%A5%E7%A8%8B%E5%8C%96"><span class="nav-number">5.7.</span> <span class="nav-text">âœ… å·¥ç¨‹åŒ–</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%9A%80-%E5%A6%82%E4%BD%95%E6%89%A9%E5%B1%95%E9%A1%B9%E7%9B%AE"><span class="nav-number">6.</span> <span class="nav-text">ğŸš€ å¦‚ä½•æ‰©å±•é¡¹ç›®</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%B7%BB%E5%8A%A0%E6%96%B0%E5%8A%9F%E8%83%BD"><span class="nav-number">6.1.</span> <span class="nav-text">1. æ·»åŠ æ–°åŠŸèƒ½</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="nav-number">6.2.</span> <span class="nav-text">2. æ€§èƒ½ä¼˜åŒ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%83%A8%E7%BD%B2%E5%8F%91%E5%B8%83"><span class="nav-number">6.3.</span> <span class="nav-text">3. éƒ¨ç½²å‘å¸ƒ</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/">
          <span class="site-state-item-count">57</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>

    
        <div class="sidebar-inner sidebar-post-related">
          <div class="animated">
              <div class="links-of-blogroll-title"><i class="fa fa-signs-post fa-fw"></i>
    Related Posts
  </div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <a class="popular-posts-link" href="/post/94c76a9b.html" rel="bookmark">
        <time class="popular-posts-time">2025-12-17</time>
        <br>
      Pythonæ•°æ®æ¸…æ´—å·¥å…·è®¾è®¡ä¸å®ç°
      </a>
    </li>
    <li class="popular-posts-item">
      <a class="popular-posts-link" href="/post/82734d8.html" rel="bookmark">
        <time class="popular-posts-time">2024-12-13</time>
        <br>
      LinuxåŸºç¡€
      </a>
    </li>
  </ul>

          </div>
        </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://timewait7.github.io/post/e1bb7308.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Python RPGæ¸¸æˆåˆ¶ä½œå·¥å…·è®¾è®¡ä¸å®ç° | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Python RPGæ¸¸æˆåˆ¶ä½œå·¥å…·è®¾è®¡ä¸å®ç°
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-12-17 20:46:36" itemprop="dateCreated datePublished" datetime="2025-12-17T20:46:36+08:00">2025-12-17</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>4.7k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>17 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>æˆ‘æ¥è®¾è®¡å¹¶å®ç°ä¸€ä¸ª<strong>ã€ŒRPGæ¸¸æˆåˆ¶ä½œå·¥å…·ã€</strong>ï¼Œè¿™ä¸ªé¡¹ç›®å°†æ¶µç›–Pythonçš„å¤§éƒ¨åˆ†æ ¸å¿ƒæŠ€æœ¯æ ˆï¼š</p>
<h2 id="ğŸ“¦-é¡¹ç›®åç§°ï¼šPyRPG-Maker-Python-RPGæ¸¸æˆåˆ¶ä½œå·¥å…·"><a href="#ğŸ“¦-é¡¹ç›®åç§°ï¼šPyRPG-Maker-Python-RPGæ¸¸æˆåˆ¶ä½œå·¥å…·" class="headerlink" title="ğŸ“¦ é¡¹ç›®åç§°ï¼šPyRPG Maker - Python RPGæ¸¸æˆåˆ¶ä½œå·¥å…·"></a>ğŸ“¦ é¡¹ç›®åç§°ï¼šPyRPG Maker - Python RPGæ¸¸æˆåˆ¶ä½œå·¥å…·</h2><h3 id="ğŸ¯-é¡¹ç›®ç‰¹ç‚¹"><a href="#ğŸ¯-é¡¹ç›®ç‰¹ç‚¹" class="headerlink" title="ğŸ¯ é¡¹ç›®ç‰¹ç‚¹"></a>ğŸ¯ é¡¹ç›®ç‰¹ç‚¹</h3><ul>
<li><strong>å®Œæ•´æŠ€æœ¯æ ˆè¦†ç›–</strong>ï¼šGUIã€æ•°æ®åº“ã€ç½‘ç»œã€å¤šçº¿ç¨‹ã€ç®—æ³•ã€è®¾è®¡æ¨¡å¼</li>
<li><strong>æ¨¡å—åŒ–è®¾è®¡</strong>ï¼šå„ç»„ä»¶å¯ç‹¬ç«‹å­¦ä¹ </li>
<li><strong>å®ç”¨æ€§å¼º</strong>ï¼šå¯å®é™…åˆ¶ä½œå’Œè¿è¡ŒRPGæ¸¸æˆ</li>
<li><strong>å¯æ‰©å±•æ€§å¥½</strong>ï¼šæ˜“äºæ·»åŠ æ–°åŠŸèƒ½</li>
</ul>
<h2 id="ğŸ—ï¸-æ¶æ„è®¾è®¡"><a href="#ğŸ—ï¸-æ¶æ„è®¾è®¡" class="headerlink" title="ğŸ—ï¸ æ¶æ„è®¾è®¡"></a>ğŸ—ï¸ æ¶æ„è®¾è®¡</h2><p>text</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">PyRPG-Maker/</span><br><span class="line">â”œâ”€â”€ core/                 # æ ¸å¿ƒå¼•æ“</span><br><span class="line">â”‚   â”œâ”€â”€ game_engine.py   # æ¸¸æˆå¼•æ“</span><br><span class="line">â”‚   â”œâ”€â”€ map_editor.py    # åœ°å›¾ç¼–è¾‘å™¨</span><br><span class="line">â”‚   â”œâ”€â”€ script_editor.py # è„šæœ¬ç¼–è¾‘å™¨</span><br><span class="line">â”‚   â””â”€â”€ resource_manager.py # èµ„æºç®¡ç†</span><br><span class="line">â”œâ”€â”€ gui/                 # ç”¨æˆ·ç•Œé¢</span><br><span class="line">â”‚   â”œâ”€â”€ main_window.py   # ä¸»çª—å£</span><br><span class="line">â”‚   â”œâ”€â”€ toolbar.py       # å·¥å…·æ </span><br><span class="line">â”‚   â””â”€â”€ dialogs/         # å¯¹è¯æ¡†</span><br><span class="line">â”œâ”€â”€ game/                # æ¸¸æˆè¿è¡Œæ—¶</span><br><span class="line">â”‚   â”œâ”€â”€ entities/        # æ¸¸æˆå®ä½“</span><br><span class="line">â”‚   â”œâ”€â”€ systems/         # æ¸¸æˆç³»ç»Ÿ</span><br><span class="line">â”‚   â””â”€â”€ scripts/         # æ¸¸æˆè„šæœ¬</span><br><span class="line">â”œâ”€â”€ data/                # æ•°æ®å­˜å‚¨</span><br><span class="line">â”‚   â”œâ”€â”€ models.py        # æ•°æ®æ¨¡å‹</span><br><span class="line">â”‚   â”œâ”€â”€ database.py      # æ•°æ®åº“æ“ä½œ</span><br><span class="line">â”‚   â””â”€â”€ serialization.py # åºåˆ—åŒ–</span><br><span class="line">â”œâ”€â”€ utils/               # å·¥å…·ç±»</span><br><span class="line">â”‚   â”œâ”€â”€ logger.py        # æ—¥å¿—ç³»ç»Ÿ</span><br><span class="line">â”‚   â”œâ”€â”€ config.py        # é…ç½®ç®¡ç†</span><br><span class="line">â”‚   â””â”€â”€ helpers.py       # è¾…åŠ©å‡½æ•°</span><br><span class="line">â”œâ”€â”€ assets/              # èµ„æºæ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ tests/               # å•å…ƒæµ‹è¯•</span><br><span class="line">â””â”€â”€ docs/                # æ–‡æ¡£</span><br></pre></td></tr></table></figure>



<h2 id="ğŸš€-å®Œæ•´å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰"><a href="#ğŸš€-å®Œæ•´å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰" class="headerlink" title="ğŸš€ å®Œæ•´å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰"></a>ğŸš€ å®Œæ•´å®ç°ï¼ˆç®€åŒ–ç‰ˆï¼‰</h2><h3 id="1-åŸºç¡€æ¶æ„å’Œé…ç½®ç®¡ç†"><a href="#1-åŸºç¡€æ¶æ„å’Œé…ç½®ç®¡ç†" class="headerlink" title="1. åŸºç¡€æ¶æ„å’Œé…ç½®ç®¡ç†"></a>1. åŸºç¡€æ¶æ„å’Œé…ç½®ç®¡ç†</h3><p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"># utils/config.py - é…ç½®ç®¡ç†ï¼ˆå­¦ä¹ ï¼šå•ä¾‹æ¨¡å¼ã€JSONé…ç½®ï¼‰</span><br><span class="line">import json</span><br><span class="line">import os</span><br><span class="line">from pathlib import Path</span><br><span class="line">from typing import Any, Dict</span><br><span class="line"></span><br><span class="line">class ConfigManager:</span><br><span class="line">    &quot;&quot;&quot;é…ç½®ç®¡ç†å™¨ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰&quot;&quot;&quot;</span><br><span class="line">    _instance = None</span><br><span class="line">    </span><br><span class="line">    def __new__(cls):</span><br><span class="line">        if cls._instance is None:</span><br><span class="line">            cls._instance = super().__new__(cls)</span><br><span class="line">            cls._instance._initialized = False</span><br><span class="line">        return cls._instance</span><br><span class="line">    </span><br><span class="line">    def __init__(self):</span><br><span class="line">        if not self._initialized:</span><br><span class="line">            self.config_path = Path.home() / &quot;.pyrpg_maker&quot; / &quot;config.json&quot;</span><br><span class="line">            self.config_path.parent.mkdir(parents=True, exist_ok=True)</span><br><span class="line">            self.config = self._load_config()</span><br><span class="line">            self._initialized = True</span><br><span class="line">    </span><br><span class="line">    def _load_config(self) -&gt; Dict[str, Any]:</span><br><span class="line">        &quot;&quot;&quot;åŠ è½½é…ç½®æ–‡ä»¶&quot;&quot;&quot;</span><br><span class="line">        default_config = &#123;</span><br><span class="line">            &quot;window&quot;: &#123;&quot;width&quot;: 1024, &quot;height&quot;: 768&#125;,</span><br><span class="line">            &quot;editor&quot;: &#123;&quot;grid_size&quot;: 32, &quot;autosave&quot;: True&#125;,</span><br><span class="line">            &quot;recent_projects&quot;: [],</span><br><span class="line">            &quot;theme&quot;: &quot;dark&quot;,</span><br><span class="line">            &quot;database&quot;: &#123;&quot;type&quot;: &quot;sqlite&quot;, &quot;path&quot;: &quot;games.db&quot;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        if self.config_path.exists():</span><br><span class="line">            try:</span><br><span class="line">                with open(self.config_path, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br><span class="line">                    return &#123;**default_config, **json.load(f)&#125;</span><br><span class="line">            except:</span><br><span class="line">                return default_config</span><br><span class="line">        return default_config</span><br><span class="line">    </span><br><span class="line">    def save(self):</span><br><span class="line">        &quot;&quot;&quot;ä¿å­˜é…ç½®&quot;&quot;&quot;</span><br><span class="line">        with open(self.config_path, &#x27;w&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br><span class="line">            json.dump(self.config, f, indent=2)</span><br><span class="line">    </span><br><span class="line">    def get(self, key: str, default=None):</span><br><span class="line">        &quot;&quot;&quot;è·å–é…ç½®å€¼&quot;&quot;&quot;</span><br><span class="line">        keys = key.split(&#x27;.&#x27;)</span><br><span class="line">        value = self.config</span><br><span class="line">        for k in keys:</span><br><span class="line">            if isinstance(value, dict):</span><br><span class="line">                value = value.get(k, &#123;&#125;)</span><br><span class="line">            else:</span><br><span class="line">                return default</span><br><span class="line">        return value if value != &#123;&#125; else default</span><br><span class="line">    </span><br><span class="line">    def set(self, key: str, value: Any):</span><br><span class="line">        &quot;&quot;&quot;è®¾ç½®é…ç½®å€¼&quot;&quot;&quot;</span><br><span class="line">        keys = key.split(&#x27;.&#x27;)</span><br><span class="line">        config = self.config</span><br><span class="line">        </span><br><span class="line">        for i, k in enumerate(keys[:-1]):</span><br><span class="line">            if k not in config:</span><br><span class="line">                config[k] = &#123;&#125;</span><br><span class="line">            config = config[k]</span><br><span class="line">        </span><br><span class="line">        config[keys[-1]] = value</span><br><span class="line">        self.save()</span><br><span class="line"></span><br><span class="line"># utils/logger.py - æ—¥å¿—ç³»ç»Ÿï¼ˆå­¦ä¹ ï¼šè£…é¥°å™¨ã€å¤šçº§æ—¥å¿—ï¼‰</span><br><span class="line">import logging</span><br><span class="line">from datetime import datetime</span><br><span class="line">from functools import wraps</span><br><span class="line"></span><br><span class="line">class GameLogger:</span><br><span class="line">    &quot;&quot;&quot;æ¸¸æˆæ—¥å¿—ç³»ç»Ÿ&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self, name=&quot;PyRPG_Maker&quot;):</span><br><span class="line">        self.logger = logging.getLogger(name)</span><br><span class="line">        self.logger.setLevel(logging.DEBUG)</span><br><span class="line">        </span><br><span class="line">        # æ–‡ä»¶å¤„ç†å™¨</span><br><span class="line">        log_dir = Path.home() / &quot;.pyrpg_maker&quot; / &quot;logs&quot;</span><br><span class="line">        log_dir.mkdir(parents=True, exist_ok=True)</span><br><span class="line">        file_handler = logging.FileHandler(</span><br><span class="line">            log_dir / f&quot;&#123;datetime.now().strftime(&#x27;%Y%m%d&#x27;)&#125;.log&quot;</span><br><span class="line">        )</span><br><span class="line">        file_handler.setLevel(logging.DEBUG)</span><br><span class="line">        </span><br><span class="line">        # æ§åˆ¶å°å¤„ç†å™¨</span><br><span class="line">        console_handler = logging.StreamHandler()</span><br><span class="line">        console_handler.setLevel(logging.INFO)</span><br><span class="line">        </span><br><span class="line">        # æ ¼å¼å™¨</span><br><span class="line">        formatter = logging.Formatter(</span><br><span class="line">            &#x27;%(asctime)s - %(name)s - %(levelname)s - %(message)s&#x27;</span><br><span class="line">        )</span><br><span class="line">        file_handler.setFormatter(formatter)</span><br><span class="line">        console_handler.setFormatter(formatter)</span><br><span class="line">        </span><br><span class="line">        self.logger.addHandler(file_handler)</span><br><span class="line">        self.logger.addHandler(console_handler)</span><br><span class="line">    </span><br><span class="line">    def log_function_call(self, func):</span><br><span class="line">        &quot;&quot;&quot;è®°å½•å‡½æ•°è°ƒç”¨çš„è£…é¥°å™¨&quot;&quot;&quot;</span><br><span class="line">        @wraps(func)</span><br><span class="line">        def wrapper(*args, **kwargs):</span><br><span class="line">            self.logger.debug(f&quot;è°ƒç”¨ &#123;func.__name__&#125;ï¼Œå‚æ•°: &#123;args&#125;, &#123;kwargs&#125;&quot;)</span><br><span class="line">            try:</span><br><span class="line">                result = func(*args, **kwargs)</span><br><span class="line">                self.logger.debug(f&quot;&#123;func.__name__&#125; æ‰§è¡ŒæˆåŠŸ&quot;)</span><br><span class="line">                return result</span><br><span class="line">            except Exception as e:</span><br><span class="line">                self.logger.error(f&quot;&#123;func.__name__&#125; æ‰§è¡Œå¤±è´¥: &#123;e&#125;&quot;)</span><br><span class="line">                raise</span><br><span class="line">        return wrapper</span><br></pre></td></tr></table></figure>



<h3 id="2-æ•°æ®æ¨¡å‹å’Œæ•°æ®åº“"><a href="#2-æ•°æ®æ¨¡å‹å’Œæ•°æ®åº“" class="headerlink" title="2. æ•°æ®æ¨¡å‹å’Œæ•°æ®åº“"></a>2. æ•°æ®æ¨¡å‹å’Œæ•°æ®åº“</h3><p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"># data/models.py - æ•°æ®æ¨¡å‹ï¼ˆå­¦ä¹ ï¼šSQLAlchemy ORMï¼‰</span><br><span class="line">from datetime import datetime</span><br><span class="line">from typing import List, Optional</span><br><span class="line">from sqlalchemy import create_engine, Column, Integer, String, Text, Float, Boolean, DateTime, ForeignKey</span><br><span class="line">from sqlalchemy.ext.declarative import declarative_base</span><br><span class="line">from sqlalchemy.orm import sessionmaker, relationship, Session</span><br><span class="line"></span><br><span class="line">Base = declarative_base()</span><br><span class="line"></span><br><span class="line">class Project(Base):</span><br><span class="line">    &quot;&quot;&quot;é¡¹ç›®æ¨¡å‹&quot;&quot;&quot;</span><br><span class="line">    __tablename__ = &#x27;projects&#x27;</span><br><span class="line">    </span><br><span class="line">    id = Column(Integer, primary_key=True)</span><br><span class="line">    name = Column(String(100), nullable=False)</span><br><span class="line">    description = Column(Text)</span><br><span class="line">    created_at = Column(DateTime, default=datetime.utcnow)</span><br><span class="line">    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)</span><br><span class="line">    </span><br><span class="line">    # å…³è”å…³ç³»</span><br><span class="line">    maps = relationship(&quot;GameMap&quot;, back_populates=&quot;project&quot;, cascade=&quot;all, delete-orphan&quot;)</span><br><span class="line">    characters = relationship(&quot;Character&quot;, back_populates=&quot;project&quot;, cascade=&quot;all, delete-orphan&quot;)</span><br><span class="line">    items = relationship(&quot;Item&quot;, back_populates=&quot;project&quot;, cascade=&quot;all, delete-orphan&quot;)</span><br><span class="line"></span><br><span class="line">class GameMap(Base):</span><br><span class="line">    &quot;&quot;&quot;æ¸¸æˆåœ°å›¾æ¨¡å‹&quot;&quot;&quot;</span><br><span class="line">    __tablename__ = &#x27;maps&#x27;</span><br><span class="line">    </span><br><span class="line">    id = Column(Integer, primary_key=True)</span><br><span class="line">    project_id = Column(Integer, ForeignKey(&#x27;projects.id&#x27;), nullable=False)</span><br><span class="line">    name = Column(String(100))</span><br><span class="line">    width = Column(Integer, default=20)</span><br><span class="line">    height = Column(Integer, default=15)</span><br><span class="line">    tiles = Column(Text)  # JSONæ ¼å¼çš„ç“¦ç‰‡æ•°æ®</span><br><span class="line">    </span><br><span class="line">    # å…³è”å…³ç³»</span><br><span class="line">    project = relationship(&quot;Project&quot;, back_populates=&quot;maps&quot;)</span><br><span class="line">    events = relationship(&quot;MapEvent&quot;, back_populates=&quot;game_map&quot;)</span><br><span class="line"></span><br><span class="line">class Character(Base):</span><br><span class="line">    &quot;&quot;&quot;è§’è‰²æ¨¡å‹&quot;&quot;&quot;</span><br><span class="line">    __tablename__ = &#x27;characters&#x27;</span><br><span class="line">    </span><br><span class="line">    id = Column(Integer, primary_key=True)</span><br><span class="line">    project_id = Column(Integer, ForeignKey(&#x27;projects.id&#x27;), nullable=False)</span><br><span class="line">    name = Column(String(100))</span><br><span class="line">    level = Column(Integer, default=1)</span><br><span class="line">    hp = Column(Integer, default=100)</span><br><span class="line">    max_hp = Column(Integer, default=100)</span><br><span class="line">    attack = Column(Integer, default=10)</span><br><span class="line">    defense = Column(Integer, default=5)</span><br><span class="line">    </span><br><span class="line">    # å…³è”å…³ç³»</span><br><span class="line">    project = relationship(&quot;Project&quot;, back_populates=&quot;characters&quot;)</span><br><span class="line"></span><br><span class="line"># data/database.py - æ•°æ®åº“æ“ä½œï¼ˆå­¦ä¹ ï¼šä¸Šä¸‹æ–‡ç®¡ç†å™¨ã€è¿æ¥æ± ï¼‰</span><br><span class="line">from contextlib import contextmanager</span><br><span class="line">from sqlalchemy.pool import QueuePool</span><br><span class="line"></span><br><span class="line">class DatabaseManager:</span><br><span class="line">    &quot;&quot;&quot;æ•°æ®åº“ç®¡ç†å™¨&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self, db_url=&quot;sqlite:///games.db&quot;):</span><br><span class="line">        self.engine = create_engine(</span><br><span class="line">            db_url,</span><br><span class="line">            poolclass=QueuePool,</span><br><span class="line">            pool_size=5,</span><br><span class="line">            max_overflow=10,</span><br><span class="line">            pool_timeout=30,</span><br><span class="line">            pool_recycle=3600,</span><br><span class="line">            echo=False</span><br><span class="line">        )</span><br><span class="line">        Base.metadata.create_all(self.engine)</span><br><span class="line">        self.SessionLocal = sessionmaker(bind=self.engine)</span><br><span class="line">    </span><br><span class="line">    @contextmanager</span><br><span class="line">    def get_session(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–æ•°æ®åº“ä¼šè¯ï¼ˆä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼‰&quot;&quot;&quot;</span><br><span class="line">        session = self.SessionLocal()</span><br><span class="line">        try:</span><br><span class="line">            yield session</span><br><span class="line">            session.commit()</span><br><span class="line">        except Exception:</span><br><span class="line">            session.rollback()</span><br><span class="line">            raise</span><br><span class="line">        finally:</span><br><span class="line">            session.close()</span><br><span class="line">    </span><br><span class="line">    def add_project(self, name: str, description: str = &quot;&quot;) -&gt; Project:</span><br><span class="line">        &quot;&quot;&quot;æ·»åŠ é¡¹ç›®&quot;&quot;&quot;</span><br><span class="line">        with self.get_session() as session:</span><br><span class="line">            project = Project(name=name, description=description)</span><br><span class="line">            session.add(project)</span><br><span class="line">            session.flush()</span><br><span class="line">            return project</span><br></pre></td></tr></table></figure>



<h3 id="3-æ¸¸æˆå¼•æ“æ ¸å¿ƒ"><a href="#3-æ¸¸æˆå¼•æ“æ ¸å¿ƒ" class="headerlink" title="3. æ¸¸æˆå¼•æ“æ ¸å¿ƒ"></a>3. æ¸¸æˆå¼•æ“æ ¸å¿ƒ</h3><p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"># core/game_engine.py - æ¸¸æˆå¼•æ“ï¼ˆå­¦ä¹ ï¼šçŠ¶æ€æœºã€äº‹ä»¶ç³»ç»Ÿï¼‰</span><br><span class="line">import pygame</span><br><span class="line">from enum import Enum</span><br><span class="line">from typing import Dict, List, Callable, Any</span><br><span class="line">from dataclasses import dataclass, field</span><br><span class="line">import threading</span><br><span class="line">import queue</span><br><span class="line"></span><br><span class="line">class GameState(Enum):</span><br><span class="line">    &quot;&quot;&quot;æ¸¸æˆçŠ¶æ€æšä¸¾&quot;&quot;&quot;</span><br><span class="line">    MENU = &quot;menu&quot;</span><br><span class="line">    PLAYING = &quot;playing&quot;</span><br><span class="line">    PAUSED = &quot;paused&quot;</span><br><span class="line">    DIALOG = &quot;dialog&quot;</span><br><span class="line">    BATTLE = &quot;battle&quot;</span><br><span class="line">    GAME_OVER = &quot;game_over&quot;</span><br><span class="line"></span><br><span class="line">@dataclass</span><br><span class="line">class GameEvent:</span><br><span class="line">    &quot;&quot;&quot;æ¸¸æˆäº‹ä»¶&quot;&quot;&quot;</span><br><span class="line">    type: str</span><br><span class="line">    data: Dict[str, Any] = field(default_factory=dict)</span><br><span class="line">    timestamp: float = field(default_factory=pygame.time.get_ticks)</span><br><span class="line"></span><br><span class="line">class EventSystem:</span><br><span class="line">    &quot;&quot;&quot;äº‹ä»¶ç³»ç»Ÿï¼ˆè§‚å¯Ÿè€…æ¨¡å¼ï¼‰&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self):</span><br><span class="line">        self._listeners: Dict[str, List[Callable]] = &#123;&#125;</span><br><span class="line">        self._event_queue = queue.Queue()</span><br><span class="line">    </span><br><span class="line">    def subscribe(self, event_type: str, callback: Callable):</span><br><span class="line">        &quot;&quot;&quot;è®¢é˜…äº‹ä»¶&quot;&quot;&quot;</span><br><span class="line">        if event_type not in self._listeners:</span><br><span class="line">            self._listeners[event_type] = []</span><br><span class="line">        self._listeners[event_type].append(callback)</span><br><span class="line">    </span><br><span class="line">    def unsubscribe(self, event_type: str, callback: Callable):</span><br><span class="line">        &quot;&quot;&quot;å–æ¶ˆè®¢é˜…&quot;&quot;&quot;</span><br><span class="line">        if event_type in self._listeners:</span><br><span class="line">            self._listeners[event_type].remove(callback)</span><br><span class="line">    </span><br><span class="line">    def emit(self, event: GameEvent):</span><br><span class="line">        &quot;&quot;&quot;å‘å¸ƒäº‹ä»¶&quot;&quot;&quot;</span><br><span class="line">        self._event_queue.put(event)</span><br><span class="line">    </span><br><span class="line">    def process_events(self):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†äº‹ä»¶é˜Ÿåˆ—&quot;&quot;&quot;</span><br><span class="line">        while not self._event_queue.empty():</span><br><span class="line">            try:</span><br><span class="line">                event = self._event_queue.get_nowait()</span><br><span class="line">                if event.type in self._listeners:</span><br><span class="line">                    for callback in self._listeners[event.type]:</span><br><span class="line">                        try:</span><br><span class="line">                            callback(event)</span><br><span class="line">                        except Exception as e:</span><br><span class="line">                            print(f&quot;äº‹ä»¶å¤„ç†é”™è¯¯: &#123;e&#125;&quot;)</span><br><span class="line">            except queue.Empty:</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">class GameEngine:</span><br><span class="line">    &quot;&quot;&quot;æ¸¸æˆå¼•æ“ï¼ˆçŠ¶æ€æ¨¡å¼ + äº‹ä»¶é©±åŠ¨ï¼‰&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self, width: int = 800, height: int = 600):</span><br><span class="line">        pygame.init()</span><br><span class="line">        self.screen = pygame.display.set_mode((width, height))</span><br><span class="line">        self.clock = pygame.time.Clock()</span><br><span class="line">        self.running = True</span><br><span class="line">        </span><br><span class="line">        # çŠ¶æ€ç®¡ç†</span><br><span class="line">        self.state: GameState = GameState.MENU</span><br><span class="line">        self.state_handlers: Dict[GameState, Callable] = &#123;</span><br><span class="line">            GameState.MENU: self._handle_menu_state,</span><br><span class="line">            GameState.PLAYING: self._handle_playing_state,</span><br><span class="line">            GameState.PAUSED: self._handle_paused_state,</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        # äº‹ä»¶ç³»ç»Ÿ</span><br><span class="line">        self.event_system = EventSystem()</span><br><span class="line">        </span><br><span class="line">        # æ¸¸æˆå¯¹è±¡</span><br><span class="line">        self.player = None</span><br><span class="line">        self.current_map = None</span><br><span class="line">        self.npcs: List = []</span><br><span class="line">        self.battle_system = BattleSystem(self)</span><br><span class="line">        </span><br><span class="line">        # èµ„æºç®¡ç†</span><br><span class="line">        self.resources: Dict[str, Any] = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        # å¤šçº¿ç¨‹ä»»åŠ¡</span><br><span class="line">        self.task_queue = queue.Queue()</span><br><span class="line">        self.result_queue = queue.Queue()</span><br><span class="line">        self.worker_thread = threading.Thread(target=self._worker, daemon=True)</span><br><span class="line">        self.worker_thread.start()</span><br><span class="line">    </span><br><span class="line">    def _worker(self):</span><br><span class="line">        &quot;&quot;&quot;å·¥ä½œçº¿ç¨‹ï¼Œå¤„ç†è€—æ—¶ä»»åŠ¡&quot;&quot;&quot;</span><br><span class="line">        while True:</span><br><span class="line">            try:</span><br><span class="line">                task = self.task_queue.get()</span><br><span class="line">                if task is None:  # ç»ˆæ­¢ä¿¡å·</span><br><span class="line">                    break</span><br><span class="line">                func, args, kwargs = task</span><br><span class="line">                try:</span><br><span class="line">                    result = func(*args, **kwargs)</span><br><span class="line">                    self.result_queue.put((&#x27;success&#x27;, result))</span><br><span class="line">                except Exception as e:</span><br><span class="line">                    self.result_queue.put((&#x27;error&#x27;, str(e)))</span><br><span class="line">            except queue.Empty:</span><br><span class="line">                continue</span><br><span class="line">    </span><br><span class="line">    def submit_task(self, func: Callable, *args, **kwargs):</span><br><span class="line">        &quot;&quot;&quot;æäº¤å¼‚æ­¥ä»»åŠ¡&quot;&quot;&quot;</span><br><span class="line">        self.task_queue.put((func, args, kwargs))</span><br><span class="line">    </span><br><span class="line">    def load_resources_async(self, resource_paths: Dict[str, str]):</span><br><span class="line">        &quot;&quot;&quot;å¼‚æ­¥åŠ è½½èµ„æº&quot;&quot;&quot;</span><br><span class="line">        def load_task():</span><br><span class="line">            resources = &#123;&#125;</span><br><span class="line">            for name, path in resource_paths.items():</span><br><span class="line">                if path.endswith(&#x27;.png&#x27;):</span><br><span class="line">                    resources[name] = pygame.image.load(path).convert_alpha()</span><br><span class="line">                elif path.endswith(&#x27;.wav&#x27;):</span><br><span class="line">                    resources[name] = pygame.mixer.Sound(path)</span><br><span class="line">            return resources</span><br><span class="line">        </span><br><span class="line">        self.submit_task(load_task)</span><br><span class="line">    </span><br><span class="line">    def _handle_menu_state(self):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†èœå•çŠ¶æ€&quot;&quot;&quot;</span><br><span class="line">        for event in pygame.event.get():</span><br><span class="line">            if event.type == pygame.QUIT:</span><br><span class="line">                self.running = False</span><br><span class="line">            elif event.type == pygame.KEYDOWN:</span><br><span class="line">                if event.key == pygame.K_RETURN:</span><br><span class="line">                    self.state = GameState.PLAYING</span><br><span class="line">                    self.event_system.emit(GameEvent(&quot;game_start&quot;))</span><br><span class="line">    </span><br><span class="line">    def _handle_playing_state(self):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†æ¸¸æˆçŠ¶æ€&quot;&quot;&quot;</span><br><span class="line">        # å¤„ç†äº‹ä»¶</span><br><span class="line">        for event in pygame.event.get():</span><br><span class="line">            if event.type == pygame.QUIT:</span><br><span class="line">                self.running = False</span><br><span class="line">            elif event.type == pygame.KEYDOWN:</span><br><span class="line">                if event.key == pygame.K_ESCAPE:</span><br><span class="line">                    self.state = GameState.PAUSED</span><br><span class="line">                else:</span><br><span class="line">                    # å¤„ç†ç©å®¶è¾“å…¥</span><br><span class="line">                    self.event_system.emit(GameEvent(&quot;player_input&quot;, &#123;&quot;key&quot;: event.key&#125;))</span><br><span class="line">        </span><br><span class="line">        # æ›´æ–°æ¸¸æˆé€»è¾‘</span><br><span class="line">        if self.player:</span><br><span class="line">            self.player.update()</span><br><span class="line">        </span><br><span class="line">        # æ¸²æŸ“æ¸¸æˆ</span><br><span class="line">        self.screen.fill((0, 0, 0))</span><br><span class="line">        if self.current_map:</span><br><span class="line">            self.current_map.render(self.screen)</span><br><span class="line">        </span><br><span class="line">        pygame.display.flip()</span><br><span class="line">        self.clock.tick(60)</span><br><span class="line">    </span><br><span class="line">    def _handle_paused_state(self):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†æš‚åœçŠ¶æ€&quot;&quot;&quot;</span><br><span class="line">        for event in pygame.event.get():</span><br><span class="line">            if event.type == pygame.QUIT:</span><br><span class="line">                self.running = False</span><br><span class="line">            elif event.type == pygame.KEYDOWN:</span><br><span class="line">                if event.key == pygame.K_ESCAPE:</span><br><span class="line">                    self.state = GameState.PLAYING</span><br><span class="line">    </span><br><span class="line">    def run(self):</span><br><span class="line">        &quot;&quot;&quot;è¿è¡Œæ¸¸æˆä¸»å¾ªç¯&quot;&quot;&quot;</span><br><span class="line">        while self.running:</span><br><span class="line">            # å¤„ç†äº‹ä»¶é˜Ÿåˆ—</span><br><span class="line">            self.event_system.process_events()</span><br><span class="line">            </span><br><span class="line">            # å¤„ç†å¼‚æ­¥ä»»åŠ¡ç»“æœ</span><br><span class="line">            while not self.result_queue.empty():</span><br><span class="line">                try:</span><br><span class="line">                    status, result = self.result_queue.get_nowait()</span><br><span class="line">                    if status == &#x27;success&#x27;:</span><br><span class="line">                        if isinstance(result, dict):</span><br><span class="line">                            self.resources.update(result)</span><br><span class="line">                    else:</span><br><span class="line">                        print(f&quot;å¼‚æ­¥ä»»åŠ¡é”™è¯¯: &#123;result&#125;&quot;)</span><br><span class="line">                except queue.Empty:</span><br><span class="line">                    break</span><br><span class="line">            </span><br><span class="line">            # æ ¹æ®çŠ¶æ€æ‰§è¡Œå¯¹åº”çš„å¤„ç†å‡½æ•°</span><br><span class="line">            if self.state in self.state_handlers:</span><br><span class="line">                self.state_handlers[self.state]()</span><br><span class="line">            else:</span><br><span class="line">                self.running = False</span><br><span class="line">        </span><br><span class="line">        self.cleanup()</span><br><span class="line">    </span><br><span class="line">    def cleanup(self):</span><br><span class="line">        &quot;&quot;&quot;æ¸…ç†èµ„æº&quot;&quot;&quot;</span><br><span class="line">        self.task_queue.put(None)  # å‘é€ç»ˆæ­¢ä¿¡å·</span><br><span class="line">        self.worker_thread.join()</span><br><span class="line">        pygame.quit()</span><br></pre></td></tr></table></figure>



<h3 id="4-GUIç•Œé¢ï¼ˆä½¿ç”¨PyQt5ï¼‰"><a href="#4-GUIç•Œé¢ï¼ˆä½¿ç”¨PyQt5ï¼‰" class="headerlink" title="4. GUIç•Œé¢ï¼ˆä½¿ç”¨PyQt5ï¼‰"></a>4. GUIç•Œé¢ï¼ˆä½¿ç”¨PyQt5ï¼‰</h3><p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br></pre></td><td class="code"><pre><span class="line"># gui/main_window.py - ä¸»çª—å£ï¼ˆå­¦ä¹ ï¼šPyQt5ã€MVCæ¶æ„ï¼‰</span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import (QApplication, QMainWindow, QWidget, QVBoxLayout, </span><br><span class="line">                             QHBoxLayout, QSplitter, QTabWidget, QTreeWidget,</span><br><span class="line">                             QTreeWidgetItem, QTextEdit, QListWidget, QToolBar,</span><br><span class="line">                             QAction, QFileDialog, QMessageBox)</span><br><span class="line">from PyQt5.QtCore import Qt, QTimer</span><br><span class="line">from PyQt5.QtGui import QIcon, QKeySequence</span><br><span class="line"></span><br><span class="line">class MainWindow(QMainWindow):</span><br><span class="line">    &quot;&quot;&quot;ä¸»çª—å£ï¼ˆMVCæ¶æ„ï¼‰&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self):</span><br><span class="line">        super().__init__()</span><br><span class="line">        self.setWindowTitle(&quot;PyRPG Maker&quot;)</span><br><span class="line">        self.setGeometry(100, 100, 1400, 800)</span><br><span class="line">        </span><br><span class="line">        # åˆå§‹åŒ–æ ¸å¿ƒç»„ä»¶</span><br><span class="line">        self.config = ConfigManager()</span><br><span class="line">        self.db_manager = DatabaseManager()</span><br><span class="line">        self.game_engine = GameEngine()</span><br><span class="line">        </span><br><span class="line">        # è®¾ç½®UI</span><br><span class="line">        self._setup_ui()</span><br><span class="line">        self._setup_menu()</span><br><span class="line">        self._setup_toolbar()</span><br><span class="line">        </span><br><span class="line">        # è¿æ¥ä¿¡å·æ§½</span><br><span class="line">        self._connect_signals()</span><br><span class="line">        </span><br><span class="line">        # åŠ è½½æœ€è¿‘çš„é¡¹ç›®</span><br><span class="line">        self._load_recent_projects()</span><br><span class="line">    </span><br><span class="line">    def _setup_ui(self):</span><br><span class="line">        &quot;&quot;&quot;è®¾ç½®ç”¨æˆ·ç•Œé¢&quot;&quot;&quot;</span><br><span class="line">        # ä¸­å¿ƒéƒ¨ä»¶</span><br><span class="line">        central_widget = QWidget()</span><br><span class="line">        self.setCentralWidget(central_widget)</span><br><span class="line">        </span><br><span class="line">        # ä¸»å¸ƒå±€</span><br><span class="line">        main_layout = QHBoxLayout(central_widget)</span><br><span class="line">        </span><br><span class="line">        # å·¦ä¾§é¢æ¿ï¼ˆé¡¹ç›®èµ„æºæ ‘ï¼‰</span><br><span class="line">        self.left_panel = self._create_left_panel()</span><br><span class="line">        </span><br><span class="line">        # ä¸­å¿ƒåŒºåŸŸï¼ˆç¼–è¾‘å™¨ï¼‰</span><br><span class="line">        self.center_area = self._create_center_area()</span><br><span class="line">        </span><br><span class="line">        # å³ä¾§é¢æ¿ï¼ˆå±æ€§ç¼–è¾‘ï¼‰</span><br><span class="line">        self.right_panel = self._create_right_panel()</span><br><span class="line">        </span><br><span class="line">        # ä½¿ç”¨åˆ†å‰²å™¨</span><br><span class="line">        splitter = QSplitter(Qt.Horizontal)</span><br><span class="line">        splitter.addWidget(self.left_panel)</span><br><span class="line">        splitter.addWidget(self.center_area)</span><br><span class="line">        splitter.addWidget(self.right_panel)</span><br><span class="line">        splitter.setSizes([200, 600, 200])</span><br><span class="line">        </span><br><span class="line">        main_layout.addWidget(splitter)</span><br><span class="line">    </span><br><span class="line">    def _create_left_panel(self):</span><br><span class="line">        &quot;&quot;&quot;åˆ›å»ºå·¦ä¾§é¡¹ç›®é¢æ¿&quot;&quot;&quot;</span><br><span class="line">        panel = QWidget()</span><br><span class="line">        layout = QVBoxLayout(panel)</span><br><span class="line">        </span><br><span class="line">        # é¡¹ç›®æ ‘</span><br><span class="line">        self.project_tree = QTreeWidget()</span><br><span class="line">        self.project_tree.setHeaderLabel(&quot;é¡¹ç›®èµ„æº&quot;)</span><br><span class="line">        self.project_tree.itemClicked.connect(self.on_tree_item_clicked)</span><br><span class="line">        </span><br><span class="line">        layout.addWidget(self.project_tree)</span><br><span class="line">        </span><br><span class="line">        # èµ„æºåˆ—è¡¨</span><br><span class="line">        self.resource_list = QListWidget()</span><br><span class="line">        layout.addWidget(self.resource_list)</span><br><span class="line">        </span><br><span class="line">        return panel</span><br><span class="line">    </span><br><span class="line">    def _create_center_area(self):</span><br><span class="line">        &quot;&quot;&quot;åˆ›å»ºä¸­å¿ƒç¼–è¾‘åŒºåŸŸ&quot;&quot;&quot;</span><br><span class="line">        tabs = QTabWidget()</span><br><span class="line">        </span><br><span class="line">        # åœ°å›¾ç¼–è¾‘å™¨æ ‡ç­¾é¡µ</span><br><span class="line">        self.map_editor_tab = MapEditorWidget(self.game_engine)</span><br><span class="line">        tabs.addTab(self.map_editor_tab, &quot;åœ°å›¾ç¼–è¾‘å™¨&quot;)</span><br><span class="line">        </span><br><span class="line">        # è„šæœ¬ç¼–è¾‘å™¨æ ‡ç­¾é¡µ</span><br><span class="line">        self.script_editor_tab = ScriptEditorWidget()</span><br><span class="line">        tabs.addTab(self.script_editor_tab, &quot;è„šæœ¬ç¼–è¾‘å™¨&quot;)</span><br><span class="line">        </span><br><span class="line">        # äº‹ä»¶ç¼–è¾‘å™¨æ ‡ç­¾é¡µ</span><br><span class="line">        self.event_editor_tab = EventEditorWidget()</span><br><span class="line">        tabs.addTab(self.event_editor_tab, &quot;äº‹ä»¶ç¼–è¾‘å™¨&quot;)</span><br><span class="line">        </span><br><span class="line">        tabs.currentChanged.connect(self.on_tab_changed)</span><br><span class="line">        </span><br><span class="line">        return tabs</span><br><span class="line">    </span><br><span class="line">    def _create_right_panel(self):</span><br><span class="line">        &quot;&quot;&quot;åˆ›å»ºå³ä¾§å±æ€§é¢æ¿&quot;&quot;&quot;</span><br><span class="line">        panel = QWidget()</span><br><span class="line">        layout = QVBoxLayout(panel)</span><br><span class="line">        </span><br><span class="line">        # å±æ€§ç¼–è¾‘å™¨</span><br><span class="line">        self.property_editor = PropertyEditor()</span><br><span class="line">        layout.addWidget(self.property_editor)</span><br><span class="line">        </span><br><span class="line">        # æ§åˆ¶å°è¾“å‡º</span><br><span class="line">        self.console_output = QTextEdit()</span><br><span class="line">        self.console_output.setReadOnly(True)</span><br><span class="line">        layout.addWidget(self.console_output)</span><br><span class="line">        </span><br><span class="line">        return panel</span><br><span class="line">    </span><br><span class="line">    def _setup_menu(self):</span><br><span class="line">        &quot;&quot;&quot;è®¾ç½®èœå•æ &quot;&quot;&quot;</span><br><span class="line">        menubar = self.menuBar()</span><br><span class="line">        </span><br><span class="line">        # æ–‡ä»¶èœå•</span><br><span class="line">        file_menu = menubar.addMenu(&quot;æ–‡ä»¶&quot;)</span><br><span class="line">        </span><br><span class="line">        new_project_action = QAction(&quot;æ–°å»ºé¡¹ç›®&quot;, self)</span><br><span class="line">        new_project_action.triggered.connect(self.new_project)</span><br><span class="line">        file_menu.addAction(new_project_action)</span><br><span class="line">        </span><br><span class="line">        open_project_action = QAction(&quot;æ‰“å¼€é¡¹ç›®&quot;, self)</span><br><span class="line">        open_project_action.triggered.connect(self.open_project)</span><br><span class="line">        file_menu.addAction(open_project_action)</span><br><span class="line">        </span><br><span class="line">        file_menu.addSeparator()</span><br><span class="line">        </span><br><span class="line">        save_action = QAction(&quot;ä¿å­˜&quot;, self)</span><br><span class="line">        save_action.setShortcut(QKeySequence.Save)</span><br><span class="line">        save_action.triggered.connect(self.save_project)</span><br><span class="line">        file_menu.addAction(save_action)</span><br><span class="line">        </span><br><span class="line">        # ç¼–è¾‘èœå•</span><br><span class="line">        edit_menu = menubar.addMenu(&quot;ç¼–è¾‘&quot;)</span><br><span class="line">        </span><br><span class="line">        undo_action = QAction(&quot;æ’¤é”€&quot;, self)</span><br><span class="line">        undo_action.setShortcut(QKeySequence.Undo)</span><br><span class="line">        edit_menu.addAction(undo_action)</span><br><span class="line">        </span><br><span class="line">        redo_action = QAction(&quot;é‡åš&quot;, self)</span><br><span class="line">        redo_action.setShortcut(QKeySequence.Redo)</span><br><span class="line">        edit_menu.addAction(redo_action)</span><br><span class="line">        </span><br><span class="line">        # è¿è¡Œèœå•</span><br><span class="line">        run_menu = menubar.addMenu(&quot;è¿è¡Œ&quot;)</span><br><span class="line">        </span><br><span class="line">        test_run_action = QAction(&quot;æµ‹è¯•è¿è¡Œ&quot;, self)</span><br><span class="line">        test_run_action.triggered.connect(self.test_run_game)</span><br><span class="line">        run_menu.addAction(test_run_action)</span><br><span class="line">        </span><br><span class="line">        export_action = QAction(&quot;å¯¼å‡ºæ¸¸æˆ&quot;, self)</span><br><span class="line">        export_action.triggered.connect(self.export_game)</span><br><span class="line">        run_menu.addAction(export_action)</span><br><span class="line">    </span><br><span class="line">    def _setup_toolbar(self):</span><br><span class="line">        &quot;&quot;&quot;è®¾ç½®å·¥å…·æ &quot;&quot;&quot;</span><br><span class="line">        toolbar = QToolBar(&quot;ä¸»å·¥å…·æ &quot;)</span><br><span class="line">        self.addToolBar(toolbar)</span><br><span class="line">        </span><br><span class="line">        # æ·»åŠ å·¥å…·æ æŒ‰é’®</span><br><span class="line">        toolbar.addAction(QIcon(&quot;icons/new.png&quot;), &quot;æ–°å»º&quot;)</span><br><span class="line">        toolbar.addAction(QIcon(&quot;icons/open.png&quot;), &quot;æ‰“å¼€&quot;)</span><br><span class="line">        toolbar.addSeparator()</span><br><span class="line">        toolbar.addAction(QIcon(&quot;icons/save.png&quot;), &quot;ä¿å­˜&quot;)</span><br><span class="line">        toolbar.addSeparator()</span><br><span class="line">        toolbar.addAction(QIcon(&quot;icons/run.png&quot;), &quot;è¿è¡Œ&quot;)</span><br><span class="line">    </span><br><span class="line">    def _connect_signals(self):</span><br><span class="line">        &quot;&quot;&quot;è¿æ¥ä¿¡å·å’Œæ§½&quot;&quot;&quot;</span><br><span class="line">        # æ¸¸æˆå¼•æ“äº‹ä»¶è¿æ¥åˆ°UIæ›´æ–°</span><br><span class="line">        self.game_engine.event_system.subscribe(&quot;game_start&quot;, </span><br><span class="line">                                              self.on_game_start)</span><br><span class="line">        self.game_engine.event_system.subscribe(&quot;game_pause&quot;,</span><br><span class="line">                                              self.on_game_pause)</span><br><span class="line">    </span><br><span class="line">    def new_project(self):</span><br><span class="line">        &quot;&quot;&quot;æ–°å»ºé¡¹ç›®&quot;&quot;&quot;</span><br><span class="line">        from gui.dialogs.new_project import NewProjectDialog</span><br><span class="line">        </span><br><span class="line">        dialog = NewProjectDialog(self)</span><br><span class="line">        if dialog.exec_():</span><br><span class="line">            project_name, project_path = dialog.get_project_info()</span><br><span class="line">            </span><br><span class="line">            try:</span><br><span class="line">                with self.db_manager.get_session() as session:</span><br><span class="line">                    project = Project(name=project_name)</span><br><span class="line">                    session.add(project)</span><br><span class="line">                </span><br><span class="line">                self.current_project = project</span><br><span class="line">                self._update_project_tree()</span><br><span class="line">                self.statusBar().showMessage(f&quot;å·²åˆ›å»ºé¡¹ç›®: &#123;project_name&#125;&quot;, 3000)</span><br><span class="line">                </span><br><span class="line">                # æ·»åŠ åˆ°æœ€è¿‘é¡¹ç›®</span><br><span class="line">                recent = self.config.get(&quot;recent_projects&quot;, [])</span><br><span class="line">                recent.insert(0, str(project_path))</span><br><span class="line">                self.config.set(&quot;recent_projects&quot;, recent[:10])</span><br><span class="line">                </span><br><span class="line">            except Exception as e:</span><br><span class="line">                QMessageBox.critical(self, &quot;é”™è¯¯&quot;, f&quot;åˆ›å»ºé¡¹ç›®å¤±è´¥: &#123;str(e)&#125;&quot;)</span><br><span class="line">    </span><br><span class="line">    def test_run_game(self):</span><br><span class="line">        &quot;&quot;&quot;æµ‹è¯•è¿è¡Œæ¸¸æˆ&quot;&quot;&quot;</span><br><span class="line">        if not self.current_project:</span><br><span class="line">            QMessageBox.warning(self, &quot;è­¦å‘Š&quot;, &quot;è¯·å…ˆåˆ›å»ºæˆ–æ‰“å¼€ä¸€ä¸ªé¡¹ç›®&quot;)</span><br><span class="line">            return</span><br><span class="line">        </span><br><span class="line">        # åœ¨æ–°çº¿ç¨‹ä¸­è¿è¡Œæ¸¸æˆ</span><br><span class="line">        import threading</span><br><span class="line">        def run_game():</span><br><span class="line">            self.game_engine.run()</span><br><span class="line">        </span><br><span class="line">        game_thread = threading.Thread(target=run_game, daemon=True)</span><br><span class="line">        game_thread.start()</span><br><span class="line">    </span><br><span class="line">    def _update_project_tree(self):</span><br><span class="line">        &quot;&quot;&quot;æ›´æ–°é¡¹ç›®æ ‘&quot;&quot;&quot;</span><br><span class="line">        self.project_tree.clear()</span><br><span class="line">        </span><br><span class="line">        if not self.current_project:</span><br><span class="line">            return</span><br><span class="line">        </span><br><span class="line">        root = QTreeWidgetItem(self.project_tree, [self.current_project.name])</span><br><span class="line">        root.setData(0, Qt.UserRole, (&quot;project&quot;, self.current_project.id))</span><br><span class="line">        </span><br><span class="line">        # æ·»åŠ å­é¡¹</span><br><span class="line">        maps_item = QTreeWidgetItem(root, [&quot;åœ°å›¾&quot;])</span><br><span class="line">        characters_item = QTreeWidgetItem(root, [&quot;è§’è‰²&quot;])</span><br><span class="line">        items_item = QTreeWidgetItem(root, [&quot;ç‰©å“&quot;])</span><br><span class="line">        events_item = QTreeWidgetItem(root, [&quot;äº‹ä»¶&quot;])</span><br><span class="line">        </span><br><span class="line">        # å±•å¼€æ ¹èŠ‚ç‚¹</span><br><span class="line">        root.setExpanded(True)</span><br><span class="line">    </span><br><span class="line">    def on_tree_item_clicked(self, item, column):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†æ ‘å½¢æ§ä»¶é¡¹ç‚¹å‡»&quot;&quot;&quot;</span><br><span class="line">        data = item.data(0, Qt.UserRole)</span><br><span class="line">        if data:</span><br><span class="line">            item_type, item_id = data</span><br><span class="line">            self._load_item_details(item_type, item_id)</span><br><span class="line">    </span><br><span class="line">    def closeEvent(self, event):</span><br><span class="line">        &quot;&quot;&quot;å…³é—­äº‹ä»¶&quot;&quot;&quot;</span><br><span class="line">        reply = QMessageBox.question(</span><br><span class="line">            self, &quot;ç¡®è®¤é€€å‡º&quot;,</span><br><span class="line">            &quot;ç¡®å®šè¦é€€å‡ºå—ï¼Ÿæœªä¿å­˜çš„æ›´æ”¹å°†ä¼šä¸¢å¤±ã€‚&quot;,</span><br><span class="line">            QMessageBox.Yes | QMessageBox.No,</span><br><span class="line">            QMessageBox.No</span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        if reply == QMessageBox.Yes:</span><br><span class="line">            # ä¿å­˜é…ç½®</span><br><span class="line">            self.config.save()</span><br><span class="line">            event.accept()</span><br><span class="line">        else:</span><br><span class="line">            event.ignore()</span><br></pre></td></tr></table></figure>



<h3 id="5-åœ°å›¾ç¼–è¾‘å™¨ç»„ä»¶"><a href="#5-åœ°å›¾ç¼–è¾‘å™¨ç»„ä»¶" class="headerlink" title="5. åœ°å›¾ç¼–è¾‘å™¨ç»„ä»¶"></a>5. åœ°å›¾ç¼–è¾‘å™¨ç»„ä»¶</h3><p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"># gui/map_editor.py - åœ°å›¾ç¼–è¾‘å™¨ï¼ˆå­¦ä¹ ï¼šCanvasç»˜åˆ¶ã€äº‹ä»¶å¤„ç†ï¼‰</span><br><span class="line">from PyQt5.QtWidgets import QWidget, QGraphicsView, QGraphicsScene</span><br><span class="line">from PyQt5.QtGui import QPainter, QPen, QBrush, QColor</span><br><span class="line">from PyQt5.QtCore import Qt, QPoint, QRect</span><br><span class="line"></span><br><span class="line">class MapEditorWidget(QWidget):</span><br><span class="line">    &quot;&quot;&quot;åœ°å›¾ç¼–è¾‘å™¨ç»„ä»¶&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self, game_engine):</span><br><span class="line">        super().__init__()</span><br><span class="line">        self.game_engine = game_engine</span><br><span class="line">        self.current_map = None</span><br><span class="line">        self.tile_size = 32</span><br><span class="line">        self.grid_enabled = True</span><br><span class="line">        </span><br><span class="line">        # ç»˜å›¾ç›¸å…³</span><br><span class="line">        self.drawing = False</span><br><span class="line">        self.current_tool = &quot;select&quot;</span><br><span class="line">        self.selected_tile = None</span><br><span class="line">        self.brush_color = QColor(100, 150, 200, 200)</span><br><span class="line">        </span><br><span class="line">        # åˆå§‹åŒ–UI</span><br><span class="line">        self._init_ui()</span><br><span class="line">        self._setup_shortcuts()</span><br><span class="line">    </span><br><span class="line">    def _init_ui(self):</span><br><span class="line">        &quot;&quot;&quot;åˆå§‹åŒ–UI&quot;&quot;&quot;</span><br><span class="line">        self.scene = QGraphicsScene()</span><br><span class="line">        self.view = MapGraphicsView(self.scene, self)</span><br><span class="line">        self.view.setRenderHint(QPainter.Antialiasing)</span><br><span class="line">        </span><br><span class="line">        # è®¾ç½®è§†å£</span><br><span class="line">        self.view.setHorizontalScrollBarPolicy(Qt.ScrollBarAlwaysOn)</span><br><span class="line">        self.view.setVerticalScrollBarPolicy(Qt.ScrollBarAlwaysOn)</span><br><span class="line">        </span><br><span class="line">        # å¸ƒå±€</span><br><span class="line">        from PyQt5.QtWidgets import QVBoxLayout</span><br><span class="line">        layout = QVBoxLayout()</span><br><span class="line">        layout.addWidget(self.view)</span><br><span class="line">        self.setLayout(layout)</span><br><span class="line">        </span><br><span class="line">        # åˆå§‹ç»˜åˆ¶</span><br><span class="line">        self.draw_grid()</span><br><span class="line">    </span><br><span class="line">    def draw_grid(self):</span><br><span class="line">        &quot;&quot;&quot;ç»˜åˆ¶ç½‘æ ¼&quot;&quot;&quot;</span><br><span class="line">        if not self.grid_enabled or not self.current_map:</span><br><span class="line">            return</span><br><span class="line">        </span><br><span class="line">        pen = QPen(QColor(100, 100, 100, 100), 1, Qt.DashLine)</span><br><span class="line">        brush = QBrush(Qt.NoBrush)</span><br><span class="line">        </span><br><span class="line">        for x in range(0, self.current_map.width * self.tile_size, self.tile_size):</span><br><span class="line">            self.scene.addLine(x, 0, x, self.current_map.height * self.tile_size, pen)</span><br><span class="line">        </span><br><span class="line">        for y in range(0, self.current_map.height * self.tile_size, self.tile_size):</span><br><span class="line">            self.scene.addLine(0, y, self.current_map.width * self.tile_size, y, pen)</span><br><span class="line">    </span><br><span class="line">    def mousePressEvent(self, event):</span><br><span class="line">        &quot;&quot;&quot;é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶&quot;&quot;&quot;</span><br><span class="line">        if event.button() == Qt.LeftButton:</span><br><span class="line">            pos = self.view.mapToScene(event.pos())</span><br><span class="line">            grid_x = int(pos.x() // self.tile_size)</span><br><span class="line">            grid_y = int(pos.y() // self.tile_size)</span><br><span class="line">            </span><br><span class="line">            if self.current_tool == &quot;pencil&quot;:</span><br><span class="line">                self.draw_tile(grid_x, grid_y)</span><br><span class="line">            elif self.current_tool == &quot;fill&quot;:</span><br><span class="line">                self.fill_area(grid_x, grid_y)</span><br><span class="line">            </span><br><span class="line">            self.drawing = True</span><br><span class="line">    </span><br><span class="line">    def draw_tile(self, x, y):</span><br><span class="line">        &quot;&quot;&quot;ç»˜åˆ¶å•ä¸ªç“¦ç‰‡&quot;&quot;&quot;</span><br><span class="line">        if not (0 &lt;= x &lt; self.current_map.width and </span><br><span class="line">                0 &lt;= y &lt; self.current_map.height):</span><br><span class="line">            return</span><br><span class="line">        </span><br><span class="line">        # æ›´æ–°åœ°å›¾æ•°æ®</span><br><span class="line">        self.current_map.tiles[y][x] = self.selected_tile</span><br><span class="line">        </span><br><span class="line">        # æ›´æ–°æ˜¾ç¤º</span><br><span class="line">        rect = QRect(x * self.tile_size, y * self.tile_size, </span><br><span class="line">                    self.tile_size, self.tile_size)</span><br><span class="line">        brush = QBrush(self.brush_color)</span><br><span class="line">        self.scene.addRect(rect, QPen(Qt.NoPen), brush)</span><br><span class="line">    </span><br><span class="line">    def fill_area(self, start_x, start_y):</span><br><span class="line">        &quot;&quot;&quot;åŒºåŸŸå¡«å……ï¼ˆæ´ªæ°´å¡«å……ç®—æ³•ï¼‰&quot;&quot;&quot;</span><br><span class="line">        if not self.selected_tile:</span><br><span class="line">            return</span><br><span class="line">        </span><br><span class="line">        target_tile = self.current_map.tiles[start_y][start_x]</span><br><span class="line">        if target_tile == self.selected_tile:</span><br><span class="line">            return</span><br><span class="line">        </span><br><span class="line">        # ä½¿ç”¨æ ˆå®ç°æ´ªæ°´å¡«å……</span><br><span class="line">        stack = [(start_x, start_y)]</span><br><span class="line">        visited = set()</span><br><span class="line">        </span><br><span class="line">        while stack:</span><br><span class="line">            x, y = stack.pop()</span><br><span class="line">            </span><br><span class="line">            if (x, y) in visited:</span><br><span class="line">                continue</span><br><span class="line">            </span><br><span class="line">            visited.add((x, y))</span><br><span class="line">            </span><br><span class="line">            if not (0 &lt;= x &lt; self.current_map.width and </span><br><span class="line">                    0 &lt;= y &lt; self.current_map.height):</span><br><span class="line">                continue</span><br><span class="line">            </span><br><span class="line">            if self.current_map.tiles[y][x] != target_tile:</span><br><span class="line">                continue</span><br><span class="line">            </span><br><span class="line">            self.draw_tile(x, y)</span><br><span class="line">            </span><br><span class="line">            # æ·»åŠ ç›¸é‚»ä½ç½®</span><br><span class="line">            stack.append((x + 1, y))</span><br><span class="line">            stack.append((x - 1, y))</span><br><span class="line">            stack.append((x, y + 1))</span><br><span class="line">            stack.append((x, y - 1))</span><br><span class="line">    </span><br><span class="line">    def _setup_shortcuts(self):</span><br><span class="line">        &quot;&quot;&quot;è®¾ç½®å¿«æ·é”®&quot;&quot;&quot;</span><br><span class="line">        from PyQt5.QtWidgets import QShortcut</span><br><span class="line">        from PyQt5.QtGui import QKeySequence</span><br><span class="line">        </span><br><span class="line">        # åˆ‡æ¢å·¥å…·</span><br><span class="line">        QShortcut(QKeySequence(&quot;P&quot;), self, lambda: self.set_tool(&quot;pencil&quot;))</span><br><span class="line">        QShortcut(QKeySequence(&quot;E&quot;), self, lambda: self.set_tool(&quot;eraser&quot;))</span><br><span class="line">        QShortcut(QKeySequence(&quot;F&quot;), self, lambda: self.set_tool(&quot;fill&quot;))</span><br><span class="line">        QShortcut(QKeySequence(&quot;G&quot;), self, self.toggle_grid)</span><br><span class="line"></span><br><span class="line">class MapGraphicsView(QGraphicsView):</span><br><span class="line">    &quot;&quot;&quot;è‡ªå®šä¹‰åœ°å›¾è§†å›¾ï¼Œæ”¯æŒç¼©æ”¾å’Œæ‹–æ‹½&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self, scene, parent=None):</span><br><span class="line">        super().__init__(scene, parent)</span><br><span class="line">        self.setDragMode(QGraphicsView.ScrollHandDrag)</span><br><span class="line">        self.setTransformationAnchor(QGraphicsView.AnchorUnderMouse)</span><br><span class="line">        self.setResizeAnchor(QGraphicsView.AnchorUnderMouse)</span><br><span class="line">        </span><br><span class="line">    def wheelEvent(self, event):</span><br><span class="line">        &quot;&quot;&quot;æ»šè½®ç¼©æ”¾&quot;&quot;&quot;</span><br><span class="line">        factor = 1.2</span><br><span class="line">        if event.angleDelta().y() &gt; 0:</span><br><span class="line">            self.scale(factor, factor)</span><br><span class="line">        else:</span><br><span class="line">            self.scale(1/factor, 1/factor)</span><br></pre></td></tr></table></figure>



<h3 id="6-è„šæœ¬ç³»ç»Ÿå’Œäº‹ä»¶ç³»ç»Ÿ"><a href="#6-è„šæœ¬ç³»ç»Ÿå’Œäº‹ä»¶ç³»ç»Ÿ" class="headerlink" title="6. è„šæœ¬ç³»ç»Ÿå’Œäº‹ä»¶ç³»ç»Ÿ"></a>6. è„šæœ¬ç³»ç»Ÿå’Œäº‹ä»¶ç³»ç»Ÿ</h3><p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line"># game/scripts/script_system.py - è„šæœ¬ç³»ç»Ÿï¼ˆå­¦ä¹ ï¼šè§£é‡Šå™¨æ¨¡å¼ã€ASTï¼‰</span><br><span class="line">import ast</span><br><span class="line">import types</span><br><span class="line">from typing import Dict, Any, List</span><br><span class="line"></span><br><span class="line">class ScriptInterpreter:</span><br><span class="line">    &quot;&quot;&quot;è„šæœ¬è§£é‡Šå™¨&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.globals: Dict[str, Any] = &#123;</span><br><span class="line">            &#x27;print&#x27;: self._script_print,</span><br><span class="line">            &#x27;set_variable&#x27;: self._set_variable,</span><br><span class="line">            &#x27;get_variable&#x27;: self._get_variable,</span><br><span class="line">            &#x27;show_message&#x27;: self._show_message,</span><br><span class="line">            &#x27;start_battle&#x27;: self._start_battle,</span><br><span class="line">        &#125;</span><br><span class="line">        self.locals: Dict[str, Any] = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">    def _script_print(self, *args):</span><br><span class="line">        &quot;&quot;&quot;è„šæœ¬ä¸­çš„printå‡½æ•°&quot;&quot;&quot;</span><br><span class="line">        print(&quot;[è„šæœ¬]&quot;, *args)</span><br><span class="line">    </span><br><span class="line">    def execute(self, script: str, context: Dict[str, Any] = None) -&gt; Any:</span><br><span class="line">        &quot;&quot;&quot;æ‰§è¡Œè„šæœ¬&quot;&quot;&quot;</span><br><span class="line">        if context:</span><br><span class="line">            self.locals.update(context)</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            # è§£æå’Œæ‰§è¡Œè„šæœ¬</span><br><span class="line">            tree = ast.parse(script, mode=&#x27;exec&#x27;)</span><br><span class="line">            code = compile(tree, &#x27;&lt;string&gt;&#x27;, &#x27;exec&#x27;)</span><br><span class="line">            exec(code, self.globals, self.locals)</span><br><span class="line">            </span><br><span class="line">            # è·å–æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼ˆå¦‚æœæœ‰ï¼‰</span><br><span class="line">            if tree.body and isinstance(tree.body[-1], ast.Expr):</span><br><span class="line">                expr_tree = ast.Expression(tree.body[-1].value)</span><br><span class="line">                expr_code = compile(expr_tree, &#x27;&lt;string&gt;&#x27;, &#x27;eval&#x27;)</span><br><span class="line">                return eval(expr_code, self.globals, self.locals)</span><br><span class="line">            </span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(f&quot;è„šæœ¬æ‰§è¡Œé”™è¯¯: &#123;e&#125;&quot;)</span><br><span class="line">            return None</span><br><span class="line"></span><br><span class="line"># game/systems/battle_system.py - æˆ˜æ–—ç³»ç»Ÿï¼ˆå­¦ä¹ ï¼šå›åˆåˆ¶ç®—æ³•ã€çŠ¶æ€æ•ˆæœï¼‰</span><br><span class="line">from enum import Enum</span><br><span class="line">from typing import List, Dict</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">class BattleAction(Enum):</span><br><span class="line">    ATTACK = &quot;attack&quot;</span><br><span class="line">    DEFEND = &quot;defend&quot;</span><br><span class="line">    SKILL = &quot;skill&quot;</span><br><span class="line">    ITEM = &quot;item&quot;</span><br><span class="line">    ESCAPE = &quot;escape&quot;</span><br><span class="line"></span><br><span class="line">class BattleSystem:</span><br><span class="line">    &quot;&quot;&quot;å›åˆåˆ¶æˆ˜æ–—ç³»ç»Ÿ&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self, game_engine):</span><br><span class="line">        self.game_engine = game_engine</span><br><span class="line">        self.in_battle = False</span><br><span class="line">        self.player_party: List = []</span><br><span class="line">        self.enemies: List = []</span><br><span class="line">        self.turn_order: List = []</span><br><span class="line">        self.current_turn = 0</span><br><span class="line">        self.battle_log: List[str] = []</span><br><span class="line">    </span><br><span class="line">    def start_battle(self, player_party: List, enemies: List):</span><br><span class="line">        &quot;&quot;&quot;å¼€å§‹æˆ˜æ–—&quot;&quot;&quot;</span><br><span class="line">        self.in_battle = True</span><br><span class="line">        self.player_party = player_party</span><br><span class="line">        self.enemies = enemies</span><br><span class="line">        </span><br><span class="line">        # è®¡ç®—è¡ŒåŠ¨é¡ºåºï¼ˆåŸºäºé€Ÿåº¦ï¼‰</span><br><span class="line">        self._calculate_turn_order()</span><br><span class="line">        </span><br><span class="line">        # å‘å¸ƒæˆ˜æ–—å¼€å§‹äº‹ä»¶</span><br><span class="line">        self.game_engine.event_system.emit(</span><br><span class="line">            GameEvent(&quot;battle_start&quot;, &#123;</span><br><span class="line">                &quot;player_party&quot;: player_party,</span><br><span class="line">                &quot;enemies&quot;: enemies</span><br><span class="line">            &#125;)</span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        self.battle_log.append(&quot;æˆ˜æ–—å¼€å§‹ï¼&quot;)</span><br><span class="line">    </span><br><span class="line">    def _calculate_turn_order(self):</span><br><span class="line">        &quot;&quot;&quot;è®¡ç®—è¡ŒåŠ¨é¡ºåº&quot;&quot;&quot;</span><br><span class="line">        all_combatants = self.player_party + self.enemies</span><br><span class="line">        </span><br><span class="line">        # æŒ‰é€Ÿåº¦æ’åºï¼Œé€Ÿåº¦ç›¸åŒåˆ™éšæœº</span><br><span class="line">        self.turn_order = sorted(</span><br><span class="line">            all_combatants,</span><br><span class="line">            key=lambda c: (c.speed, random.random()),</span><br><span class="line">            reverse=True</span><br><span class="line">        )</span><br><span class="line">    </span><br><span class="line">    def process_turn(self, combatant, action: BattleAction, target=None, **kwargs):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†ä¸€ä¸ªå›åˆ&quot;&quot;&quot;</span><br><span class="line">        if not self.in_battle:</span><br><span class="line">            return</span><br><span class="line">        </span><br><span class="line">        result = None</span><br><span class="line">        </span><br><span class="line">        if action == BattleAction.ATTACK:</span><br><span class="line">            result = self._process_attack(combatant, target)</span><br><span class="line">        elif action == BattleAction.DEFEND:</span><br><span class="line">            result = self._process_defend(combatant)</span><br><span class="line">        elif action == BattleAction.SKILL:</span><br><span class="line">            result = self._process_skill(combatant, target, kwargs.get(&#x27;skill&#x27;))</span><br><span class="line">        elif action == BattleAction.ESCAPE:</span><br><span class="line">            result = self._process_escape(combatant)</span><br><span class="line">        </span><br><span class="line">        # æ£€æŸ¥æˆ˜æ–—æ˜¯å¦ç»“æŸ</span><br><span class="line">        if self._check_battle_end():</span><br><span class="line">            self.end_battle()</span><br><span class="line">        </span><br><span class="line">        return result</span><br><span class="line">    </span><br><span class="line">    def _process_attack(self, attacker, target):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†æ”»å‡»&quot;&quot;&quot;</span><br><span class="line">        if not target:</span><br><span class="line">            return &#123;&quot;success&quot;: False, &quot;message&quot;: &quot;æ²¡æœ‰é€‰æ‹©ç›®æ ‡&quot;&#125;</span><br><span class="line">        </span><br><span class="line">        # è®¡ç®—å‘½ä¸­ç‡</span><br><span class="line">        hit_chance = 0.8 + (attacker.dexterity - target.dexterity) * 0.01</span><br><span class="line">        hit_chance = max(0.2, min(0.95, hit_chance))</span><br><span class="line">        </span><br><span class="line">        # æ˜¯å¦å‘½ä¸­</span><br><span class="line">        if random.random() &gt; hit_chance:</span><br><span class="line">            message = f&quot;&#123;attacker.name&#125; çš„æ”»å‡»è¢« &#123;target.name&#125; é—ªé¿äº†ï¼&quot;</span><br><span class="line">            self.battle_log.append(message)</span><br><span class="line">            return &#123;&quot;success&quot;: False, &quot;message&quot;: message&#125;</span><br><span class="line">        </span><br><span class="line">        # è®¡ç®—ä¼¤å®³</span><br><span class="line">        damage = attacker.attack - target.defense // 2</span><br><span class="line">        damage = max(1, damage)  # è‡³å°‘é€ æˆ1ç‚¹ä¼¤å®³</span><br><span class="line">        </span><br><span class="line">        # æš´å‡»åˆ¤æ–­</span><br><span class="line">        crit_chance = attacker.crit_rate</span><br><span class="line">        is_critical = random.random() &lt; crit_chance</span><br><span class="line">        </span><br><span class="line">        if is_critical:</span><br><span class="line">            damage = int(damage * 1.5)</span><br><span class="line">            message = f&quot;æš´å‡»ï¼&#123;attacker.name&#125; å¯¹ &#123;target.name&#125; é€ æˆäº† &#123;damage&#125; ç‚¹ä¼¤å®³ï¼&quot;</span><br><span class="line">        else:</span><br><span class="line">            message = f&quot;&#123;attacker.name&#125; å¯¹ &#123;target.name&#125; é€ æˆäº† &#123;damage&#125; ç‚¹ä¼¤å®³ï¼&quot;</span><br><span class="line">        </span><br><span class="line">        # åº”ç”¨ä¼¤å®³</span><br><span class="line">        target.hp -= damage</span><br><span class="line">        </span><br><span class="line">        self.battle_log.append(message)</span><br><span class="line">        </span><br><span class="line">        return &#123;</span><br><span class="line">            &quot;success&quot;: True,</span><br><span class="line">            &quot;damage&quot;: damage,</span><br><span class="line">            &quot;is_critical&quot;: is_critical,</span><br><span class="line">            &quot;message&quot;: message</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>



<h3 id="7-ç½‘ç»œåŠŸèƒ½ï¼ˆå¤šäººæ¸¸æˆï¼‰"><a href="#7-ç½‘ç»œåŠŸèƒ½ï¼ˆå¤šäººæ¸¸æˆï¼‰" class="headerlink" title="7. ç½‘ç»œåŠŸèƒ½ï¼ˆå¤šäººæ¸¸æˆï¼‰"></a>7. ç½‘ç»œåŠŸèƒ½ï¼ˆå¤šäººæ¸¸æˆï¼‰</h3><p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"># network/game_server.py - æ¸¸æˆæœåŠ¡å™¨ï¼ˆå­¦ä¹ ï¼šSocketç¼–ç¨‹ã€å¤šçº¿ç¨‹æœåŠ¡å™¨ï¼‰</span><br><span class="line">import socket</span><br><span class="line">import threading</span><br><span class="line">import json</span><br><span class="line">from typing import Dict, List</span><br><span class="line">from dataclasses import dataclass</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">@dataclass</span><br><span class="line">class Client:</span><br><span class="line">    &quot;&quot;&quot;å®¢æˆ·ç«¯è¿æ¥&quot;&quot;&quot;</span><br><span class="line">    conn: socket.socket</span><br><span class="line">    addr: str</span><br><span class="line">    player_id: str</span><br><span class="line">    last_heartbeat: float</span><br><span class="line"></span><br><span class="line">class GameServer:</span><br><span class="line">    &quot;&quot;&quot;å¤šäººæ¸¸æˆæœåŠ¡å™¨&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self, host=&#x27;127.0.0.1&#x27;, port=8888):</span><br><span class="line">        self.host = host</span><br><span class="line">        self.port = port</span><br><span class="line">        self.server_socket = None</span><br><span class="line">        self.running = False</span><br><span class="line">        </span><br><span class="line">        # å®¢æˆ·ç«¯ç®¡ç†</span><br><span class="line">        self.clients: Dict[str, Client] = &#123;&#125;</span><br><span class="line">        self.client_lock = threading.Lock()</span><br><span class="line">        </span><br><span class="line">        # æ¸¸æˆçŠ¶æ€</span><br><span class="line">        self.game_state = &#123;&#125;</span><br><span class="line">        self.game_lock = threading.Lock()</span><br><span class="line">        </span><br><span class="line">        # çº¿ç¨‹æ± </span><br><span class="line">        self.threads: List[threading.Thread] = []</span><br><span class="line">    </span><br><span class="line">    def start(self):</span><br><span class="line">        &quot;&quot;&quot;å¯åŠ¨æœåŠ¡å™¨&quot;&quot;&quot;</span><br><span class="line">        self.server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        self.server_socket.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            self.server_socket.bind((self.host, self.port))</span><br><span class="line">            self.server_socket.listen(5)</span><br><span class="line">            self.running = True</span><br><span class="line">            </span><br><span class="line">            print(f&quot;æœåŠ¡å™¨å¯åŠ¨åœ¨ &#123;self.host&#125;:&#123;self.port&#125;&quot;)</span><br><span class="line">            </span><br><span class="line">            # å¯åŠ¨å¿ƒè·³çº¿ç¨‹</span><br><span class="line">            heartbeat_thread = threading.Thread(target=self._heartbeat_checker, daemon=True)</span><br><span class="line">            heartbeat_thread.start()</span><br><span class="line">            </span><br><span class="line">            # æ¥å—è¿æ¥</span><br><span class="line">            while self.running:</span><br><span class="line">                try:</span><br><span class="line">                    conn, addr = self.server_socket.accept()</span><br><span class="line">                    client_thread = threading.Thread(</span><br><span class="line">                        target=self._handle_client,</span><br><span class="line">                        args=(conn, addr)</span><br><span class="line">                    )</span><br><span class="line">                    client_thread.start()</span><br><span class="line">                    self.threads.append(client_thread)</span><br><span class="line">                    </span><br><span class="line">                except Exception as e:</span><br><span class="line">                    if self.running:</span><br><span class="line">                        print(f&quot;æ¥å—è¿æ¥é”™è¯¯: &#123;e&#125;&quot;)</span><br><span class="line">                    </span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(f&quot;æœåŠ¡å™¨å¯åŠ¨å¤±è´¥: &#123;e&#125;&quot;)</span><br><span class="line">            self.stop()</span><br><span class="line">    </span><br><span class="line">    def _handle_client(self, conn: socket.socket, addr: str):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†å®¢æˆ·ç«¯è¿æ¥&quot;&quot;&quot;</span><br><span class="line">        client_id = None</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            # æ¥æ”¶å®¢æˆ·ç«¯è®¤è¯</span><br><span class="line">            data = conn.recv(1024).decode(&#x27;utf-8&#x27;)</span><br><span class="line">            if data:</span><br><span class="line">                message = json.loads(data)</span><br><span class="line">                </span><br><span class="line">                if message.get(&#x27;type&#x27;) == &#x27;auth&#x27;:</span><br><span class="line">                    client_id = message.get(&#x27;player_id&#x27;, str(addr))</span><br><span class="line">                    </span><br><span class="line">                    with self.client_lock:</span><br><span class="line">                        self.clients[client_id] = Client(</span><br><span class="line">                            conn=conn,</span><br><span class="line">                            addr=addr,</span><br><span class="line">                            player_id=client_id,</span><br><span class="line">                            last_heartbeat=time.time()</span><br><span class="line">                        )</span><br><span class="line">                    </span><br><span class="line">                    print(f&quot;å®¢æˆ·ç«¯ &#123;client_id&#125; å·²è¿æ¥&quot;)</span><br><span class="line">                    </span><br><span class="line">                    # å‘é€æ¬¢è¿æ¶ˆæ¯</span><br><span class="line">                    welcome_msg = &#123;</span><br><span class="line">                        &#x27;type&#x27;: &#x27;welcome&#x27;,</span><br><span class="line">                        &#x27;player_id&#x27;: client_id,</span><br><span class="line">                        &#x27;message&#x27;: &#x27;è¿æ¥æˆåŠŸ&#x27;</span><br><span class="line">                    &#125;</span><br><span class="line">                    conn.send(json.dumps(welcome_msg).encode(&#x27;utf-8&#x27;))</span><br><span class="line">                    </span><br><span class="line">                    # å¤„ç†å®¢æˆ·ç«¯æ¶ˆæ¯</span><br><span class="line">                    while self.running:</span><br><span class="line">                        try:</span><br><span class="line">                            data = conn.recv(1024)</span><br><span class="line">                            if not data:</span><br><span class="line">                                break</span><br><span class="line">                            </span><br><span class="line">                            message = json.loads(data.decode(&#x27;utf-8&#x27;))</span><br><span class="line">                            self._process_message(client_id, message)</span><br><span class="line">                            </span><br><span class="line">                        except json.JSONDecodeError:</span><br><span class="line">                            print(f&quot;æ— æ•ˆçš„JSONæ•°æ®æ¥è‡ª &#123;client_id&#125;&quot;)</span><br><span class="line">                            continue</span><br><span class="line">                        except ConnectionError:</span><br><span class="line">                            break</span><br><span class="line">                        </span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(f&quot;å¤„ç†å®¢æˆ·ç«¯ &#123;addr&#125; æ—¶å‡ºé”™: &#123;e&#125;&quot;)</span><br><span class="line">        finally:</span><br><span class="line">            if client_id:</span><br><span class="line">                with self.client_lock:</span><br><span class="line">                    if client_id in self.clients:</span><br><span class="line">                        del self.clients[client_id]</span><br><span class="line">                print(f&quot;å®¢æˆ·ç«¯ &#123;client_id&#125; å·²æ–­å¼€è¿æ¥&quot;)</span><br><span class="line">            conn.close()</span><br><span class="line">    </span><br><span class="line">    def _process_message(self, client_id: str, message: Dict):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†å®¢æˆ·ç«¯æ¶ˆæ¯&quot;&quot;&quot;</span><br><span class="line">        msg_type = message.get(&#x27;type&#x27;)</span><br><span class="line">        </span><br><span class="line">        if msg_type == &#x27;heartbeat&#x27;:</span><br><span class="line">            with self.client_lock:</span><br><span class="line">                if client_id in self.clients:</span><br><span class="line">                    self.clients[client_id].last_heartbeat = time.time()</span><br><span class="line">        </span><br><span class="line">        elif msg_type == &#x27;game_action&#x27;:</span><br><span class="line">            # å¤„ç†æ¸¸æˆåŠ¨ä½œ</span><br><span class="line">            action = message.get(&#x27;action&#x27;)</span><br><span class="line">            data = message.get(&#x27;data&#x27;, &#123;&#125;)</span><br><span class="line">            </span><br><span class="line">            # æ›´æ–°æ¸¸æˆçŠ¶æ€</span><br><span class="line">            with self.game_lock:</span><br><span class="line">                if &#x27;player_move&#x27; in action:</span><br><span class="line">                    # å¤„ç†ç©å®¶ç§»åŠ¨</span><br><span class="line">                    self.game_state.setdefault(&#x27;players&#x27;, &#123;&#125;)</span><br><span class="line">                    self.game_state[&#x27;players&#x27;][client_id] = data</span><br><span class="line">            </span><br><span class="line">            # å¹¿æ’­ç»™å…¶ä»–ç©å®¶</span><br><span class="line">            self._broadcast(&#123;</span><br><span class="line">                &#x27;type&#x27;: &#x27;player_update&#x27;,</span><br><span class="line">                &#x27;player_id&#x27;: client_id,</span><br><span class="line">                &#x27;data&#x27;: data</span><br><span class="line">            &#125;, exclude=client_id)</span><br><span class="line">    </span><br><span class="line">    def _broadcast(self, message: Dict, exclude: str = None):</span><br><span class="line">        &quot;&quot;&quot;å¹¿æ’­æ¶ˆæ¯ç»™æ‰€æœ‰å®¢æˆ·ç«¯&quot;&quot;&quot;</span><br><span class="line">        message_json = json.dumps(message)</span><br><span class="line">        </span><br><span class="line">        with self.client_lock:</span><br><span class="line">            for client_id, client in self.clients.items():</span><br><span class="line">                if client_id != exclude:</span><br><span class="line">                    try:</span><br><span class="line">                        client.conn.send(message_json.encode(&#x27;utf-8&#x27;))</span><br><span class="line">                    except:</span><br><span class="line">                        pass</span><br><span class="line">    </span><br><span class="line">    def _heartbeat_checker(self):</span><br><span class="line">        &quot;&quot;&quot;å¿ƒè·³æ£€æŸ¥ï¼Œæ£€æµ‹æ–­å¼€çš„è¿æ¥&quot;&quot;&quot;</span><br><span class="line">        while self.running:</span><br><span class="line">            time.sleep(30)  # æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡</span><br><span class="line">            </span><br><span class="line">            current_time = time.time()</span><br><span class="line">            disconnected = []</span><br><span class="line">            </span><br><span class="line">            with self.client_lock:</span><br><span class="line">                for client_id, client in self.clients.items():</span><br><span class="line">                    if current_time - client.last_heartbeat &gt; 60:  # 60ç§’æ— å¿ƒè·³</span><br><span class="line">                        disconnected.append(client_id)</span><br><span class="line">            </span><br><span class="line">            for client_id in disconnected:</span><br><span class="line">                print(f&quot;å®¢æˆ·ç«¯ &#123;client_id&#125; å¿ƒè·³è¶…æ—¶ï¼Œæ–­å¼€è¿æ¥&quot;)</span><br><span class="line">                with self.client_lock:</span><br><span class="line">                    if client_id in self.clients:</span><br><span class="line">                        try:</span><br><span class="line">                            self.clients[client_id].conn.close()</span><br><span class="line">                        except:</span><br><span class="line">                            pass</span><br><span class="line">                        del self.clients[client_id]</span><br><span class="line">    </span><br><span class="line">    def stop(self):</span><br><span class="line">        &quot;&quot;&quot;åœæ­¢æœåŠ¡å™¨&quot;&quot;&quot;</span><br><span class="line">        self.running = False</span><br><span class="line">        </span><br><span class="line">        # å…³é—­æ‰€æœ‰å®¢æˆ·ç«¯è¿æ¥</span><br><span class="line">        with self.client_lock:</span><br><span class="line">            for client in self.clients.values():</span><br><span class="line">                try:</span><br><span class="line">                    client.conn.close()</span><br><span class="line">                except:</span><br><span class="line">                    pass</span><br><span class="line">            self.clients.clear()</span><br><span class="line">        </span><br><span class="line">        # å…³é—­æœåŠ¡å™¨socket</span><br><span class="line">        if self.server_socket:</span><br><span class="line">            self.server_socket.close()</span><br><span class="line">        </span><br><span class="line">        print(&quot;æœåŠ¡å™¨å·²åœæ­¢&quot;)</span><br></pre></td></tr></table></figure>



<h3 id="8-ä¸»ç¨‹åºå…¥å£"><a href="#8-ä¸»ç¨‹åºå…¥å£" class="headerlink" title="8. ä¸»ç¨‹åºå…¥å£"></a>8. ä¸»ç¨‹åºå…¥å£</h3><p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># main.py - ä¸»ç¨‹åºå…¥å£</span><br><span class="line">import sys</span><br><span class="line">from PyQt5.QtWidgets import QApplication</span><br><span class="line">from gui.main_window import MainWindow</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    &quot;&quot;&quot;ä¸»å‡½æ•°&quot;&quot;&quot;</span><br><span class="line">    app = QApplication(sys.argv)</span><br><span class="line">    </span><br><span class="line">    # è®¾ç½®åº”ç”¨ç¨‹åºæ ·å¼</span><br><span class="line">    app.setStyle(&#x27;Fusion&#x27;)</span><br><span class="line">    </span><br><span class="line">    # åˆ›å»ºä¸»çª—å£</span><br><span class="line">    window = MainWindow()</span><br><span class="line">    window.show()</span><br><span class="line">    </span><br><span class="line">    # è¿è¡Œåº”ç”¨ç¨‹åº</span><br><span class="line">    sys.exit(app.exec_())</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>



<h2 id="ğŸ“‹-è¿è¡Œå’Œå®‰è£…è¯´æ˜"><a href="#ğŸ“‹-è¿è¡Œå’Œå®‰è£…è¯´æ˜" class="headerlink" title="ğŸ“‹ è¿è¡Œå’Œå®‰è£…è¯´æ˜"></a>ğŸ“‹ è¿è¡Œå’Œå®‰è£…è¯´æ˜</h2><h3 id="1-å®‰è£…ä¾èµ–"><a href="#1-å®‰è£…ä¾èµ–" class="headerlink" title="1. å®‰è£…ä¾èµ–"></a>1. å®‰è£…ä¾èµ–</h3><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span><br><span class="line">python -m venv venv</span><br><span class="line">source venv/bin/activate  # Linux/Mac</span><br><span class="line"># venv\Scripts\activate  # Windows</span><br><span class="line"></span><br><span class="line"># å®‰è£…ä¾èµ–</span><br><span class="line">pip install pygame PyQt5 sqlalchemy numpy pillow</span><br></pre></td></tr></table></figure>



<h3 id="2-é¡¹ç›®ç»“æ„"><a href="#2-é¡¹ç›®ç»“æ„" class="headerlink" title="2. é¡¹ç›®ç»“æ„"></a>2. é¡¹ç›®ç»“æ„</h3><p>text</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PyRPG-Maker/</span><br><span class="line">â”œâ”€â”€ requirements.txt</span><br><span class="line">â”œâ”€â”€ main.py</span><br><span class="line">â”œâ”€â”€ README.md</span><br><span class="line">â””â”€â”€ docs/</span><br><span class="line">    â””â”€â”€ tutorial.md</span><br></pre></td></tr></table></figure>



<h3 id="3-è¿è¡Œé¡¹ç›®"><a href="#3-è¿è¡Œé¡¹ç›®" class="headerlink" title="3. è¿è¡Œé¡¹ç›®"></a>3. è¿è¡Œé¡¹ç›®</h3><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python main.py</span><br></pre></td></tr></table></figure>



<h2 id="ğŸ¯-æ¶µç›–çš„æŠ€æœ¯æ ˆ"><a href="#ğŸ¯-æ¶µç›–çš„æŠ€æœ¯æ ˆ" class="headerlink" title="ğŸ¯ æ¶µç›–çš„æŠ€æœ¯æ ˆ"></a>ğŸ¯ æ¶µç›–çš„æŠ€æœ¯æ ˆ</h2><p>è¿™ä¸ªé¡¹ç›®æ¶µç›–äº†Pythonçš„<strong>å®Œæ•´æŠ€æœ¯æ ˆ</strong>ï¼š</p>
<h3 id="âœ…-åŸºç¡€æ ¸å¿ƒ"><a href="#âœ…-åŸºç¡€æ ¸å¿ƒ" class="headerlink" title="âœ… åŸºç¡€æ ¸å¿ƒ"></a>âœ… åŸºç¡€æ ¸å¿ƒ</h3><ul>
<li><strong>é¢å‘å¯¹è±¡ç¼–ç¨‹</strong>ï¼šç±»ã€ç»§æ‰¿ã€å¤šæ€ã€å°è£…</li>
<li><strong>è®¾è®¡æ¨¡å¼</strong>ï¼šå•ä¾‹ã€å·¥å‚ã€è§‚å¯Ÿè€…ã€çŠ¶æ€ã€è£…é¥°å™¨</li>
<li><strong>æ•°æ®ç»“æ„</strong>ï¼šåˆ—è¡¨ã€å­—å…¸ã€é›†åˆã€é˜Ÿåˆ—ã€æ ˆ</li>
<li><strong>ç®—æ³•</strong>ï¼šæ´ªæ°´å¡«å……ã€æ’åºã€è·¯å¾„æŸ¥æ‰¾</li>
</ul>
<h3 id="âœ…-é«˜çº§ç‰¹æ€§"><a href="#âœ…-é«˜çº§ç‰¹æ€§" class="headerlink" title="âœ… é«˜çº§ç‰¹æ€§"></a>âœ… é«˜çº§ç‰¹æ€§</h3><ul>
<li><strong>å¹¶å‘ç¼–ç¨‹</strong>ï¼šå¤šçº¿ç¨‹ã€çº¿ç¨‹æ± ã€é˜Ÿåˆ—</li>
<li><strong>å¼‚æ­¥ç¼–ç¨‹</strong>ï¼šä»»åŠ¡é˜Ÿåˆ—ã€äº‹ä»¶å¾ªç¯</li>
<li><strong>å…ƒç¼–ç¨‹</strong>ï¼šè£…é¥°å™¨ã€åŠ¨æ€å±æ€§</li>
</ul>
<h3 id="âœ…-GUIå¼€å‘"><a href="#âœ…-GUIå¼€å‘" class="headerlink" title="âœ… GUIå¼€å‘"></a>âœ… GUIå¼€å‘</h3><ul>
<li><strong>PyQt5</strong>ï¼šçª—å£ã€å¸ƒå±€ã€ä¿¡å·æ§½ã€è‡ªå®šä¹‰ç»„ä»¶</li>
<li><strong>å›¾å½¢ç»˜åˆ¶</strong>ï¼šCanvasã€QPainterã€QGraphics</li>
<li><strong>äº‹ä»¶å¤„ç†</strong>ï¼šé”®ç›˜ã€é¼ æ ‡ã€è‡ªå®šä¹‰äº‹ä»¶</li>
</ul>
<h3 id="âœ…-æ•°æ®å¤„ç†"><a href="#âœ…-æ•°æ®å¤„ç†" class="headerlink" title="âœ… æ•°æ®å¤„ç†"></a>âœ… æ•°æ®å¤„ç†</h3><ul>
<li><strong>SQLAlchemy</strong>ï¼šORMã€æ•°æ®åº“è®¾è®¡ã€äº‹åŠ¡</li>
<li><strong>åºåˆ—åŒ–</strong>ï¼šJSONã€Pickle</li>
<li><strong>æ–‡ä»¶æ“ä½œ</strong>ï¼šPathã€æ–‡ä»¶è¯»å†™</li>
</ul>
<h3 id="âœ…-æ¸¸æˆå¼€å‘"><a href="#âœ…-æ¸¸æˆå¼€å‘" class="headerlink" title="âœ… æ¸¸æˆå¼€å‘"></a>âœ… æ¸¸æˆå¼€å‘</h3><ul>
<li><strong>Pygame</strong>ï¼šæ¸¸æˆå¾ªç¯ã€ç²¾çµã€ç¢°æ’æ£€æµ‹</li>
<li><strong>æ¸¸æˆå¼•æ“</strong>ï¼šçŠ¶æ€æœºã€äº‹ä»¶ç³»ç»Ÿã€èµ„æºç®¡ç†</li>
<li><strong>æ¸¸æˆç®—æ³•</strong>ï¼šAIã€å¯»è·¯ã€æˆ˜æ–—ç³»ç»Ÿ</li>
</ul>
<h3 id="âœ…-ç½‘ç»œç¼–ç¨‹"><a href="#âœ…-ç½‘ç»œç¼–ç¨‹" class="headerlink" title="âœ… ç½‘ç»œç¼–ç¨‹"></a>âœ… ç½‘ç»œç¼–ç¨‹</h3><ul>
<li><strong>Socketç¼–ç¨‹</strong>ï¼šTCPæœåŠ¡å™¨ã€å®¢æˆ·ç«¯</li>
<li><strong>å¤šçº¿ç¨‹æœåŠ¡å™¨</strong>ï¼šè¿æ¥ç®¡ç†ã€å¿ƒè·³æ£€æµ‹</li>
<li><strong>åè®®è®¾è®¡</strong>ï¼šJSONæ¶ˆæ¯æ ¼å¼</li>
</ul>
<h3 id="âœ…-å·¥ç¨‹åŒ–"><a href="#âœ…-å·¥ç¨‹åŒ–" class="headerlink" title="âœ… å·¥ç¨‹åŒ–"></a>âœ… å·¥ç¨‹åŒ–</h3><ul>
<li><strong>æ¨¡å—åŒ–è®¾è®¡</strong>ï¼šåŒ…ç®¡ç†ã€å¯¼å…¥ç³»ç»Ÿ</li>
<li><strong>é…ç½®ç®¡ç†</strong>ï¼šé…ç½®æ–‡ä»¶ã€ç¯å¢ƒå˜é‡</li>
<li><strong>æ—¥å¿—ç³»ç»Ÿ</strong>ï¼šå¤šçº§æ—¥å¿—ã€æ—¥å¿—æ–‡ä»¶</li>
<li><strong>æµ‹è¯•</strong>ï¼šå•å…ƒæµ‹è¯•ï¼ˆæœªå±•ç¤ºä½†å¯æ·»åŠ ï¼‰</li>
<li><strong>æ–‡æ¡£</strong>ï¼šä»£ç æ³¨é‡Šã€README</li>
</ul>
<h2 id="ğŸš€-å¦‚ä½•æ‰©å±•é¡¹ç›®"><a href="#ğŸš€-å¦‚ä½•æ‰©å±•é¡¹ç›®" class="headerlink" title="ğŸš€ å¦‚ä½•æ‰©å±•é¡¹ç›®"></a>ğŸš€ å¦‚ä½•æ‰©å±•é¡¹ç›®</h2><h3 id="1-æ·»åŠ æ–°åŠŸèƒ½"><a href="#1-æ·»åŠ æ–°åŠŸèƒ½" class="headerlink" title="1. æ·»åŠ æ–°åŠŸèƒ½"></a>1. æ·»åŠ æ–°åŠŸèƒ½</h3><ul>
<li>æ·»åŠ <strong>ç²’å­ç³»ç»Ÿ</strong>ç”¨äºç‰¹æ•ˆ</li>
<li>å®ç°<strong>å¯»è·¯ç®—æ³•</strong>ï¼ˆA*ç®—æ³•ï¼‰</li>
<li>æ·»åŠ <strong>å£°éŸ³ç®¡ç†ç³»ç»Ÿ</strong></li>
<li>å®ç°<strong>ç½‘ç»œå¯¹æˆ˜</strong>åŠŸèƒ½</li>
</ul>
<h3 id="2-æ€§èƒ½ä¼˜åŒ–"><a href="#2-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="2. æ€§èƒ½ä¼˜åŒ–"></a>2. æ€§èƒ½ä¼˜åŒ–</h3><ul>
<li>ä½¿ç”¨<strong>Cython</strong>ä¼˜åŒ–æ€§èƒ½å…³é”®éƒ¨åˆ†</li>
<li>æ·»åŠ <strong>ç¼“å­˜æœºåˆ¶</strong>å‡å°‘èµ„æºåŠ è½½</li>
<li>å®ç°<strong>LODç³»ç»Ÿ</strong>ä¼˜åŒ–æ¸²æŸ“</li>
</ul>
<h3 id="3-éƒ¨ç½²å‘å¸ƒ"><a href="#3-éƒ¨ç½²å‘å¸ƒ" class="headerlink" title="3. éƒ¨ç½²å‘å¸ƒ"></a>3. éƒ¨ç½²å‘å¸ƒ</h3><ul>
<li>ä½¿ç”¨<strong>PyInstaller</strong>æ‰“åŒ…ä¸ºå¯æ‰§è¡Œæ–‡ä»¶</li>
<li>æ·»åŠ <strong>è‡ªåŠ¨æ›´æ–°</strong>åŠŸèƒ½</li>
<li>åˆ›å»º<strong>å®‰è£…ç¨‹åº</strong></li>
</ul>
<p>è¿™ä¸ªé¡¹ç›®æ˜¯ä¸€ä¸ª<strong>å®Œæ•´çš„æ¸¸æˆå¼€å‘å·¥å…·</strong>ï¼Œä¸ä»…å¯ä»¥å­¦ä¹ Pythonçš„å„ç§æŠ€æœ¯ï¼Œè¿˜èƒ½å®é™…åˆ¶ä½œå¯ç©çš„RPGæ¸¸æˆã€‚å»ºè®®<strong>åˆ†æ¨¡å—å­¦ä¹ </strong>ï¼Œå…ˆå®ç°æ ¸å¿ƒåŠŸèƒ½ï¼Œå†é€æ­¥æ·»åŠ é«˜çº§ç‰¹æ€§ã€‚</p>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">
    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/post/cd23736f.html" rel="prev" title="JavaScriptç”Ÿäº§åŠ›å·¥å…·è®¾è®¡ä¸å®ç°">
                  <i class="fa fa-angle-left"></i> JavaScriptç”Ÿäº§åŠ›å·¥å…·è®¾è®¡ä¸å®ç°
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa-regular fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder"></span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">419k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">25:23</span>
  </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.0/mermaid.min.js","integrity":"sha256-stuqcu2FrjYCXDOytWFA5SoUE/r3nkp6gTglzNSlavU="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>

  <script class="next-config" data-name="wavedrom" type="application/json">{"enable":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.5.0/wavedrom.min.js","integrity":"sha256-INLAoJc6quTNfiMWkGZniYO2cxE8mHpddnLow1m6RFs="}}</script>
  <script class="next-config" data-name="wavedrom_skin" type="application/json">{"enable":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.5.0/skins/default.js","integrity":"sha256-fduc/Zszk5ezWws2uInY/ALWVmIrmV6VTgXbsYSReFI="}}</script>
  <script src="/js/third-party/tags/wavedrom.js"></script>




  





</body>
</html>
