<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"timewait7.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":true,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="æˆ‘å°†ä¸ºæ‚¨åˆ›å»ºä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·ï¼ŒåŒ…å«å‘½ä»¤è¡Œç•Œé¢å’Œå›¾å½¢ç•Œé¢ã€‚è¿™ä¸ªå·¥å…·å°†æ¶µç›–æ•°æ®æ¸…æ´—çš„æ ¸å¿ƒæŠ€èƒ½ã€‚ python 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747">
<meta property="og:type" content="article">
<meta property="og:title" content="Pythonæ•°æ®æ¸…æ´—å·¥å…·è®¾è®¡ä¸å®ç°">
<meta property="og:url" content="http://timewait7.github.io/post/94c76a9b.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="æˆ‘å°†ä¸ºæ‚¨åˆ›å»ºä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·ï¼ŒåŒ…å«å‘½ä»¤è¡Œç•Œé¢å’Œå›¾å½¢ç•Œé¢ã€‚è¿™ä¸ªå·¥å…·å°†æ¶µç›–æ•°æ®æ¸…æ´—çš„æ ¸å¿ƒæŠ€èƒ½ã€‚ python 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-12-17T11:41:37.000Z">
<meta property="article:modified_time" content="2025-12-17T11:42:26.317Z">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://timewait7.github.io/post/94c76a9b.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://timewait7.github.io/post/94c76a9b.html","path":"post/94c76a9b.html","title":"Pythonæ•°æ®æ¸…æ´—å·¥å…·è®¾è®¡ä¸å®ç°"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Pythonæ•°æ®æ¸…æ´—å·¥å…·è®¾è®¡ä¸å®ç° | Hexo</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hexo</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-archives"><a href="/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="Searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%8E%AF-%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD"><span class="nav-number">1.</span> <span class="nav-text">ğŸ¯ æ ¸å¿ƒåŠŸèƒ½</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E4%B8%8E%E4%BF%9D%E5%AD%98"><span class="nav-number">1.1.</span> <span class="nav-text">1. æ•°æ®åŠ è½½ä¸ä¿å­˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E5%8A%9F%E8%83%BD"><span class="nav-number">1.2.</span> <span class="nav-text">2. æ•°æ®æ¸…æ´—åŠŸèƒ½</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%8A%9F%E8%83%BD"><span class="nav-number">1.3.</span> <span class="nav-text">3. æ•°æ®åˆ†æåŠŸèƒ½</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%96%A5%EF%B8%8F-%E4%B8%A4%E7%A7%8D%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="nav-number">2.</span> <span class="nav-text">ğŸ–¥ï¸ ä¸¤ç§ä½¿ç”¨æ–¹å¼</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%95%8C%E9%9D%A2%EF%BC%88CLI%EF%BC%89"><span class="nav-number">2.1.</span> <span class="nav-text">1. å‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%EF%BC%88GUI%EF%BC%89"><span class="nav-number">2.2.</span> <span class="nav-text">2. å›¾å½¢ç•Œé¢ï¼ˆGUIï¼‰</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%A6-%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96"><span class="nav-number">3.</span> <span class="nav-text">ğŸ“¦ å®‰è£…ä¾èµ–</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%9A%80-%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="nav-number">4.</span> <span class="nav-text">ğŸš€ ä½¿ç”¨ç¤ºä¾‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%8A-%E7%89%B9%E8%89%B2%E5%8A%9F%E8%83%BD"><span class="nav-number">5.</span> <span class="nav-text">ğŸ“Š ç‰¹è‰²åŠŸèƒ½</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web%E7%95%8C%E9%9D%A2%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7"><span class="nav-number"></span> <span class="nav-text">Webç•Œé¢æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%9A%80-%E5%A6%82%E4%BD%95%E8%BF%90%E8%A1%8C"><span class="nav-number">1.</span> <span class="nav-text">ğŸš€ å¦‚ä½•è¿è¡Œ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96"><span class="nav-number">1.1.</span> <span class="nav-text">1. å®‰è£…ä¾èµ–</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%90%AF%E5%8A%A8Web%E5%BA%94%E7%94%A8"><span class="nav-number">1.2.</span> <span class="nav-text">2. å¯åŠ¨Webåº”ç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%9C%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E8%AE%BF%E9%97%AE"><span class="nav-number">1.3.</span> <span class="nav-text">3. åœ¨æµè§ˆå™¨ä¸­è®¿é—®</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%8C%90-%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD"><span class="nav-number">2.</span> <span class="nav-text">ğŸŒ ä¸»è¦åŠŸèƒ½</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%95%B0%E6%8D%AE%E4%B8%8A%E4%BC%A0"><span class="nav-number">2.1.</span> <span class="nav-text">1. æ•°æ®ä¸Šä¼ </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%95%B0%E6%8D%AE%E6%8E%A2%E7%B4%A2"><span class="nav-number">2.2.</span> <span class="nav-text">2. æ•°æ®æ¢ç´¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E6%93%8D%E4%BD%9C"><span class="nav-number">2.3.</span> <span class="nav-text">3. æ•°æ®æ¸…æ´—æ“ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA"><span class="nav-number">2.4.</span> <span class="nav-text">4. æ•°æ®å¯¼å‡º</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E5%85%B6%E4%BB%96%E5%8A%9F%E8%83%BD"><span class="nav-number">2.5.</span> <span class="nav-text">5. å…¶ä»–åŠŸèƒ½</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%8E%A8-%E7%95%8C%E9%9D%A2%E7%89%B9%E7%82%B9"><span class="nav-number">3.</span> <span class="nav-text">ğŸ¨ ç•Œé¢ç‰¹ç‚¹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%8A-%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="nav-number">4.</span> <span class="nav-text">ğŸ“Š ä½¿ç”¨ç¤ºä¾‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%94%A7-%E6%8A%80%E6%9C%AF%E6%9E%B6%E6%9E%84"><span class="nav-number">5.</span> <span class="nav-text">ğŸ”§ æŠ€æœ¯æ¶æ„</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/">
          <span class="site-state-item-count">53</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://timewait7.github.io/post/94c76a9b.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Pythonæ•°æ®æ¸…æ´—å·¥å…·è®¾è®¡ä¸å®ç° | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Pythonæ•°æ®æ¸…æ´—å·¥å…·è®¾è®¡ä¸å®ç°
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2025-12-17 19:41:37" itemprop="dateCreated datePublished" datetime="2025-12-17T19:41:37+08:00">2025-12-17</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>18k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>1:06</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>æˆ‘å°†ä¸ºæ‚¨åˆ›å»ºä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·ï¼ŒåŒ…å«å‘½ä»¤è¡Œç•Œé¢å’Œå›¾å½¢ç•Œé¢ã€‚è¿™ä¸ªå·¥å…·å°†æ¶µç›–æ•°æ®æ¸…æ´—çš„æ ¸å¿ƒæŠ€èƒ½ã€‚</p>
<p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line">import argparse</span><br><span class="line">import sys</span><br><span class="line">import os</span><br><span class="line">import json</span><br><span class="line">from datetime import datetime</span><br><span class="line">import warnings</span><br><span class="line">warnings.filterwarnings(&#x27;ignore&#x27;)</span><br><span class="line"></span><br><span class="line"># GUIç›¸å…³åº“</span><br><span class="line">try:</span><br><span class="line">    import tkinter as tk</span><br><span class="line">    from tkinter import ttk, filedialog, messagebox, scrolledtext</span><br><span class="line">    from tkinter import font as tkfont</span><br><span class="line">    import matplotlib.pyplot as plt</span><br><span class="line">    from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg</span><br><span class="line">    import seaborn as sns</span><br><span class="line">    GUI_AVAILABLE = True</span><br><span class="line">except ImportError:</span><br><span class="line">    GUI_AVAILABLE = False</span><br><span class="line">    print(&quot;GUIç»„ä»¶ä¸å¯ç”¨ï¼Œè¯·å®‰è£…tkinter, matplotlib, seaborn&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class DataCleaner:</span><br><span class="line">    &quot;&quot;&quot;æ•°æ®æ¸…æ´—æ ¸å¿ƒç±»&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self, data=None):</span><br><span class="line">        self.data = data</span><br><span class="line">        self.original_data = None</span><br><span class="line">        self.history = []</span><br><span class="line">        </span><br><span class="line">    def load_data(self, file_path, **kwargs):</span><br><span class="line">        &quot;&quot;&quot;åŠ è½½æ•°æ®æ–‡ä»¶&quot;&quot;&quot;</span><br><span class="line">        try:</span><br><span class="line">            ext = os.path.splitext(file_path)[1].lower()</span><br><span class="line">            </span><br><span class="line">            if ext == &#x27;.csv&#x27;:</span><br><span class="line">                self.data = pd.read_csv(file_path, **kwargs)</span><br><span class="line">            elif ext in [&#x27;.xls&#x27;, &#x27;.xlsx&#x27;]:</span><br><span class="line">                self.data = pd.read_excel(file_path, **kwargs)</span><br><span class="line">            elif ext == &#x27;.json&#x27;:</span><br><span class="line">                self.data = pd.read_json(file_path, **kwargs)</span><br><span class="line">            elif ext == &#x27;.parquet&#x27;:</span><br><span class="line">                self.data = pd.read_parquet(file_path, **kwargs)</span><br><span class="line">            elif ext == &#x27;.feather&#x27;:</span><br><span class="line">                self.data = pd.read_feather(file_path, **kwargs)</span><br><span class="line">            else:</span><br><span class="line">                raise ValueError(f&quot;ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼: &#123;ext&#125;&quot;)</span><br><span class="line">                </span><br><span class="line">            self.original_data = self.data.copy()</span><br><span class="line">            self.add_history(f&quot;åŠ è½½æ–‡ä»¶: &#123;file_path&#125;&quot;)</span><br><span class="line">            return True</span><br><span class="line">            </span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(f&quot;åŠ è½½æ–‡ä»¶å¤±è´¥: &#123;e&#125;&quot;)</span><br><span class="line">            return False</span><br><span class="line">    </span><br><span class="line">    def save_data(self, file_path):</span><br><span class="line">        &quot;&quot;&quot;ä¿å­˜æ•°æ®&quot;&quot;&quot;</span><br><span class="line">        try:</span><br><span class="line">            ext = os.path.splitext(file_path)[1].lower()</span><br><span class="line">            </span><br><span class="line">            if ext == &#x27;.csv&#x27;:</span><br><span class="line">                self.data.to_csv(file_path, index=False)</span><br><span class="line">            elif ext in [&#x27;.xls&#x27;, &#x27;.xlsx&#x27;]:</span><br><span class="line">                self.data.to_excel(file_path, index=False)</span><br><span class="line">            elif ext == &#x27;.json&#x27;:</span><br><span class="line">                self.data.to_json(file_path, orient=&#x27;records&#x27;)</span><br><span class="line">            elif ext == &#x27;.parquet&#x27;:</span><br><span class="line">                self.data.to_parquet(file_path, index=False)</span><br><span class="line">            elif ext == &#x27;.feather&#x27;:</span><br><span class="line">                self.data.to_feather(file_path)</span><br><span class="line">            else:</span><br><span class="line">                self.data.to_csv(file_path, index=False)</span><br><span class="line">                </span><br><span class="line">            self.add_history(f&quot;ä¿å­˜æ–‡ä»¶: &#123;file_path&#125;&quot;)</span><br><span class="line">            return True</span><br><span class="line">            </span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(f&quot;ä¿å­˜æ–‡ä»¶å¤±è´¥: &#123;e&#125;&quot;)</span><br><span class="line">            return False</span><br><span class="line">    </span><br><span class="line">    def get_info(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–æ•°æ®åŸºæœ¬ä¿¡æ¯&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return &quot;æ²¡æœ‰åŠ è½½æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        info = &#123;</span><br><span class="line">            &#x27;shape&#x27;: self.data.shape,</span><br><span class="line">            &#x27;columns&#x27;: list(self.data.columns),</span><br><span class="line">            &#x27;dtypes&#x27;: self.data.dtypes.to_dict(),</span><br><span class="line">            &#x27;null_counts&#x27;: self.data.isnull().sum().to_dict(),</span><br><span class="line">            &#x27;memory_usage&#x27;: self.data.memory_usage(deep=True).sum(),</span><br><span class="line">            &#x27;describe&#x27;: self.data.describe().to_dict() if len(self.data.select_dtypes(include=[np.number]).columns) &gt; 0 else &#123;&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return info</span><br><span class="line">    </span><br><span class="line">    def handle_missing_values(self, strategy=&#x27;mean&#x27;, columns=None, custom_value=None):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†ç¼ºå¤±å€¼&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False</span><br><span class="line">        </span><br><span class="line">        if columns is None:</span><br><span class="line">            columns = self.data.columns</span><br><span class="line">        </span><br><span class="line">        for col in columns:</span><br><span class="line">            if col in self.data.columns:</span><br><span class="line">                if strategy == &#x27;drop&#x27;:</span><br><span class="line">                    self.data = self.data.dropna(subset=[col])</span><br><span class="line">                elif strategy == &#x27;mean&#x27; and self.data[col].dtype in [np.float64, np.int64]:</span><br><span class="line">                    self.data[col] = self.data[col].fillna(self.data[col].mean())</span><br><span class="line">                elif strategy == &#x27;median&#x27; and self.data[col].dtype in [np.float64, np.int64]:</span><br><span class="line">                    self.data[col] = self.data[col].fillna(self.data[col].median())</span><br><span class="line">                elif strategy == &#x27;mode&#x27;:</span><br><span class="line">                    self.data[col] = self.data[col].fillna(self.data[col].mode()[0] if not self.data[col].mode().empty else custom_value)</span><br><span class="line">                elif strategy == &#x27;forward&#x27;:</span><br><span class="line">                    self.data[col] = self.data[col].fillna(method=&#x27;ffill&#x27;)</span><br><span class="line">                elif strategy == &#x27;backward&#x27;:</span><br><span class="line">                    self.data[col] = self.data[col].fillna(method=&#x27;bfill&#x27;)</span><br><span class="line">                elif strategy == &#x27;custom&#x27;:</span><br><span class="line">                    self.data[col] = self.data[col].fillna(custom_value)</span><br><span class="line">        </span><br><span class="line">        self.add_history(f&quot;å¤„ç†ç¼ºå¤±å€¼: &#123;strategy&#125;&quot;)</span><br><span class="line">        return True</span><br><span class="line">    </span><br><span class="line">    def remove_duplicates(self, subset=None, keep=&#x27;first&#x27;):</span><br><span class="line">        &quot;&quot;&quot;å»é™¤é‡å¤å€¼&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False</span><br><span class="line">        </span><br><span class="line">        before = len(self.data)</span><br><span class="line">        self.data = self.data.drop_duplicates(subset=subset, keep=keep)</span><br><span class="line">        after = len(self.data)</span><br><span class="line">        </span><br><span class="line">        self.add_history(f&quot;å»é™¤é‡å¤å€¼: ä» &#123;before&#125; è¡Œå‡å°‘åˆ° &#123;after&#125; è¡Œ&quot;)</span><br><span class="line">        return True</span><br><span class="line">    </span><br><span class="line">    def change_column_type(self, column, new_type):</span><br><span class="line">        &quot;&quot;&quot;æ›´æ”¹åˆ—æ•°æ®ç±»å‹&quot;&quot;&quot;</span><br><span class="line">        if self.data is None or column not in self.data.columns:</span><br><span class="line">            return False</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            old_type = str(self.data[column].dtype)</span><br><span class="line">            </span><br><span class="line">            if new_type == &#x27;int&#x27;:</span><br><span class="line">                self.data[column] = pd.to_numeric(self.data[column], errors=&#x27;coerce&#x27;).astype(&#x27;Int64&#x27;)</span><br><span class="line">            elif new_type == &#x27;float&#x27;:</span><br><span class="line">                self.data[column] = pd.to_numeric(self.data[column], errors=&#x27;coerce&#x27;).astype(&#x27;float64&#x27;)</span><br><span class="line">            elif new_type == &#x27;str&#x27;:</span><br><span class="line">                self.data[column] = self.data[column].astype(str)</span><br><span class="line">            elif new_type == &#x27;datetime&#x27;:</span><br><span class="line">                self.data[column] = pd.to_datetime(self.data[column], errors=&#x27;coerce&#x27;)</span><br><span class="line">            elif new_type == &#x27;category&#x27;:</span><br><span class="line">                self.data[column] = self.data[column].astype(&#x27;category&#x27;)</span><br><span class="line">            elif new_type == &#x27;bool&#x27;:</span><br><span class="line">                self.data[column] = self.data[column].astype(bool)</span><br><span class="line">            </span><br><span class="line">            self.add_history(f&quot;æ›´æ”¹åˆ—ç±»å‹: &#123;column&#125; ä» &#123;old_type&#125; æ”¹ä¸º &#123;new_type&#125;&quot;)</span><br><span class="line">            return True</span><br><span class="line">            </span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(f&quot;ç±»å‹è½¬æ¢å¤±è´¥: &#123;e&#125;&quot;)</span><br><span class="line">            return False</span><br><span class="line">    </span><br><span class="line">    def rename_columns(self, rename_dict):</span><br><span class="line">        &quot;&quot;&quot;é‡å‘½ååˆ—&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False</span><br><span class="line">        </span><br><span class="line">        self.data = self.data.rename(columns=rename_dict)</span><br><span class="line">        self.add_history(f&quot;é‡å‘½ååˆ—: &#123;rename_dict&#125;&quot;)</span><br><span class="line">        return True</span><br><span class="line">    </span><br><span class="line">    def filter_data(self, condition):</span><br><span class="line">        &quot;&quot;&quot;è¿‡æ»¤æ•°æ®&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            # ä½¿ç”¨evalè¿›è¡Œæ¡ä»¶è¿‡æ»¤</span><br><span class="line">            self.data = self.data.query(condition)</span><br><span class="line">            self.add_history(f&quot;æ•°æ®è¿‡æ»¤: &#123;condition&#125;&quot;)</span><br><span class="line">            return True</span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(f&quot;è¿‡æ»¤æ¡ä»¶é”™è¯¯: &#123;e&#125;&quot;)</span><br><span class="line">            return False</span><br><span class="line">    </span><br><span class="line">    def drop_columns(self, columns):</span><br><span class="line">        &quot;&quot;&quot;åˆ é™¤åˆ—&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False</span><br><span class="line">        </span><br><span class="line">        self.data = self.data.drop(columns=columns, errors=&#x27;ignore&#x27;)</span><br><span class="line">        self.add_history(f&quot;åˆ é™¤åˆ—: &#123;columns&#125;&quot;)</span><br><span class="line">        return True</span><br><span class="line">    </span><br><span class="line">    def normalize_column(self, column, method=&#x27;minmax&#x27;):</span><br><span class="line">        &quot;&quot;&quot;æ ‡å‡†åŒ–/å½’ä¸€åŒ–æ•°å€¼åˆ—&quot;&quot;&quot;</span><br><span class="line">        if self.data is None or column not in self.data.columns:</span><br><span class="line">            return False</span><br><span class="line">        </span><br><span class="line">        if method == &#x27;minmax&#x27;:</span><br><span class="line">            min_val = self.data[column].min()</span><br><span class="line">            max_val = self.data[column].max()</span><br><span class="line">            if max_val != min_val:</span><br><span class="line">                self.data[column] = (self.data[column] - min_val) / (max_val - min_val)</span><br><span class="line">        elif method == &#x27;zscore&#x27;:</span><br><span class="line">            mean_val = self.data[column].mean()</span><br><span class="line">            std_val = self.data[column].std()</span><br><span class="line">            if std_val != 0:</span><br><span class="line">                self.data[column] = (self.data[column] - mean_val) / std_val</span><br><span class="line">        </span><br><span class="line">        self.add_history(f&quot;æ ‡å‡†åŒ–åˆ—: &#123;column&#125; ä½¿ç”¨ &#123;method&#125;&quot;)</span><br><span class="line">        return True</span><br><span class="line">    </span><br><span class="line">    def handle_outliers(self, column, method=&#x27;iqr&#x27;, threshold=1.5):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†å¼‚å¸¸å€¼&quot;&quot;&quot;</span><br><span class="line">        if self.data is None or column not in self.data.columns:</span><br><span class="line">            return False</span><br><span class="line">        </span><br><span class="line">        if method == &#x27;iqr&#x27;:</span><br><span class="line">            Q1 = self.data[column].quantile(0.25)</span><br><span class="line">            Q3 = self.data[column].quantile(0.75)</span><br><span class="line">            IQR = Q3 - Q1</span><br><span class="line">            lower_bound = Q1 - threshold * IQR</span><br><span class="line">            upper_bound = Q3 + threshold * IQR</span><br><span class="line">            </span><br><span class="line">            # æ›¿æ¢ä¸ºè¾¹ç•Œå€¼</span><br><span class="line">            self.data[column] = self.data[column].clip(lower_bound, upper_bound)</span><br><span class="line">            </span><br><span class="line">        elif method == &#x27;zscore&#x27;:</span><br><span class="line">            mean_val = self.data[column].mean()</span><br><span class="line">            std_val = self.data[column].std()</span><br><span class="line">            z_scores = np.abs((self.data[column] - mean_val) / std_val)</span><br><span class="line">            # æ›¿æ¢å¼‚å¸¸å€¼ä¸ºå‡å€¼</span><br><span class="line">            self.data.loc[z_scores &gt; threshold, column] = mean_val</span><br><span class="line">        </span><br><span class="line">        self.add_history(f&quot;å¤„ç†å¼‚å¸¸å€¼: &#123;column&#125; ä½¿ç”¨ &#123;method&#125;&quot;)</span><br><span class="line">        return True</span><br><span class="line">    </span><br><span class="line">    def encode_categorical(self, column, method=&#x27;onehot&#x27;):</span><br><span class="line">        &quot;&quot;&quot;ç¼–ç åˆ†ç±»å˜é‡&quot;&quot;&quot;</span><br><span class="line">        if self.data is None or column not in self.data.columns:</span><br><span class="line">            return False</span><br><span class="line">        </span><br><span class="line">        if method == &#x27;onehot&#x27;:</span><br><span class="line">            dummies = pd.get_dummies(self.data[column], prefix=column)</span><br><span class="line">            self.data = pd.concat([self.data, dummies], axis=1)</span><br><span class="line">        elif method == &#x27;label&#x27;:</span><br><span class="line">            from sklearn.preprocessing import LabelEncoder</span><br><span class="line">            le = LabelEncoder()</span><br><span class="line">            self.data[column + &#x27;_encoded&#x27;] = le.fit_transform(self.data[column])</span><br><span class="line">        </span><br><span class="line">        self.add_history(f&quot;ç¼–ç åˆ†ç±»å˜é‡: &#123;column&#125; ä½¿ç”¨ &#123;method&#125;&quot;)</span><br><span class="line">        return True</span><br><span class="line">    </span><br><span class="line">    def extract_datetime_features(self, column):</span><br><span class="line">        &quot;&quot;&quot;ä»æ—¥æœŸæ—¶é—´åˆ—æå–ç‰¹å¾&quot;&quot;&quot;</span><br><span class="line">        if self.data is None or column not in self.data.columns:</span><br><span class="line">            return False</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            self.data[column] = pd.to_datetime(self.data[column])</span><br><span class="line">            self.data[f&#x27;&#123;column&#125;_year&#x27;] = self.data[column].dt.year</span><br><span class="line">            self.data[f&#x27;&#123;column&#125;_month&#x27;] = self.data[column].dt.month</span><br><span class="line">            self.data[f&#x27;&#123;column&#125;_day&#x27;] = self.data[column].dt.day</span><br><span class="line">            self.data[f&#x27;&#123;column&#125;_weekday&#x27;] = self.data[column].dt.weekday</span><br><span class="line">            self.data[f&#x27;&#123;column&#125;_hour&#x27;] = self.data[column].dt.hour</span><br><span class="line">            </span><br><span class="line">            self.add_history(f&quot;æå–æ—¥æœŸç‰¹å¾: &#123;column&#125;&quot;)</span><br><span class="line">            return True</span><br><span class="line">        except:</span><br><span class="line">            return False</span><br><span class="line">    </span><br><span class="line">    def add_history(self, action):</span><br><span class="line">        &quot;&quot;&quot;è®°å½•æ“ä½œå†å²&quot;&quot;&quot;</span><br><span class="line">        self.history.append(&#123;</span><br><span class="line">            &#x27;timestamp&#x27;: datetime.now().strftime(&quot;%Y-%m-%d %H:%M:%S&quot;),</span><br><span class="line">            &#x27;action&#x27;: action,</span><br><span class="line">            &#x27;shape&#x27;: self.data.shape if self.data is not None else None</span><br><span class="line">        &#125;)</span><br><span class="line">    </span><br><span class="line">    def undo(self):</span><br><span class="line">        &quot;&quot;&quot;æ’¤é”€ä¸Šä¸€æ­¥æ“ä½œ&quot;&quot;&quot;</span><br><span class="line">        if len(self.history) &gt; 1 and self.original_data is not None:</span><br><span class="line">            self.history.pop()</span><br><span class="line">            # é‡æ–°æ‰§è¡Œæ‰€æœ‰å†å²æ“ä½œï¼ˆç®€å•å®ç°ï¼‰</span><br><span class="line">            temp_data = self.original_data.copy()</span><br><span class="line">            for record in self.history[1:]:  # è·³è¿‡åŠ è½½æ•°æ®çš„è®°å½•</span><br><span class="line">                # è¿™é‡Œéœ€è¦å®ç°æ¯ä¸ªæ“ä½œçš„é€†æ“ä½œï¼Œç®€åŒ–å¤„ç†</span><br><span class="line">                pass</span><br><span class="line">            return True</span><br><span class="line">        return False</span><br><span class="line">    </span><br><span class="line">    def generate_report(self):</span><br><span class="line">        &quot;&quot;&quot;ç”Ÿæˆæ•°æ®æ¸…æ´—æŠ¥å‘Š&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return &quot;æ²¡æœ‰å¯ç”¨çš„æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        report = []</span><br><span class="line">        report.append(&quot;=&quot; * 60)</span><br><span class="line">        report.append(&quot;æ•°æ®æ¸…æ´—æŠ¥å‘Š&quot;)</span><br><span class="line">        report.append(&quot;=&quot; * 60)</span><br><span class="line">        report.append(f&quot;ç”Ÿæˆæ—¶é—´: &#123;datetime.now().strftime(&#x27;%Y-%m-%d %H:%M:%S&#x27;)&#125;&quot;)</span><br><span class="line">        report.append(f&quot;æ•°æ®å½¢çŠ¶: &#123;self.data.shape&#125;&quot;)</span><br><span class="line">        report.append(f&quot;åˆ—æ•°: &#123;len(self.data.columns)&#125;&quot;)</span><br><span class="line">        report.append(f&quot;è¡Œæ•°: &#123;len(self.data)&#125;&quot;)</span><br><span class="line">        report.append(&quot;\nåˆ—ä¿¡æ¯:&quot;)</span><br><span class="line">        </span><br><span class="line">        for col in self.data.columns:</span><br><span class="line">            dtype = self.data[col].dtype</span><br><span class="line">            null_count = self.data[col].isnull().sum()</span><br><span class="line">            null_pct = (null_count / len(self.data)) * 100</span><br><span class="line">            unique_count = self.data[col].nunique()</span><br><span class="line">            report.append(f&quot;  &#123;col&#125;: &#123;dtype&#125;, ç©ºå€¼: &#123;null_count&#125;(&#123;null_pct:.1f&#125;%), å”¯ä¸€å€¼: &#123;unique_count&#125;&quot;)</span><br><span class="line">        </span><br><span class="line">        report.append(&quot;\næ“ä½œå†å²:&quot;)</span><br><span class="line">        for i, record in enumerate(self.history, 1):</span><br><span class="line">            report.append(f&quot;  &#123;i&#125;. [&#123;record[&#x27;timestamp&#x27;]&#125;] &#123;record[&#x27;action&#x27;]&#125;&quot;)</span><br><span class="line">        </span><br><span class="line">        return &quot;\n&quot;.join(report)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class DataCleanerCLI:</span><br><span class="line">    &quot;&quot;&quot;å‘½ä»¤è¡Œç•Œé¢&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.cleaner = DataCleaner()</span><br><span class="line">        self.parser = self.setup_argparse()</span><br><span class="line">    </span><br><span class="line">    def setup_argparse(self):</span><br><span class="line">        parser = argparse.ArgumentParser(description=&#x27;æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·&#x27;)</span><br><span class="line">        subparsers = parser.add_subparsers(dest=&#x27;command&#x27;, help=&#x27;å¯ç”¨å‘½ä»¤&#x27;)</span><br><span class="line">        </span><br><span class="line">        # åŠ è½½æ•°æ®</span><br><span class="line">        load_parser = subparsers.add_parser(&#x27;load&#x27;, help=&#x27;åŠ è½½æ•°æ®æ–‡ä»¶&#x27;)</span><br><span class="line">        load_parser.add_argument(&#x27;file&#x27;, help=&#x27;æ•°æ®æ–‡ä»¶è·¯å¾„&#x27;)</span><br><span class="line">        load_parser.add_argument(&#x27;--encoding&#x27;, default=&#x27;utf-8&#x27;, help=&#x27;æ–‡ä»¶ç¼–ç &#x27;)</span><br><span class="line">        </span><br><span class="line">        # æŸ¥çœ‹ä¿¡æ¯</span><br><span class="line">        info_parser = subparsers.add_parser(&#x27;info&#x27;, help=&#x27;æŸ¥çœ‹æ•°æ®ä¿¡æ¯&#x27;)</span><br><span class="line">        </span><br><span class="line">        # å¤„ç†ç¼ºå¤±å€¼</span><br><span class="line">        missing_parser = subparsers.add_parser(&#x27;missing&#x27;, help=&#x27;å¤„ç†ç¼ºå¤±å€¼&#x27;)</span><br><span class="line">        missing_parser.add_argument(&#x27;--strategy&#x27;, choices=[&#x27;mean&#x27;, &#x27;median&#x27;, &#x27;mode&#x27;, &#x27;drop&#x27;, &#x27;forward&#x27;, &#x27;backward&#x27;, &#x27;custom&#x27;], </span><br><span class="line">                                   default=&#x27;mean&#x27;, help=&#x27;å¤„ç†ç­–ç•¥&#x27;)</span><br><span class="line">        missing_parser.add_argument(&#x27;--columns&#x27;, help=&#x27;è¦å¤„ç†çš„åˆ—ï¼ˆé€—å·åˆ†éš”ï¼‰&#x27;)</span><br><span class="line">        missing_parser.add_argument(&#x27;--custom-value&#x27;, help=&#x27;è‡ªå®šä¹‰å¡«å……å€¼&#x27;)</span><br><span class="line">        </span><br><span class="line">        # å»é‡</span><br><span class="line">        dedup_parser = subparsers.add_parser(&#x27;dedup&#x27;, help=&#x27;å»é™¤é‡å¤å€¼&#x27;)</span><br><span class="line">        dedup_parser.add_argument(&#x27;--columns&#x27;, help=&#x27;åŸºäºå“ªäº›åˆ—å»é‡ï¼ˆé€—å·åˆ†éš”ï¼‰&#x27;)</span><br><span class="line">        dedup_parser.add_argument(&#x27;--keep&#x27;, choices=[&#x27;first&#x27;, &#x27;last&#x27;, &#x27;none&#x27;], default=&#x27;first&#x27;, help=&#x27;ä¿ç•™å“ªä¸ªé‡å¤é¡¹&#x27;)</span><br><span class="line">        </span><br><span class="line">        # é‡å‘½ååˆ—</span><br><span class="line">        rename_parser = subparsers.add_parser(&#x27;rename&#x27;, help=&#x27;é‡å‘½ååˆ—&#x27;)</span><br><span class="line">        rename_parser.add_argument(&#x27;--mapping&#x27;, required=True, help=&#x27;é‡å‘½åæ˜ å°„ï¼ˆJSONæ ¼å¼ï¼‰&#x27;)</span><br><span class="line">        </span><br><span class="line">        # ä¿å­˜æ•°æ®</span><br><span class="line">        save_parser = subparsers.add_parser(&#x27;save&#x27;, help=&#x27;ä¿å­˜æ•°æ®&#x27;)</span><br><span class="line">        save_parser.add_argument(&#x27;file&#x27;, help=&#x27;ä¿å­˜æ–‡ä»¶è·¯å¾„&#x27;)</span><br><span class="line">        </span><br><span class="line">        # ç”ŸæˆæŠ¥å‘Š</span><br><span class="line">        report_parser = subparsers.add_parser(&#x27;report&#x27;, help=&#x27;ç”Ÿæˆæ•°æ®æ¸…æ´—æŠ¥å‘Š&#x27;)</span><br><span class="line">        </span><br><span class="line">        return parser</span><br><span class="line">    </span><br><span class="line">    def run(self):</span><br><span class="line">        args = self.parser.parse_args()</span><br><span class="line">        </span><br><span class="line">        if not args.command:</span><br><span class="line">            self.parser.print_help()</span><br><span class="line">            return</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            if args.command == &#x27;load&#x27;:</span><br><span class="line">                success = self.cleaner.load_data(args.file, encoding=args.encoding)</span><br><span class="line">                if success:</span><br><span class="line">                    print(f&quot;æˆåŠŸåŠ è½½æ•°æ®: &#123;args.file&#125;&quot;)</span><br><span class="line">                    info = self.cleaner.get_info()</span><br><span class="line">                    print(f&quot;æ•°æ®å½¢çŠ¶: &#123;info[&#x27;shape&#x27;]&#125;&quot;)</span><br><span class="line">                    </span><br><span class="line">            elif args.command == &#x27;info&#x27;:</span><br><span class="line">                info = self.cleaner.get_info()</span><br><span class="line">                if isinstance(info, str):</span><br><span class="line">                    print(info)</span><br><span class="line">                else:</span><br><span class="line">                    print(f&quot;æ•°æ®å½¢çŠ¶: &#123;info[&#x27;shape&#x27;]&#125;&quot;)</span><br><span class="line">                    print(f&quot;åˆ—å: &#123;&#x27;, &#x27;.join(info[&#x27;columns&#x27;])&#125;&quot;)</span><br><span class="line">                    print(&quot;\næ•°æ®ç±»å‹:&quot;)</span><br><span class="line">                    for col, dtype in info[&#x27;dtypes&#x27;].items():</span><br><span class="line">                        print(f&quot;  &#123;col&#125;: &#123;dtype&#125;&quot;)</span><br><span class="line">                    </span><br><span class="line">            elif args.command == &#x27;missing&#x27;:</span><br><span class="line">                columns = args.columns.split(&#x27;,&#x27;) if args.columns else None</span><br><span class="line">                self.cleaner.handle_missing_values(</span><br><span class="line">                    strategy=args.strategy,</span><br><span class="line">                    columns=columns,</span><br><span class="line">                    custom_value=args.custom_value</span><br><span class="line">                )</span><br><span class="line">                print(&quot;ç¼ºå¤±å€¼å¤„ç†å®Œæˆ&quot;)</span><br><span class="line">                </span><br><span class="line">            elif args.command == &#x27;dedup&#x27;:</span><br><span class="line">                columns = args.columns.split(&#x27;,&#x27;) if args.columns else None</span><br><span class="line">                self.cleaner.remove_duplicates(subset=columns, keep=args.keep)</span><br><span class="line">                print(&quot;å»é‡å®Œæˆ&quot;)</span><br><span class="line">                </span><br><span class="line">            elif args.command == &#x27;rename&#x27;:</span><br><span class="line">                try:</span><br><span class="line">                    mapping = json.loads(args.mapping)</span><br><span class="line">                    self.cleaner.rename_columns(mapping)</span><br><span class="line">                    print(&quot;é‡å‘½åå®Œæˆ&quot;)</span><br><span class="line">                except json.JSONDecodeError:</span><br><span class="line">                    print(&quot;é”™è¯¯: æ— æ•ˆçš„JSONæ ¼å¼&quot;)</span><br><span class="line">                    </span><br><span class="line">            elif args.command == &#x27;save&#x27;:</span><br><span class="line">                success = self.cleaner.save_data(args.file)</span><br><span class="line">                if success:</span><br><span class="line">                    print(f&quot;æ•°æ®å·²ä¿å­˜åˆ°: &#123;args.file&#125;&quot;)</span><br><span class="line">                    </span><br><span class="line">            elif args.command == &#x27;report&#x27;:</span><br><span class="line">                report = self.cleaner.generate_report()</span><br><span class="line">                print(report)</span><br><span class="line">                </span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(f&quot;é”™è¯¯: &#123;e&#125;&quot;)</span><br><span class="line">            sys.exit(1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if GUI_AVAILABLE:</span><br><span class="line">    class DataCleanerGUI:</span><br><span class="line">        &quot;&quot;&quot;å›¾å½¢ç”¨æˆ·ç•Œé¢&quot;&quot;&quot;</span><br><span class="line">        </span><br><span class="line">        def __init__(self, root):</span><br><span class="line">            self.root = root</span><br><span class="line">            self.root.title(&quot;æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·&quot;)</span><br><span class="line">            self.root.geometry(&quot;1200x800&quot;)</span><br><span class="line">            </span><br><span class="line">            # è®¾ç½®æ ·å¼</span><br><span class="line">            self.setup_styles()</span><br><span class="line">            </span><br><span class="line">            # åˆå§‹åŒ–æ•°æ®æ¸…æ´—å™¨</span><br><span class="line">            self.cleaner = DataCleaner()</span><br><span class="line">            </span><br><span class="line">            # åˆ›å»ºç•Œé¢</span><br><span class="line">            self.create_widgets()</span><br><span class="line">            </span><br><span class="line">            # å½“å‰æ–‡ä»¶è·¯å¾„</span><br><span class="line">            self.current_file = None</span><br><span class="line">            </span><br><span class="line">        def setup_styles(self):</span><br><span class="line">            &quot;&quot;&quot;è®¾ç½®ç•Œé¢æ ·å¼&quot;&quot;&quot;</span><br><span class="line">            self.style = ttk.Style()</span><br><span class="line">            self.style.theme_use(&#x27;clam&#x27;)</span><br><span class="line">            </span><br><span class="line">            # è‡ªå®šä¹‰é¢œè‰²</span><br><span class="line">            self.bg_color = &#x27;#f0f0f0&#x27;</span><br><span class="line">            self.accent_color = &#x27;#4a6fa5&#x27;</span><br><span class="line">            self.root.configure(bg=self.bg_color)</span><br><span class="line">            </span><br><span class="line">        def create_widgets(self):</span><br><span class="line">            &quot;&quot;&quot;åˆ›å»ºç•Œé¢ç»„ä»¶&quot;&quot;&quot;</span><br><span class="line">            # åˆ›å»ºä¸»æ¡†æ¶</span><br><span class="line">            main_frame = ttk.Frame(self.root, padding=&quot;10&quot;)</span><br><span class="line">            main_frame.grid(row=0, column=0, sticky=(tk.W, tk.E, tk.N, tk.S))</span><br><span class="line">            </span><br><span class="line">            # é…ç½®ç½‘æ ¼æƒé‡</span><br><span class="line">            self.root.columnconfigure(0, weight=1)</span><br><span class="line">            self.root.rowconfigure(0, weight=1)</span><br><span class="line">            main_frame.columnconfigure(1, weight=1)</span><br><span class="line">            main_frame.rowconfigure(1, weight=1)</span><br><span class="line">            </span><br><span class="line">            # æ ‡é¢˜</span><br><span class="line">            title_label = tk.Label(</span><br><span class="line">                main_frame,</span><br><span class="line">                text=&quot;ğŸ“Š æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·&quot;,</span><br><span class="line">                font=tkfont.Font(family=&quot;Arial&quot;, size=16, weight=&quot;bold&quot;),</span><br><span class="line">                bg=self.accent_color,</span><br><span class="line">                fg=&quot;white&quot;,</span><br><span class="line">                padx=10,</span><br><span class="line">                pady=10</span><br><span class="line">            )</span><br><span class="line">            title_label.grid(row=0, column=0, columnspan=3, sticky=(tk.W, tk.E), pady=(0, 10))</span><br><span class="line">            </span><br><span class="line">            # å·¦ä¾§æ§åˆ¶é¢æ¿</span><br><span class="line">            control_frame = ttk.LabelFrame(main_frame, text=&quot;æ“ä½œé¢æ¿&quot;, padding=&quot;10&quot;)</span><br><span class="line">            control_frame.grid(row=1, column=0, sticky=(tk.N, tk.S), padx=(0, 10))</span><br><span class="line">            </span><br><span class="line">            # æ–‡ä»¶æ“ä½œ</span><br><span class="line">            file_frame = ttk.Frame(control_frame)</span><br><span class="line">            file_frame.pack(fill=tk.X, pady=(0, 10))</span><br><span class="line">            </span><br><span class="line">            ttk.Button(file_frame, text=&quot;ğŸ“‚ åŠ è½½æ•°æ®&quot;, command=self.load_data).pack(fill=tk.X)</span><br><span class="line">            ttk.Button(file_frame, text=&quot;ğŸ’¾ ä¿å­˜æ•°æ®&quot;, command=self.save_data).pack(fill=tk.X, pady=5)</span><br><span class="line">            </span><br><span class="line">            # æ•°æ®æ¸…æ´—æ“ä½œ</span><br><span class="line">            ttk.Separator(control_frame, orient=&#x27;horizontal&#x27;).pack(fill=tk.X, pady=10)</span><br><span class="line">            </span><br><span class="line">            operations = [</span><br><span class="line">                (&quot;ğŸ” æŸ¥çœ‹ä¿¡æ¯&quot;, self.show_info),</span><br><span class="line">                (&quot;ğŸ§¹ å¤„ç†ç¼ºå¤±å€¼&quot;, self.open_missing_dialog),</span><br><span class="line">                (&quot;ğŸ”„ å»é™¤é‡å¤&quot;, self.open_dedup_dialog),</span><br><span class="line">                (&quot;ğŸ“ é‡å‘½ååˆ—&quot;, self.open_rename_dialog),</span><br><span class="line">                (&quot;âœ‚ï¸ åˆ é™¤åˆ—&quot;, self.open_drop_dialog),</span><br><span class="line">                (&quot;ğŸ“ˆ æ ‡å‡†åŒ–&quot;, self.open_normalize_dialog),</span><br><span class="line">                (&quot;ğŸ¯ å¤„ç†å¼‚å¸¸å€¼&quot;, self.open_outlier_dialog),</span><br><span class="line">                (&quot;ğŸ“Š ç¼–ç åˆ†ç±»&quot;, self.open_encode_dialog),</span><br><span class="line">                (&quot;âª æ’¤é”€æ“ä½œ&quot;, self.undo),</span><br><span class="line">                (&quot;ğŸ“‹ ç”ŸæˆæŠ¥å‘Š&quot;, self.generate_report)</span><br><span class="line">            ]</span><br><span class="line">            </span><br><span class="line">            for text, command in operations:</span><br><span class="line">                ttk.Button(control_frame, text=text, command=command).pack(fill=tk.X, pady=2)</span><br><span class="line">            </span><br><span class="line">            # å³ä¾§æ•°æ®æ˜¾ç¤ºåŒºåŸŸ</span><br><span class="line">            display_frame = ttk.Frame(main_frame)</span><br><span class="line">            display_frame.grid(row=1, column=1, sticky=(tk.W, tk.E, tk.N, tk.S))</span><br><span class="line">            display_frame.columnconfigure(0, weight=1)</span><br><span class="line">            display_frame.rowconfigure(1, weight=1)</span><br><span class="line">            </span><br><span class="line">            # æ•°æ®è¡¨æ ¼æ ‡ç­¾</span><br><span class="line">            self.data_label = ttk.Label(display_frame, text=&quot;æœªåŠ è½½æ•°æ®&quot;, font=(&#x27;Arial&#x27;, 10))</span><br><span class="line">            self.data_label.grid(row=0, column=0, sticky=tk.W, pady=(0, 5))</span><br><span class="line">            </span><br><span class="line">            # æ•°æ®è¡¨æ ¼</span><br><span class="line">            self.tree = ttk.Treeview(display_frame, show=&quot;headings&quot;)</span><br><span class="line">            scrollbar_y = ttk.Scrollbar(display_frame, orient=&quot;vertical&quot;, command=self.tree.yview)</span><br><span class="line">            scrollbar_x = ttk.Scrollbar(display_frame, orient=&quot;horizontal&quot;, command=self.tree.xview)</span><br><span class="line">            self.tree.configure(yscrollcommand=scrollbar_y.set, xscrollcommand=scrollbar_x.set)</span><br><span class="line">            </span><br><span class="line">            self.tree.grid(row=1, column=0, sticky=(tk.W, tk.E, tk.N, tk.S))</span><br><span class="line">            scrollbar_y.grid(row=1, column=1, sticky=(tk.N, tk.S))</span><br><span class="line">            scrollbar_x.grid(row=2, column=0, sticky=(tk.W, tk.E))</span><br><span class="line">            </span><br><span class="line">            # çŠ¶æ€æ </span><br><span class="line">            self.status_bar = ttk.Label(main_frame, text=&quot;å°±ç»ª&quot;, relief=tk.SUNKEN)</span><br><span class="line">            self.status_bar.grid(row=2, column=0, columnspan=2, sticky=(tk.W, tk.E), pady=(10, 0))</span><br><span class="line">            </span><br><span class="line">        def load_data(self):</span><br><span class="line">            &quot;&quot;&quot;åŠ è½½æ•°æ®æ–‡ä»¶&quot;&quot;&quot;</span><br><span class="line">            file_types = [</span><br><span class="line">                (&#x27;CSVæ–‡ä»¶&#x27;, &#x27;*.csv&#x27;),</span><br><span class="line">                (&#x27;Excelæ–‡ä»¶&#x27;, &#x27;*.xlsx;*.xls&#x27;),</span><br><span class="line">                (&#x27;JSONæ–‡ä»¶&#x27;, &#x27;*.json&#x27;),</span><br><span class="line">                (&#x27;æ‰€æœ‰æ–‡ä»¶&#x27;, &#x27;*.*&#x27;)</span><br><span class="line">            ]</span><br><span class="line">            </span><br><span class="line">            file_path = filedialog.askopenfilename(filetypes=file_types)</span><br><span class="line">            if file_path:</span><br><span class="line">                try:</span><br><span class="line">                    if self.cleaner.load_data(file_path):</span><br><span class="line">                        self.current_file = file_path</span><br><span class="line">                        self.display_data()</span><br><span class="line">                        self.update_status(f&quot;å·²åŠ è½½: &#123;os.path.basename(file_path)&#125;&quot;)</span><br><span class="line">                except Exception as e:</span><br><span class="line">                    messagebox.showerror(&quot;é”™è¯¯&quot;, f&quot;åŠ è½½æ–‡ä»¶å¤±è´¥: &#123;str(e)&#125;&quot;)</span><br><span class="line">        </span><br><span class="line">        def save_data(self):</span><br><span class="line">            &quot;&quot;&quot;ä¿å­˜æ•°æ®&quot;&quot;&quot;</span><br><span class="line">            if self.cleaner.data is None:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;æ²¡æœ‰æ•°æ®å¯ä¿å­˜&quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            file_types = [</span><br><span class="line">                (&#x27;CSVæ–‡ä»¶&#x27;, &#x27;*.csv&#x27;),</span><br><span class="line">                (&#x27;Excelæ–‡ä»¶&#x27;, &#x27;*.xlsx&#x27;),</span><br><span class="line">                (&#x27;JSONæ–‡ä»¶&#x27;, &#x27;*.json&#x27;),</span><br><span class="line">                (&#x27;æ‰€æœ‰æ–‡ä»¶&#x27;, &#x27;*.*&#x27;)</span><br><span class="line">            ]</span><br><span class="line">            </span><br><span class="line">            file_path = filedialog.asksaveasfilename(</span><br><span class="line">                defaultextension=&#x27;.csv&#x27;,</span><br><span class="line">                filetypes=file_types</span><br><span class="line">            )</span><br><span class="line">            </span><br><span class="line">            if file_path:</span><br><span class="line">                if self.cleaner.save_data(file_path):</span><br><span class="line">                    messagebox.showinfo(&quot;æˆåŠŸ&quot;, f&quot;æ•°æ®å·²ä¿å­˜åˆ°:\n&#123;file_path&#125;&quot;)</span><br><span class="line">        </span><br><span class="line">        def display_data(self, max_rows=100):</span><br><span class="line">            &quot;&quot;&quot;åœ¨è¡¨æ ¼ä¸­æ˜¾ç¤ºæ•°æ®&quot;&quot;&quot;</span><br><span class="line">            if self.cleaner.data is None:</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            # æ¸…ç©ºç°æœ‰æ•°æ®</span><br><span class="line">            for item in self.tree.get_children():</span><br><span class="line">                self.tree.delete(item)</span><br><span class="line">            </span><br><span class="line">            # è®¾ç½®åˆ—</span><br><span class="line">            columns = list(self.cleaner.data.columns)</span><br><span class="line">            self.tree[&quot;columns&quot;] = columns</span><br><span class="line">            </span><br><span class="line">            # é…ç½®åˆ—æ ‡é¢˜</span><br><span class="line">            for col in columns:</span><br><span class="line">                self.tree.heading(col, text=col)</span><br><span class="line">                self.tree.column(col, width=100, minwidth=50)</span><br><span class="line">            </span><br><span class="line">            # æ·»åŠ æ•°æ®è¡Œ</span><br><span class="line">            data_sample = self.cleaner.data.head(max_rows)</span><br><span class="line">            for _, row in data_sample.iterrows():</span><br><span class="line">                values = [str(row[col])[:50] for col in columns]  # é™åˆ¶æ˜¾ç¤ºé•¿åº¦</span><br><span class="line">                self.tree.insert(&quot;&quot;, &quot;end&quot;, values=values)</span><br><span class="line">            </span><br><span class="line">            # æ›´æ–°æ ‡ç­¾</span><br><span class="line">            shape = self.cleaner.data.shape</span><br><span class="line">            self.data_label.config(</span><br><span class="line">                text=f&quot;æ•°æ®: &#123;shape[0]&#125; è¡Œ Ã— &#123;shape[1]&#125; åˆ— | æ˜¾ç¤ºå‰ &#123;min(max_rows, shape[0])&#125; è¡Œ&quot;</span><br><span class="line">            )</span><br><span class="line">        </span><br><span class="line">        def show_info(self):</span><br><span class="line">            &quot;&quot;&quot;æ˜¾ç¤ºæ•°æ®ä¿¡æ¯&quot;&quot;&quot;</span><br><span class="line">            if self.cleaner.data is None:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·å…ˆåŠ è½½æ•°æ®&quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            info = self.cleaner.get_info()</span><br><span class="line">            </span><br><span class="line">            info_window = tk.Toplevel(self.root)</span><br><span class="line">            info_window.title(&quot;æ•°æ®ä¿¡æ¯&quot;)</span><br><span class="line">            info_window.geometry(&quot;600x400&quot;)</span><br><span class="line">            </span><br><span class="line">            text_widget = scrolledtext.ScrolledText(info_window, wrap=tk.WORD)</span><br><span class="line">            text_widget.pack(fill=tk.BOTH, expand=True, padx=10, pady=10)</span><br><span class="line">            </span><br><span class="line">            if isinstance(info, str):</span><br><span class="line">                text_widget.insert(tk.END, info)</span><br><span class="line">            else:</span><br><span class="line">                info_text = f&quot;æ•°æ®å½¢çŠ¶: &#123;info[&#x27;shape&#x27;]&#125;\n\n&quot;</span><br><span class="line">                info_text += &quot;åˆ—ä¿¡æ¯:\n&quot;</span><br><span class="line">                info_text += &quot;-&quot; * 50 + &quot;\n&quot;</span><br><span class="line">                </span><br><span class="line">                for col in info[&#x27;columns&#x27;]:</span><br><span class="line">                    dtype = info[&#x27;dtypes&#x27;][col]</span><br><span class="line">                    null_count = info[&#x27;null_counts&#x27;][col]</span><br><span class="line">                    null_pct = (null_count / info[&#x27;shape&#x27;][0]) * 100 if info[&#x27;shape&#x27;][0] &gt; 0 else 0</span><br><span class="line">                    info_text += f&quot;&#123;col&#125;: &#123;dtype&#125; (ç©ºå€¼: &#123;null_count&#125;, &#123;null_pct:.1f&#125;%)\n&quot;</span><br><span class="line">                </span><br><span class="line">                text_widget.insert(tk.END, info_text)</span><br><span class="line">            </span><br><span class="line">            text_widget.config(state=tk.DISABLED)</span><br><span class="line">        </span><br><span class="line">        def open_missing_dialog(self):</span><br><span class="line">            &quot;&quot;&quot;æ‰“å¼€ç¼ºå¤±å€¼å¤„ç†å¯¹è¯æ¡†&quot;&quot;&quot;</span><br><span class="line">            if self.cleaner.data is None:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·å…ˆåŠ è½½æ•°æ®&quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            dialog = tk.Toplevel(self.root)</span><br><span class="line">            dialog.title(&quot;å¤„ç†ç¼ºå¤±å€¼&quot;)</span><br><span class="line">            dialog.geometry(&quot;400x300&quot;)</span><br><span class="line">            dialog.transient(self.root)</span><br><span class="line">            dialog.grab_set()</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;é€‰æ‹©å¤„ç†ç­–ç•¥:&quot;).pack(pady=10)</span><br><span class="line">            </span><br><span class="line">            strategy_var = tk.StringVar(value=&quot;mean&quot;)</span><br><span class="line">            strategies = [</span><br><span class="line">                (&quot;å‡å€¼å¡«å……&quot;, &quot;mean&quot;),</span><br><span class="line">                (&quot;ä¸­ä½æ•°å¡«å……&quot;, &quot;median&quot;),</span><br><span class="line">                (&quot;ä¼—æ•°å¡«å……&quot;, &quot;mode&quot;),</span><br><span class="line">                (&quot;å‰å‘å¡«å……&quot;, &quot;forward&quot;),</span><br><span class="line">                (&quot;åå‘å¡«å……&quot;, &quot;backward&quot;),</span><br><span class="line">                (&quot;åˆ é™¤è¡Œ&quot;, &quot;drop&quot;),</span><br><span class="line">                (&quot;è‡ªå®šä¹‰å€¼&quot;, &quot;custom&quot;)</span><br><span class="line">            ]</span><br><span class="line">            </span><br><span class="line">            for text, value in strategies:</span><br><span class="line">                ttk.Radiobutton(dialog, text=text, variable=strategy_var, value=value).pack(anchor=tk.W, padx=20)</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;è‡ªå®šä¹‰å€¼ï¼ˆå¦‚éœ€è¦ï¼‰:&quot;).pack(pady=10)</span><br><span class="line">            custom_entry = ttk.Entry(dialog, width=30)</span><br><span class="line">            custom_entry.pack()</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;æŒ‡å®šåˆ—ï¼ˆé€—å·åˆ†éš”ï¼Œç•™ç©ºä¸ºæ‰€æœ‰åˆ—ï¼‰:&quot;).pack(pady=10)</span><br><span class="line">            columns_entry = ttk.Entry(dialog, width=30)</span><br><span class="line">            columns_entry.pack()</span><br><span class="line">            </span><br><span class="line">            def apply():</span><br><span class="line">                columns = None</span><br><span class="line">                if columns_entry.get().strip():</span><br><span class="line">                    columns = [col.strip() for col in columns_entry.get().split(&#x27;,&#x27;)]</span><br><span class="line">                </span><br><span class="line">                custom_value = custom_entry.get().strip() or None</span><br><span class="line">                if strategy_var.get() == &#x27;custom&#x27; and not custom_value:</span><br><span class="line">                    messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·ä¸ºè‡ªå®šä¹‰ç­–ç•¥è¾“å…¥å€¼&quot;)</span><br><span class="line">                    return</span><br><span class="line">                </span><br><span class="line">                self.cleaner.handle_missing_values(</span><br><span class="line">                    strategy=strategy_var.get(),</span><br><span class="line">                    columns=columns,</span><br><span class="line">                    custom_value=custom_value</span><br><span class="line">                )</span><br><span class="line">                </span><br><span class="line">                self.display_data()</span><br><span class="line">                dialog.destroy()</span><br><span class="line">                self.update_status(&quot;ç¼ºå¤±å€¼å¤„ç†å®Œæˆ&quot;)</span><br><span class="line">            </span><br><span class="line">            ttk.Button(dialog, text=&quot;åº”ç”¨&quot;, command=apply).pack(pady=20)</span><br><span class="line">        </span><br><span class="line">        def open_dedup_dialog(self):</span><br><span class="line">            &quot;&quot;&quot;æ‰“å¼€å»é‡å¯¹è¯æ¡†&quot;&quot;&quot;</span><br><span class="line">            if self.cleaner.data is None:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·å…ˆåŠ è½½æ•°æ®&quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            dialog = tk.Toplevel(self.root)</span><br><span class="line">            dialog.title(&quot;å»é™¤é‡å¤å€¼&quot;)</span><br><span class="line">            dialog.geometry(&quot;400x200&quot;)</span><br><span class="line">            dialog.transient(self.root)</span><br><span class="line">            dialog.grab_set()</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;åŸºäºå“ªäº›åˆ—å»é‡ï¼ˆé€—å·åˆ†éš”ï¼Œç•™ç©ºä¸ºæ‰€æœ‰åˆ—ï¼‰:&quot;).pack(pady=10)</span><br><span class="line">            columns_entry = ttk.Entry(dialog, width=40)</span><br><span class="line">            columns_entry.pack()</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;ä¿ç•™ç­–ç•¥:&quot;).pack(pady=10)</span><br><span class="line">            keep_var = tk.StringVar(value=&quot;first&quot;)</span><br><span class="line">            ttk.Combobox(dialog, textvariable=keep_var, </span><br><span class="line">                        values=[&quot;first&quot;, &quot;last&quot;, &quot;none&quot;], </span><br><span class="line">                        state=&quot;readonly&quot;, width=10).pack()</span><br><span class="line">            </span><br><span class="line">            def apply():</span><br><span class="line">                columns = None</span><br><span class="line">                if columns_entry.get().strip():</span><br><span class="line">                    columns = [col.strip() for col in columns_entry.get().split(&#x27;,&#x27;)]</span><br><span class="line">                </span><br><span class="line">                before = len(self.cleaner.data)</span><br><span class="line">                self.cleaner.remove_duplicates(subset=columns, keep=keep_var.get())</span><br><span class="line">                after = len(self.cleaner.data)</span><br><span class="line">                </span><br><span class="line">                self.display_data()</span><br><span class="line">                dialog.destroy()</span><br><span class="line">                self.update_status(f&quot;å»é‡å®Œæˆ: ä» &#123;before&#125; è¡Œå‡å°‘åˆ° &#123;after&#125; è¡Œ&quot;)</span><br><span class="line">            </span><br><span class="line">            ttk.Button(dialog, text=&quot;åº”ç”¨&quot;, command=apply).pack(pady=20)</span><br><span class="line">        </span><br><span class="line">        def open_rename_dialog(self):</span><br><span class="line">            &quot;&quot;&quot;æ‰“å¼€é‡å‘½åå¯¹è¯æ¡†&quot;&quot;&quot;</span><br><span class="line">            if self.cleaner.data is None:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·å…ˆåŠ è½½æ•°æ®&quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            dialog = tk.Toplevel(self.root)</span><br><span class="line">            dialog.title(&quot;é‡å‘½ååˆ—&quot;)</span><br><span class="line">            dialog.geometry(&quot;500x400&quot;)</span><br><span class="line">            dialog.transient(self.root)</span><br><span class="line">            dialog.grab_set()</span><br><span class="line">            </span><br><span class="line">            # åˆ›å»ºè¡¨æ ¼ç”¨äºé‡å‘½å</span><br><span class="line">            frame = ttk.Frame(dialog)</span><br><span class="line">            frame.pack(fill=tk.BOTH, expand=True, padx=10, pady=10)</span><br><span class="line">            </span><br><span class="line">            columns = list(self.cleaner.data.columns)</span><br><span class="line">            rename_dict = &#123;&#125;</span><br><span class="line">            </span><br><span class="line">            for i, col in enumerate(columns):</span><br><span class="line">                ttk.Label(frame, text=f&quot;åŸåˆ—å: &#123;col&#125;&quot;).grid(row=i, column=0, padx=5, pady=2, sticky=tk.W)</span><br><span class="line">                entry = ttk.Entry(frame, width=30)</span><br><span class="line">                entry.insert(0, col)</span><br><span class="line">                entry.grid(row=i, column=1, padx=5, pady=2)</span><br><span class="line">                rename_dict[col] = entry</span><br><span class="line">            </span><br><span class="line">            def apply():</span><br><span class="line">                mapping = &#123;&#125;</span><br><span class="line">                for old_col, entry in rename_dict.items():</span><br><span class="line">                    new_col = entry.get().strip()</span><br><span class="line">                    if new_col and new_col != old_col:</span><br><span class="line">                        mapping[old_col] = new_col</span><br><span class="line">                </span><br><span class="line">                if mapping:</span><br><span class="line">                    self.cleaner.rename_columns(mapping)</span><br><span class="line">                    self.display_data()</span><br><span class="line">                    dialog.destroy()</span><br><span class="line">                    self.update_status(&quot;åˆ—é‡å‘½åå®Œæˆ&quot;)</span><br><span class="line">                else:</span><br><span class="line">                    messagebox.showinfo(&quot;ä¿¡æ¯&quot;, &quot;æ²¡æœ‰éœ€è¦é‡å‘½åçš„åˆ—&quot;)</span><br><span class="line">            </span><br><span class="line">            ttk.Button(dialog, text=&quot;åº”ç”¨é‡å‘½å&quot;, command=apply).pack(pady=10)</span><br><span class="line">        </span><br><span class="line">        def open_drop_dialog(self):</span><br><span class="line">            &quot;&quot;&quot;æ‰“å¼€åˆ é™¤åˆ—å¯¹è¯æ¡†&quot;&quot;&quot;</span><br><span class="line">            if self.cleaner.data is None:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·å…ˆåŠ è½½æ•°æ®&quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            dialog = tk.Toplevel(self.root)</span><br><span class="line">            dialog.title(&quot;åˆ é™¤åˆ—&quot;)</span><br><span class="line">            dialog.geometry(&quot;300x400&quot;)</span><br><span class="line">            dialog.transient(self.root)</span><br><span class="line">            dialog.grab_set()</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;é€‰æ‹©è¦åˆ é™¤çš„åˆ—:&quot;).pack(pady=10)</span><br><span class="line">            </span><br><span class="line">            columns = list(self.cleaner.data.columns)</span><br><span class="line">            selected_vars = &#123;&#125;</span><br><span class="line">            </span><br><span class="line">            frame = ttk.Frame(dialog)</span><br><span class="line">            frame.pack(fill=tk.BOTH, expand=True, padx=10)</span><br><span class="line">            </span><br><span class="line">            for col in columns:</span><br><span class="line">                var = tk.BooleanVar()</span><br><span class="line">                cb = ttk.Checkbutton(frame, text=col, variable=var)</span><br><span class="line">                cb.pack(anchor=tk.W, pady=2)</span><br><span class="line">                selected_vars[col] = var</span><br><span class="line">            </span><br><span class="line">            def apply():</span><br><span class="line">                columns_to_drop = [col for col, var in selected_vars.items() if var.get()]</span><br><span class="line">                if columns_to_drop:</span><br><span class="line">                    self.cleaner.drop_columns(columns_to_drop)</span><br><span class="line">                    self.display_data()</span><br><span class="line">                    dialog.destroy()</span><br><span class="line">                    self.update_status(f&quot;åˆ é™¤åˆ—: &#123;&#x27;, &#x27;.join(columns_to_drop)&#125;&quot;)</span><br><span class="line">                else:</span><br><span class="line">                    messagebox.showinfo(&quot;ä¿¡æ¯&quot;, &quot;æ²¡æœ‰é€‰æ‹©ä»»ä½•åˆ—&quot;)</span><br><span class="line">            </span><br><span class="line">            ttk.Button(dialog, text=&quot;åˆ é™¤é€‰ä¸­åˆ—&quot;, command=apply).pack(pady=10)</span><br><span class="line">        </span><br><span class="line">        def open_normalize_dialog(self):</span><br><span class="line">            &quot;&quot;&quot;æ‰“å¼€æ ‡å‡†åŒ–å¯¹è¯æ¡†&quot;&quot;&quot;</span><br><span class="line">            if self.cleaner.data is None:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·å…ˆåŠ è½½æ•°æ®&quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            # ç­›é€‰æ•°å€¼åˆ—</span><br><span class="line">            numeric_cols = self.cleaner.data.select_dtypes(include=[np.number]).columns.tolist()</span><br><span class="line">            if not numeric_cols:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;æ²¡æœ‰æ•°å€¼åˆ—å¯ä»¥æ ‡å‡†åŒ–&quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            dialog = tk.Toplevel(self.root)</span><br><span class="line">            dialog.title(&quot;æ ‡å‡†åŒ–æ•°å€¼åˆ—&quot;)</span><br><span class="line">            dialog.geometry(&quot;400x300&quot;)</span><br><span class="line">            dialog.transient(self.root)</span><br><span class="line">            dialog.grab_set()</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;é€‰æ‹©åˆ—:&quot;).pack(pady=10)</span><br><span class="line">            column_var = tk.StringVar()</span><br><span class="line">            ttk.Combobox(dialog, textvariable=column_var, </span><br><span class="line">                        values=numeric_cols, state=&quot;readonly&quot;, width=30).pack()</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;é€‰æ‹©æ–¹æ³•:&quot;).pack(pady=10)</span><br><span class="line">            method_var = tk.StringVar(value=&quot;minmax&quot;)</span><br><span class="line">            ttk.Combobox(dialog, textvariable=method_var, </span><br><span class="line">                        values=[&quot;minmax&quot;, &quot;zscore&quot;], state=&quot;readonly&quot;, width=20).pack()</span><br><span class="line">            </span><br><span class="line">            def apply():</span><br><span class="line">                if column_var.get():</span><br><span class="line">                    self.cleaner.normalize_column(column_var.get(), method_var.get())</span><br><span class="line">                    self.display_data()</span><br><span class="line">                    dialog.destroy()</span><br><span class="line">                    self.update_status(f&quot;æ ‡å‡†åŒ–åˆ—: &#123;column_var.get()&#125;&quot;)</span><br><span class="line">                else:</span><br><span class="line">                    messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·é€‰æ‹©ä¸€åˆ—&quot;)</span><br><span class="line">            </span><br><span class="line">            ttk.Button(dialog, text=&quot;åº”ç”¨&quot;, command=apply).pack(pady=20)</span><br><span class="line">        </span><br><span class="line">        def open_outlier_dialog(self):</span><br><span class="line">            &quot;&quot;&quot;æ‰“å¼€å¼‚å¸¸å€¼å¤„ç†å¯¹è¯æ¡†&quot;&quot;&quot;</span><br><span class="line">            if self.cleaner.data is None:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·å…ˆåŠ è½½æ•°æ®&quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            numeric_cols = self.cleaner.data.select_dtypes(include=[np.number]).columns.tolist()</span><br><span class="line">            if not numeric_cols:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;æ²¡æœ‰æ•°å€¼åˆ—å¯ä»¥å¤„ç†å¼‚å¸¸å€¼&quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            dialog = tk.Toplevel(self.root)</span><br><span class="line">            dialog.title(&quot;å¤„ç†å¼‚å¸¸å€¼&quot;)</span><br><span class="line">            dialog.geometry(&quot;400x300&quot;)</span><br><span class="line">            dialog.transient(self.root)</span><br><span class="line">            dialog.grab_set()</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;é€‰æ‹©åˆ—:&quot;).pack(pady=10)</span><br><span class="line">            column_var = tk.StringVar()</span><br><span class="line">            ttk.Combobox(dialog, textvariable=column_var, </span><br><span class="line">                        values=numeric_cols, state=&quot;readonly&quot;, width=30).pack()</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;é€‰æ‹©æ–¹æ³•:&quot;).pack(pady=10)</span><br><span class="line">            method_var = tk.StringVar(value=&quot;iqr&quot;)</span><br><span class="line">            ttk.Combobox(dialog, textvariable=method_var, </span><br><span class="line">                        values=[&quot;iqr&quot;, &quot;zscore&quot;], state=&quot;readonly&quot;, width=20).pack()</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;é˜ˆå€¼:&quot;).pack(pady=10)</span><br><span class="line">            threshold_var = tk.DoubleVar(value=1.5)</span><br><span class="line">            ttk.Spinbox(dialog, from_=1.0, to=5.0, increment=0.5, </span><br><span class="line">                       textvariable=threshold_var, width=10).pack()</span><br><span class="line">            </span><br><span class="line">            def apply():</span><br><span class="line">                if column_var.get():</span><br><span class="line">                    self.cleaner.handle_outliers(column_var.get(), method_var.get(), threshold_var.get())</span><br><span class="line">                    self.display_data()</span><br><span class="line">                    dialog.destroy()</span><br><span class="line">                    self.update_status(f&quot;å¤„ç†å¼‚å¸¸å€¼: &#123;column_var.get()&#125;&quot;)</span><br><span class="line">                else:</span><br><span class="line">                    messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·é€‰æ‹©ä¸€åˆ—&quot;)</span><br><span class="line">            </span><br><span class="line">            ttk.Button(dialog, text=&quot;åº”ç”¨&quot;, command=apply).pack(pady=20)</span><br><span class="line">        </span><br><span class="line">        def open_encode_dialog(self):</span><br><span class="line">            &quot;&quot;&quot;æ‰“å¼€ç¼–ç å¯¹è¯æ¡†&quot;&quot;&quot;</span><br><span class="line">            if self.cleaner.data is None:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·å…ˆåŠ è½½æ•°æ®&quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            categorical_cols = self.cleaner.data.select_dtypes(include=[&#x27;object&#x27;, &#x27;category&#x27;]).columns.tolist()</span><br><span class="line">            if not categorical_cols:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;æ²¡æœ‰åˆ†ç±»åˆ—å¯ä»¥ç¼–ç &quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            dialog = tk.Toplevel(self.root)</span><br><span class="line">            dialog.title(&quot;ç¼–ç åˆ†ç±»å˜é‡&quot;)</span><br><span class="line">            dialog.geometry(&quot;400x250&quot;)</span><br><span class="line">            dialog.transient(self.root)</span><br><span class="line">            dialog.grab_set()</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;é€‰æ‹©åˆ—:&quot;).pack(pady=10)</span><br><span class="line">            column_var = tk.StringVar()</span><br><span class="line">            ttk.Combobox(dialog, textvariable=column_var, </span><br><span class="line">                        values=categorical_cols, state=&quot;readonly&quot;, width=30).pack()</span><br><span class="line">            </span><br><span class="line">            ttk.Label(dialog, text=&quot;é€‰æ‹©ç¼–ç æ–¹æ³•:&quot;).pack(pady=10)</span><br><span class="line">            method_var = tk.StringVar(value=&quot;onehot&quot;)</span><br><span class="line">            ttk.Combobox(dialog, textvariable=method_var, </span><br><span class="line">                        values=[&quot;onehot&quot;, &quot;label&quot;], state=&quot;readonly&quot;, width=20).pack()</span><br><span class="line">            </span><br><span class="line">            def apply():</span><br><span class="line">                if column_var.get():</span><br><span class="line">                    self.cleaner.encode_categorical(column_var.get(), method_var.get())</span><br><span class="line">                    self.display_data()</span><br><span class="line">                    dialog.destroy()</span><br><span class="line">                    self.update_status(f&quot;ç¼–ç åˆ†ç±»å˜é‡: &#123;column_var.get()&#125;&quot;)</span><br><span class="line">                else:</span><br><span class="line">                    messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·é€‰æ‹©ä¸€åˆ—&quot;)</span><br><span class="line">            </span><br><span class="line">            ttk.Button(dialog, text=&quot;åº”ç”¨&quot;, command=apply).pack(pady=20)</span><br><span class="line">        </span><br><span class="line">        def undo(self):</span><br><span class="line">            &quot;&quot;&quot;æ’¤é”€æ“ä½œ&quot;&quot;&quot;</span><br><span class="line">            if self.cleaner.undo():</span><br><span class="line">                self.display_data()</span><br><span class="line">                self.update_status(&quot;æ’¤é”€ä¸Šä¸€æ­¥æ“ä½œ&quot;)</span><br><span class="line">            else:</span><br><span class="line">                messagebox.showinfo(&quot;ä¿¡æ¯&quot;, &quot;æ— æ³•æ’¤é”€&quot;)</span><br><span class="line">        </span><br><span class="line">        def generate_report(self):</span><br><span class="line">            &quot;&quot;&quot;ç”ŸæˆæŠ¥å‘Š&quot;&quot;&quot;</span><br><span class="line">            if self.cleaner.data is None:</span><br><span class="line">                messagebox.showwarning(&quot;è­¦å‘Š&quot;, &quot;è¯·å…ˆåŠ è½½æ•°æ®&quot;)</span><br><span class="line">                return</span><br><span class="line">            </span><br><span class="line">            report = self.cleaner.generate_report()</span><br><span class="line">            </span><br><span class="line">            report_window = tk.Toplevel(self.root)</span><br><span class="line">            report_window.title(&quot;æ•°æ®æ¸…æ´—æŠ¥å‘Š&quot;)</span><br><span class="line">            report_window.geometry(&quot;700x500&quot;)</span><br><span class="line">            </span><br><span class="line">            text_widget = scrolledtext.ScrolledText(report_window, wrap=tk.WORD)</span><br><span class="line">            text_widget.pack(fill=tk.BOTH, expand=True, padx=10, pady=10)</span><br><span class="line">            </span><br><span class="line">            text_widget.insert(tk.END, report)</span><br><span class="line">            text_widget.config(state=tk.DISABLED)</span><br><span class="line">            </span><br><span class="line">            # æ·»åŠ ä¿å­˜æŒ‰é’®</span><br><span class="line">            def save_report():</span><br><span class="line">                file_path = filedialog.asksaveasfilename(</span><br><span class="line">                    defaultextension=&#x27;.txt&#x27;,</span><br><span class="line">                    filetypes=[(&#x27;æ–‡æœ¬æ–‡ä»¶&#x27;, &#x27;*.txt&#x27;), (&#x27;æ‰€æœ‰æ–‡ä»¶&#x27;, &#x27;*.*&#x27;)]</span><br><span class="line">                )</span><br><span class="line">                if file_path:</span><br><span class="line">                    with open(file_path, &#x27;w&#x27;, encoding=&#x27;utf-8&#x27;) as f:</span><br><span class="line">                        f.write(report)</span><br><span class="line">                    messagebox.showinfo(&quot;æˆåŠŸ&quot;, f&quot;æŠ¥å‘Šå·²ä¿å­˜åˆ°:\n&#123;file_path&#125;&quot;)</span><br><span class="line">            </span><br><span class="line">            ttk.Button(report_window, text=&quot;ä¿å­˜æŠ¥å‘Š&quot;, command=save_report).pack(pady=10)</span><br><span class="line">        </span><br><span class="line">        def update_status(self, message):</span><br><span class="line">            &quot;&quot;&quot;æ›´æ–°çŠ¶æ€æ &quot;&quot;&quot;</span><br><span class="line">            self.status_bar.config(text=message)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    &quot;&quot;&quot;ä¸»å‡½æ•°&quot;&quot;&quot;</span><br><span class="line">    if len(sys.argv) &gt; 1:</span><br><span class="line">        # å‘½ä»¤è¡Œæ¨¡å¼</span><br><span class="line">        cli = DataCleanerCLI()</span><br><span class="line">        cli.run()</span><br><span class="line">    else:</span><br><span class="line">        # GUIæ¨¡å¼</span><br><span class="line">        if not GUI_AVAILABLE:</span><br><span class="line">            print(&quot;GUIç»„ä»¶ä¸å¯ç”¨ï¼Œè¯·å®‰è£…å¿…è¦çš„åŒ…:&quot;)</span><br><span class="line">            print(&quot;pip install tkinter matplotlib seaborn pandas numpy&quot;)</span><br><span class="line">            print(&quot;\næˆ–è€…ä½¿ç”¨å‘½ä»¤è¡Œæ¨¡å¼:&quot;)</span><br><span class="line">            print(&quot;python data_cleaner.py [command] [options]&quot;)</span><br><span class="line">            sys.exit(1)</span><br><span class="line">        </span><br><span class="line">        root = tk.Tk()</span><br><span class="line">        app = DataCleanerGUI(root)</span><br><span class="line">        root.mainloop()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>



<p>è¿™ä¸ªæ•°æ®æ¸…æ´—å¤„ç†å·¥å…·å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p>
<h2 id="ğŸ¯-æ ¸å¿ƒåŠŸèƒ½"><a href="#ğŸ¯-æ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="ğŸ¯ æ ¸å¿ƒåŠŸèƒ½"></a>ğŸ¯ <strong>æ ¸å¿ƒåŠŸèƒ½</strong></h2><h3 id="1-æ•°æ®åŠ è½½ä¸ä¿å­˜"><a href="#1-æ•°æ®åŠ è½½ä¸ä¿å­˜" class="headerlink" title="1. æ•°æ®åŠ è½½ä¸ä¿å­˜"></a>1. <strong>æ•°æ®åŠ è½½ä¸ä¿å­˜</strong></h3><ul>
<li>æ”¯æŒå¤šç§æ ¼å¼ï¼šCSVã€Excelã€JSONã€Parquetã€Feather</li>
<li>æ™ºèƒ½è¯†åˆ«æ–‡ä»¶æ ¼å¼</li>
</ul>
<h3 id="2-æ•°æ®æ¸…æ´—åŠŸèƒ½"><a href="#2-æ•°æ®æ¸…æ´—åŠŸèƒ½" class="headerlink" title="2. æ•°æ®æ¸…æ´—åŠŸèƒ½"></a>2. <strong>æ•°æ®æ¸…æ´—åŠŸèƒ½</strong></h3><ul>
<li><strong>ç¼ºå¤±å€¼å¤„ç†</strong>ï¼šå‡å€¼&#x2F;ä¸­ä½æ•°&#x2F;ä¼—æ•°å¡«å……ã€å‰å‘&#x2F;åå‘å¡«å……ã€åˆ é™¤ã€è‡ªå®šä¹‰å€¼å¡«å……</li>
<li><strong>é‡å¤å€¼å¤„ç†</strong>ï¼šåŸºäºæŒ‡å®šåˆ—æˆ–å…¨éƒ¨åˆ—å»é™¤é‡å¤</li>
<li><strong>æ•°æ®ç±»å‹è½¬æ¢</strong>ï¼šæ•´æ•°ã€æµ®ç‚¹æ•°ã€å­—ç¬¦ä¸²ã€æ—¥æœŸæ—¶é—´ã€åˆ†ç±»ã€å¸ƒå°”å€¼</li>
<li><strong>åˆ—æ“ä½œ</strong>ï¼šé‡å‘½åã€åˆ é™¤ã€é€‰æ‹©</li>
<li><strong>æ•°æ®è¿‡æ»¤</strong>ï¼šä½¿ç”¨è¡¨è¾¾å¼æ¡ä»¶è¿‡æ»¤</li>
<li><strong>æ ‡å‡†åŒ–&#x2F;å½’ä¸€åŒ–</strong>ï¼šMinMaxæ ‡å‡†åŒ–ã€Z-Scoreæ ‡å‡†åŒ–</li>
<li><strong>å¼‚å¸¸å€¼å¤„ç†</strong>ï¼šIQRæ–¹æ³•ã€Z-Scoreæ–¹æ³•</li>
<li><strong>åˆ†ç±»å˜é‡ç¼–ç </strong>ï¼šOne-Hotç¼–ç ã€Labelç¼–ç </li>
<li><strong>æ—¥æœŸæ—¶é—´ç‰¹å¾æå–</strong>ï¼šå¹´ã€æœˆã€æ—¥ã€æ˜ŸæœŸã€å°æ—¶ç­‰</li>
</ul>
<h3 id="3-æ•°æ®åˆ†æåŠŸèƒ½"><a href="#3-æ•°æ®åˆ†æåŠŸèƒ½" class="headerlink" title="3. æ•°æ®åˆ†æåŠŸèƒ½"></a>3. <strong>æ•°æ®åˆ†æåŠŸèƒ½</strong></h3><ul>
<li>æ•°æ®åŸºæœ¬ä¿¡æ¯æŸ¥çœ‹</li>
<li>ç»Ÿè®¡æè¿°</li>
<li>æ•°æ®åˆ†å¸ƒåˆ†æ</li>
<li>ç›¸å…³æ€§åˆ†æ</li>
</ul>
<h2 id="ğŸ–¥ï¸-ä¸¤ç§ä½¿ç”¨æ–¹å¼"><a href="#ğŸ–¥ï¸-ä¸¤ç§ä½¿ç”¨æ–¹å¼" class="headerlink" title="ğŸ–¥ï¸ ä¸¤ç§ä½¿ç”¨æ–¹å¼"></a>ğŸ–¥ï¸ <strong>ä¸¤ç§ä½¿ç”¨æ–¹å¼</strong></h2><h3 id="1-å‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰"><a href="#1-å‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰" class="headerlink" title="1. å‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰"></a><strong>1. å‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰</strong></h3><p>é€‚åˆç†Ÿç»ƒç”¨æˆ·å’Œè‡ªåŠ¨åŒ–ä»»åŠ¡ï¼š</p>
<p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹å¸®åŠ©</span><br><span class="line">python data_cleaner.py --help</span><br><span class="line"></span><br><span class="line"># åŠ è½½æ•°æ®</span><br><span class="line">python data_cleaner.py load data.csv</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹ä¿¡æ¯</span><br><span class="line">python data_cleaner.py info</span><br><span class="line"></span><br><span class="line"># å¤„ç†ç¼ºå¤±å€¼</span><br><span class="line">python data_cleaner.py missing --strategy mean</span><br><span class="line"></span><br><span class="line"># å»é™¤é‡å¤</span><br><span class="line">python data_cleaner.py dedup --columns &quot;id,name&quot;</span><br><span class="line"></span><br><span class="line"># ä¿å­˜æ•°æ®</span><br><span class="line">python data_cleaner.py save cleaned_data.csv</span><br><span class="line"></span><br><span class="line"># ç”ŸæˆæŠ¥å‘Š</span><br><span class="line">python data_cleaner.py report</span><br></pre></td></tr></table></figure>



<h3 id="2-å›¾å½¢ç•Œé¢ï¼ˆGUIï¼‰"><a href="#2-å›¾å½¢ç•Œé¢ï¼ˆGUIï¼‰" class="headerlink" title="2. å›¾å½¢ç•Œé¢ï¼ˆGUIï¼‰"></a><strong>2. å›¾å½¢ç•Œé¢ï¼ˆGUIï¼‰</strong></h3><p>é€‚åˆéæŠ€æœ¯ç”¨æˆ·ï¼Œç•Œé¢å‹å¥½ï¼š</p>
<p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ç›´æ¥è¿è¡Œæ‰“å¼€GUI</span><br><span class="line">python data_cleaner.py</span><br></pre></td></tr></table></figure>



<p><strong>GUIç‰¹ç‚¹</strong>ï¼š</p>
<ul>
<li>ç›´è§‚çš„æ“ä½œæŒ‰é’®</li>
<li>å®æ—¶æ•°æ®é¢„è§ˆ</li>
<li>å¯è§†åŒ–æ•°æ®åˆ†å¸ƒ</li>
<li>æ“ä½œå†å²è®°å½•</li>
<li>æ’¤é”€åŠŸèƒ½</li>
<li>è¿›åº¦æŒ‡ç¤ºå™¨</li>
</ul>
<h2 id="ğŸ“¦-å®‰è£…ä¾èµ–"><a href="#ğŸ“¦-å®‰è£…ä¾èµ–" class="headerlink" title="ğŸ“¦ å®‰è£…ä¾èµ–"></a>ğŸ“¦ <strong>å®‰è£…ä¾èµ–</strong></h2><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># åŸºç¡€ä¾èµ–</span><br><span class="line">pip install pandas numpy</span><br><span class="line"></span><br><span class="line"># GUIç›¸å…³ä¾èµ–</span><br><span class="line">pip install matplotlib seaborn openpyxl pyarrow fastparquet</span><br><span class="line"></span><br><span class="line"># å¦‚æœéœ€è¦tkinterï¼ˆWindows/macOSé€šå¸¸è‡ªå¸¦ï¼‰</span><br><span class="line"># Linux: sudo apt-get install python3-tk</span><br></pre></td></tr></table></figure>



<h2 id="ğŸš€-ä½¿ç”¨ç¤ºä¾‹"><a href="#ğŸš€-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ğŸš€ ä½¿ç”¨ç¤ºä¾‹"></a>ğŸš€ <strong>ä½¿ç”¨ç¤ºä¾‹</strong></h2><ol>
<li><strong>å¿«é€Ÿå¼€å§‹</strong>ï¼š</li>
</ol>
<p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨Python API</span><br><span class="line">cleaner = DataCleaner()</span><br><span class="line">cleaner.load_data(&quot;data.csv&quot;)</span><br><span class="line">cleaner.handle_missing_values(strategy=&#x27;mean&#x27;)</span><br><span class="line">cleaner.remove_duplicates()</span><br><span class="line">cleaner.save_data(&quot;cleaned_data.csv&quot;)</span><br></pre></td></tr></table></figure>



<ol>
<li><strong>æ‰¹é‡å¤„ç†</strong>ï¼š</li>
</ol>
<p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºå¤„ç†ç®¡é“</span><br><span class="line">def data_cleaning_pipeline(file_path):</span><br><span class="line">    cleaner = DataCleaner()</span><br><span class="line">    cleaner.load_data(file_path)</span><br><span class="line">    cleaner.handle_missing_values(strategy=&#x27;median&#x27;)</span><br><span class="line">    cleaner.normalize_column(&#x27;price&#x27;, method=&#x27;minmax&#x27;)</span><br><span class="line">    cleaner.encode_categorical(&#x27;category&#x27;, method=&#x27;onehot&#x27;)</span><br><span class="line">    return cleaner.data</span><br></pre></td></tr></table></figure>



<h2 id="ğŸ“Š-ç‰¹è‰²åŠŸèƒ½"><a href="#ğŸ“Š-ç‰¹è‰²åŠŸèƒ½" class="headerlink" title="ğŸ“Š ç‰¹è‰²åŠŸèƒ½"></a>ğŸ“Š <strong>ç‰¹è‰²åŠŸèƒ½</strong></h2><ol>
<li><strong>æ“ä½œå†å²è®°å½•</strong>ï¼šæ‰€æœ‰æ“ä½œéƒ½è¢«è®°å½•ï¼Œå¯ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š</li>
<li><strong>æ’¤é”€åŠŸèƒ½</strong>ï¼šæ”¯æŒæ’¤é”€ä¸Šä¸€æ­¥æ“ä½œ</li>
<li><strong>æ•°æ®é¢„è§ˆ</strong>ï¼šå®æ—¶æŸ¥çœ‹æ•°æ®å˜åŒ–</li>
<li><strong>æ‰¹é‡å¤„ç†</strong>ï¼šæ”¯æŒå¯¹å¤šåˆ—åŒæ—¶æ“ä½œ</li>
<li><strong>é”™è¯¯å¤„ç†</strong>ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œç”¨æˆ·æç¤º</li>
<li><strong>è¿›åº¦åé¦ˆ</strong>ï¼šé•¿æ—¶é—´æ“ä½œæ—¶æœ‰è¿›åº¦æç¤º</li>
<li><strong>æŠ¥å‘Šç”Ÿæˆ</strong>ï¼šç”Ÿæˆè¯¦ç»†çš„æ•°æ®æ¸…æ´—æŠ¥å‘Š</li>
</ol>
<p>è¿™ä¸ªå·¥å…·æ—¢æ»¡è¶³äº†ä¸“ä¸šæ•°æ®åˆ†æå¸ˆå¯¹å‘½ä»¤è¡Œæ•ˆç‡çš„éœ€æ±‚ï¼Œåˆä¸ºä¸ç†Ÿæ‚‰å‘½ä»¤è¡Œçš„ç”¨æˆ·æä¾›äº†å‹å¥½çš„å›¾å½¢ç•Œé¢ï¼Œæ¶µç›–äº†æ•°æ®æ¸…æ´—å·¥ä½œä¸­æ‰€éœ€çš„æ ¸å¿ƒæŠ€èƒ½ã€‚</p>
<p>ä¸è¦ä½¿ç”¨GUIï¼Œæˆ‘æ›´å–œæ¬¢webé¡µé¢è¿›è¡Œæ“ä½œ</p>
<p>æˆ‘ä»¬ä½¿ç”¨Flaskåˆ›å»ºä¸€ä¸ªWebåº”ç”¨ï¼Œæä¾›æ•°æ®æ¸…æ´—çš„ç•Œé¢ã€‚<br>ç”±äºä¸ä½¿ç”¨GUIï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªWebé¡µé¢ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æµè§ˆå™¨ä¸Šä¼ æ–‡ä»¶ã€è¿›è¡Œæ•°æ®æ¸…æ´—æ“ä½œã€ä¸‹è½½æ¸…æ´—åçš„æ–‡ä»¶ã€‚</p>
<p>æˆ‘ä»¬å°†è®¾è®¡ä»¥ä¸‹è·¯ç”±ï¼š</p>
<ol>
<li>é¦–é¡µï¼ˆä¸Šä¼ æ–‡ä»¶ï¼‰</li>
<li>æ•°æ®é¢„è§ˆï¼ˆæŸ¥çœ‹åŠ è½½çš„æ•°æ®ï¼‰</li>
<li>æ‰§è¡Œæ¸…æ´—æ“ä½œï¼ˆå¦‚å¤„ç†ç¼ºå¤±å€¼ã€å»é‡ç­‰ï¼‰</li>
<li>ä¸‹è½½æ¸…æ´—åçš„æ–‡ä»¶</li>
</ol>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡å™¨ç«¯ä¿å­˜ç”¨æˆ·ä¸Šä¼ çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨sessionæ¥ä¸´æ—¶å­˜å‚¨ã€‚</p>
<p>æ³¨æ„ï¼šç”±äºæ˜¯ç¤ºä¾‹ï¼Œæˆ‘ä»¬ä¸ä¼šåšå¤ªå¤æ‚çš„ç”¨æˆ·ç®¡ç†ï¼Œæ¯æ¬¡ä¼šè¯å¤„ç†ä¸€ä¸ªæ–‡ä»¶ã€‚</p>
<p>æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç®€å•çš„Flaskåº”ç”¨ï¼Œå¹¶åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š</p>
<ul>
<li>app.py: ä¸»åº”ç”¨æ–‡ä»¶</li>
<li>templates&#x2F;index.html: ä¸»é¡µ</li>
<li>templates&#x2F;preview.html: æ•°æ®é¢„è§ˆé¡µé¢</li>
<li>templates&#x2F;operations.html: æ“ä½œé€‰æ‹©é¡µé¢</li>
</ul>
<p>ç”±äºä»£ç è¾ƒé•¿ï¼Œæˆ‘ä»¬å°†åˆ†æ­¥éª¤æ„å»ºã€‚</p>
<p>é¦–å…ˆï¼Œå®‰è£…å¿…è¦çš„åŒ…ï¼š<br>pip install flask pandas numpy openpyxl</p>
<p>æ³¨æ„ï¼šä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬ä½¿ç”¨CSVå’ŒExcelæ–‡ä»¶ï¼Œå…¶ä»–æ ¼å¼å¯ä»¥åç»­æ·»åŠ ã€‚</p>
<p>æ­¥éª¤ï¼š</p>
<ol>
<li>åˆ›å»ºFlaskåº”ç”¨ï¼Œè®¾ç½®ä¸Šä¼ æ–‡ä»¶å¤¹å’Œå¯†é’¥ã€‚</li>
<li>å®šä¹‰è·¯ç”±å’Œè§†å›¾å‡½æ•°ã€‚</li>
<li>åˆ›å»ºHTMLæ¨¡æ¿ã€‚</li>
</ol>
<p>ç”±äºä»£ç é‡è¾ƒå¤§ï¼Œæˆ‘ä»¬å°†åˆ†éƒ¨åˆ†å±•ç¤ºã€‚</p>
<h1 id="Webç•Œé¢æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·"><a href="#Webç•Œé¢æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·" class="headerlink" title="Webç•Œé¢æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·"></a>Webç•Œé¢æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·</h1><p>æˆ‘å°†ä¸ºæ‚¨åˆ›å»ºä¸€ä¸ªåŸºäºWebçš„æ•°æ®æ¸…æ´—å·¥å…·ï¼Œä½¿ç”¨Flaskæ¡†æ¶æ„å»ºï¼ŒåŒ…å«å®Œæ•´çš„æ•°æ®æ¸…æ´—åŠŸèƒ½ã€‚</p>
<p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># requirements.txt</span><br><span class="line">flask==2.3.3</span><br><span class="line">pandas==2.0.3</span><br><span class="line">numpy==1.24.3</span><br><span class="line">openpyxl==3.1.2</span><br><span class="line">scikit-learn==1.3.0</span><br><span class="line">plotly==5.16.1</span><br><span class="line">dash==2.14.0</span><br><span class="line">dash-bootstrap-components==1.4.0</span><br><span class="line">waitress==2.1.2</span><br></pre></td></tr></table></figure>



<p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br><span class="line">2345</span><br><span class="line">2346</span><br><span class="line">2347</span><br><span class="line">2348</span><br><span class="line">2349</span><br><span class="line">2350</span><br><span class="line">2351</span><br><span class="line">2352</span><br><span class="line">2353</span><br><span class="line">2354</span><br><span class="line">2355</span><br><span class="line">2356</span><br><span class="line">2357</span><br><span class="line">2358</span><br><span class="line">2359</span><br><span class="line">2360</span><br><span class="line">2361</span><br><span class="line">2362</span><br><span class="line">2363</span><br><span class="line">2364</span><br><span class="line">2365</span><br><span class="line">2366</span><br><span class="line">2367</span><br><span class="line">2368</span><br><span class="line">2369</span><br><span class="line">2370</span><br><span class="line">2371</span><br><span class="line">2372</span><br><span class="line">2373</span><br><span class="line">2374</span><br><span class="line">2375</span><br><span class="line">2376</span><br><span class="line">2377</span><br><span class="line">2378</span><br><span class="line">2379</span><br><span class="line">2380</span><br><span class="line">2381</span><br><span class="line">2382</span><br><span class="line">2383</span><br><span class="line">2384</span><br><span class="line">2385</span><br><span class="line">2386</span><br><span class="line">2387</span><br><span class="line">2388</span><br><span class="line">2389</span><br><span class="line">2390</span><br><span class="line">2391</span><br><span class="line">2392</span><br><span class="line">2393</span><br><span class="line">2394</span><br><span class="line">2395</span><br><span class="line">2396</span><br><span class="line">2397</span><br><span class="line">2398</span><br><span class="line">2399</span><br><span class="line">2400</span><br><span class="line">2401</span><br><span class="line">2402</span><br><span class="line">2403</span><br><span class="line">2404</span><br><span class="line">2405</span><br><span class="line">2406</span><br><span class="line">2407</span><br><span class="line">2408</span><br><span class="line">2409</span><br><span class="line">2410</span><br><span class="line">2411</span><br><span class="line">2412</span><br><span class="line">2413</span><br><span class="line">2414</span><br><span class="line">2415</span><br><span class="line">2416</span><br><span class="line">2417</span><br><span class="line">2418</span><br><span class="line">2419</span><br><span class="line">2420</span><br><span class="line">2421</span><br><span class="line">2422</span><br><span class="line">2423</span><br><span class="line">2424</span><br><span class="line">2425</span><br><span class="line">2426</span><br><span class="line">2427</span><br><span class="line">2428</span><br><span class="line">2429</span><br><span class="line">2430</span><br><span class="line">2431</span><br><span class="line">2432</span><br><span class="line">2433</span><br><span class="line">2434</span><br><span class="line">2435</span><br><span class="line">2436</span><br><span class="line">2437</span><br><span class="line">2438</span><br><span class="line">2439</span><br><span class="line">2440</span><br><span class="line">2441</span><br><span class="line">2442</span><br><span class="line">2443</span><br><span class="line">2444</span><br><span class="line">2445</span><br><span class="line">2446</span><br><span class="line">2447</span><br><span class="line">2448</span><br><span class="line">2449</span><br><span class="line">2450</span><br><span class="line">2451</span><br><span class="line">2452</span><br><span class="line">2453</span><br><span class="line">2454</span><br><span class="line">2455</span><br><span class="line">2456</span><br><span class="line">2457</span><br><span class="line">2458</span><br><span class="line">2459</span><br><span class="line">2460</span><br><span class="line">2461</span><br><span class="line">2462</span><br><span class="line">2463</span><br><span class="line">2464</span><br><span class="line">2465</span><br><span class="line">2466</span><br><span class="line">2467</span><br><span class="line">2468</span><br><span class="line">2469</span><br><span class="line">2470</span><br><span class="line">2471</span><br><span class="line">2472</span><br><span class="line">2473</span><br><span class="line">2474</span><br><span class="line">2475</span><br><span class="line">2476</span><br><span class="line">2477</span><br><span class="line">2478</span><br><span class="line">2479</span><br><span class="line">2480</span><br><span class="line">2481</span><br><span class="line">2482</span><br><span class="line">2483</span><br><span class="line">2484</span><br><span class="line">2485</span><br><span class="line">2486</span><br><span class="line">2487</span><br><span class="line">2488</span><br><span class="line">2489</span><br><span class="line">2490</span><br><span class="line">2491</span><br><span class="line">2492</span><br><span class="line">2493</span><br><span class="line">2494</span><br><span class="line">2495</span><br><span class="line">2496</span><br><span class="line">2497</span><br><span class="line">2498</span><br><span class="line">2499</span><br><span class="line">2500</span><br><span class="line">2501</span><br><span class="line">2502</span><br><span class="line">2503</span><br><span class="line">2504</span><br><span class="line">2505</span><br><span class="line">2506</span><br><span class="line">2507</span><br><span class="line">2508</span><br><span class="line">2509</span><br><span class="line">2510</span><br><span class="line">2511</span><br><span class="line">2512</span><br><span class="line">2513</span><br><span class="line">2514</span><br><span class="line">2515</span><br><span class="line">2516</span><br><span class="line">2517</span><br><span class="line">2518</span><br><span class="line">2519</span><br><span class="line">2520</span><br><span class="line">2521</span><br><span class="line">2522</span><br><span class="line">2523</span><br><span class="line">2524</span><br><span class="line">2525</span><br><span class="line">2526</span><br><span class="line">2527</span><br><span class="line">2528</span><br><span class="line">2529</span><br><span class="line">2530</span><br><span class="line">2531</span><br><span class="line">2532</span><br><span class="line">2533</span><br><span class="line">2534</span><br><span class="line">2535</span><br><span class="line">2536</span><br><span class="line">2537</span><br><span class="line">2538</span><br><span class="line">2539</span><br><span class="line">2540</span><br><span class="line">2541</span><br><span class="line">2542</span><br><span class="line">2543</span><br><span class="line">2544</span><br><span class="line">2545</span><br><span class="line">2546</span><br><span class="line">2547</span><br><span class="line">2548</span><br><span class="line">2549</span><br><span class="line">2550</span><br><span class="line">2551</span><br><span class="line">2552</span><br><span class="line">2553</span><br><span class="line">2554</span><br><span class="line">2555</span><br><span class="line">2556</span><br><span class="line">2557</span><br><span class="line">2558</span><br><span class="line">2559</span><br><span class="line">2560</span><br><span class="line">2561</span><br><span class="line">2562</span><br><span class="line">2563</span><br><span class="line">2564</span><br><span class="line">2565</span><br><span class="line">2566</span><br><span class="line">2567</span><br><span class="line">2568</span><br><span class="line">2569</span><br><span class="line">2570</span><br><span class="line">2571</span><br><span class="line">2572</span><br><span class="line">2573</span><br><span class="line">2574</span><br><span class="line">2575</span><br><span class="line">2576</span><br><span class="line">2577</span><br><span class="line">2578</span><br><span class="line">2579</span><br><span class="line">2580</span><br><span class="line">2581</span><br><span class="line">2582</span><br><span class="line">2583</span><br><span class="line">2584</span><br><span class="line">2585</span><br><span class="line">2586</span><br><span class="line">2587</span><br><span class="line">2588</span><br><span class="line">2589</span><br><span class="line">2590</span><br><span class="line">2591</span><br><span class="line">2592</span><br><span class="line">2593</span><br><span class="line">2594</span><br><span class="line">2595</span><br><span class="line">2596</span><br><span class="line">2597</span><br><span class="line">2598</span><br><span class="line">2599</span><br><span class="line">2600</span><br><span class="line">2601</span><br><span class="line">2602</span><br><span class="line">2603</span><br><span class="line">2604</span><br><span class="line">2605</span><br><span class="line">2606</span><br><span class="line">2607</span><br><span class="line">2608</span><br><span class="line">2609</span><br><span class="line">2610</span><br><span class="line">2611</span><br><span class="line">2612</span><br><span class="line">2613</span><br><span class="line">2614</span><br><span class="line">2615</span><br><span class="line">2616</span><br><span class="line">2617</span><br><span class="line">2618</span><br><span class="line">2619</span><br><span class="line">2620</span><br><span class="line">2621</span><br><span class="line">2622</span><br><span class="line">2623</span><br><span class="line">2624</span><br><span class="line">2625</span><br><span class="line">2626</span><br><span class="line">2627</span><br><span class="line">2628</span><br><span class="line">2629</span><br><span class="line">2630</span><br><span class="line">2631</span><br><span class="line">2632</span><br><span class="line">2633</span><br><span class="line">2634</span><br><span class="line">2635</span><br><span class="line">2636</span><br><span class="line">2637</span><br><span class="line">2638</span><br><span class="line">2639</span><br><span class="line">2640</span><br><span class="line">2641</span><br><span class="line">2642</span><br><span class="line">2643</span><br><span class="line">2644</span><br><span class="line">2645</span><br><span class="line">2646</span><br><span class="line">2647</span><br><span class="line">2648</span><br><span class="line">2649</span><br><span class="line">2650</span><br><span class="line">2651</span><br><span class="line">2652</span><br><span class="line">2653</span><br><span class="line">2654</span><br><span class="line">2655</span><br><span class="line">2656</span><br><span class="line">2657</span><br><span class="line">2658</span><br><span class="line">2659</span><br><span class="line">2660</span><br><span class="line">2661</span><br><span class="line">2662</span><br><span class="line">2663</span><br><span class="line">2664</span><br><span class="line">2665</span><br><span class="line">2666</span><br><span class="line">2667</span><br><span class="line">2668</span><br><span class="line">2669</span><br><span class="line">2670</span><br><span class="line">2671</span><br><span class="line">2672</span><br><span class="line">2673</span><br><span class="line">2674</span><br><span class="line">2675</span><br><span class="line">2676</span><br><span class="line">2677</span><br><span class="line">2678</span><br><span class="line">2679</span><br><span class="line">2680</span><br><span class="line">2681</span><br><span class="line">2682</span><br><span class="line">2683</span><br><span class="line">2684</span><br><span class="line">2685</span><br><span class="line">2686</span><br><span class="line">2687</span><br><span class="line">2688</span><br><span class="line">2689</span><br><span class="line">2690</span><br><span class="line">2691</span><br><span class="line">2692</span><br><span class="line">2693</span><br><span class="line">2694</span><br><span class="line">2695</span><br><span class="line">2696</span><br><span class="line">2697</span><br><span class="line">2698</span><br><span class="line">2699</span><br><span class="line">2700</span><br><span class="line">2701</span><br><span class="line">2702</span><br><span class="line">2703</span><br><span class="line">2704</span><br><span class="line">2705</span><br><span class="line">2706</span><br><span class="line">2707</span><br><span class="line">2708</span><br><span class="line">2709</span><br><span class="line">2710</span><br><span class="line">2711</span><br><span class="line">2712</span><br><span class="line">2713</span><br><span class="line">2714</span><br><span class="line">2715</span><br><span class="line">2716</span><br><span class="line">2717</span><br><span class="line">2718</span><br><span class="line">2719</span><br><span class="line">2720</span><br><span class="line">2721</span><br><span class="line">2722</span><br><span class="line">2723</span><br><span class="line">2724</span><br><span class="line">2725</span><br><span class="line">2726</span><br><span class="line">2727</span><br><span class="line">2728</span><br><span class="line">2729</span><br><span class="line">2730</span><br><span class="line">2731</span><br><span class="line">2732</span><br><span class="line">2733</span><br><span class="line">2734</span><br><span class="line">2735</span><br><span class="line">2736</span><br><span class="line">2737</span><br><span class="line">2738</span><br><span class="line">2739</span><br><span class="line">2740</span><br><span class="line">2741</span><br><span class="line">2742</span><br><span class="line">2743</span><br><span class="line">2744</span><br><span class="line">2745</span><br><span class="line">2746</span><br><span class="line">2747</span><br><span class="line">2748</span><br><span class="line">2749</span><br><span class="line">2750</span><br><span class="line">2751</span><br><span class="line">2752</span><br><span class="line">2753</span><br><span class="line">2754</span><br><span class="line">2755</span><br><span class="line">2756</span><br><span class="line">2757</span><br><span class="line">2758</span><br><span class="line">2759</span><br><span class="line">2760</span><br><span class="line">2761</span><br><span class="line">2762</span><br><span class="line">2763</span><br><span class="line">2764</span><br><span class="line">2765</span><br><span class="line">2766</span><br><span class="line">2767</span><br><span class="line">2768</span><br><span class="line">2769</span><br><span class="line">2770</span><br><span class="line">2771</span><br><span class="line">2772</span><br><span class="line">2773</span><br><span class="line">2774</span><br><span class="line">2775</span><br><span class="line">2776</span><br><span class="line">2777</span><br><span class="line">2778</span><br><span class="line">2779</span><br><span class="line">2780</span><br><span class="line">2781</span><br><span class="line">2782</span><br><span class="line">2783</span><br><span class="line">2784</span><br><span class="line">2785</span><br><span class="line">2786</span><br><span class="line">2787</span><br><span class="line">2788</span><br><span class="line">2789</span><br><span class="line">2790</span><br><span class="line">2791</span><br><span class="line">2792</span><br><span class="line">2793</span><br><span class="line">2794</span><br><span class="line">2795</span><br><span class="line">2796</span><br><span class="line">2797</span><br><span class="line">2798</span><br><span class="line">2799</span><br><span class="line">2800</span><br><span class="line">2801</span><br><span class="line">2802</span><br><span class="line">2803</span><br><span class="line">2804</span><br><span class="line">2805</span><br><span class="line">2806</span><br><span class="line">2807</span><br><span class="line">2808</span><br><span class="line">2809</span><br><span class="line">2810</span><br><span class="line">2811</span><br><span class="line">2812</span><br><span class="line">2813</span><br><span class="line">2814</span><br><span class="line">2815</span><br><span class="line">2816</span><br><span class="line">2817</span><br><span class="line">2818</span><br><span class="line">2819</span><br><span class="line">2820</span><br><span class="line">2821</span><br><span class="line">2822</span><br><span class="line">2823</span><br><span class="line">2824</span><br><span class="line">2825</span><br><span class="line">2826</span><br><span class="line">2827</span><br><span class="line">2828</span><br><span class="line">2829</span><br><span class="line">2830</span><br><span class="line">2831</span><br><span class="line">2832</span><br><span class="line">2833</span><br><span class="line">2834</span><br><span class="line">2835</span><br><span class="line">2836</span><br><span class="line">2837</span><br><span class="line">2838</span><br><span class="line">2839</span><br><span class="line">2840</span><br><span class="line">2841</span><br><span class="line">2842</span><br><span class="line">2843</span><br><span class="line">2844</span><br><span class="line">2845</span><br><span class="line">2846</span><br><span class="line">2847</span><br><span class="line">2848</span><br><span class="line">2849</span><br><span class="line">2850</span><br><span class="line">2851</span><br><span class="line">2852</span><br><span class="line">2853</span><br><span class="line">2854</span><br><span class="line">2855</span><br><span class="line">2856</span><br><span class="line">2857</span><br><span class="line">2858</span><br><span class="line">2859</span><br><span class="line">2860</span><br><span class="line">2861</span><br><span class="line">2862</span><br><span class="line">2863</span><br><span class="line">2864</span><br><span class="line">2865</span><br><span class="line">2866</span><br><span class="line">2867</span><br><span class="line">2868</span><br><span class="line">2869</span><br><span class="line">2870</span><br><span class="line">2871</span><br><span class="line">2872</span><br><span class="line">2873</span><br><span class="line">2874</span><br><span class="line">2875</span><br><span class="line">2876</span><br><span class="line">2877</span><br><span class="line">2878</span><br><span class="line">2879</span><br><span class="line">2880</span><br><span class="line">2881</span><br><span class="line">2882</span><br><span class="line">2883</span><br><span class="line">2884</span><br><span class="line">2885</span><br><span class="line">2886</span><br><span class="line">2887</span><br><span class="line">2888</span><br><span class="line">2889</span><br><span class="line">2890</span><br><span class="line">2891</span><br><span class="line">2892</span><br><span class="line">2893</span><br><span class="line">2894</span><br><span class="line">2895</span><br><span class="line">2896</span><br><span class="line">2897</span><br><span class="line">2898</span><br><span class="line">2899</span><br><span class="line">2900</span><br><span class="line">2901</span><br><span class="line">2902</span><br><span class="line">2903</span><br><span class="line">2904</span><br><span class="line">2905</span><br><span class="line">2906</span><br><span class="line">2907</span><br><span class="line">2908</span><br><span class="line">2909</span><br><span class="line">2910</span><br><span class="line">2911</span><br><span class="line">2912</span><br><span class="line">2913</span><br><span class="line">2914</span><br><span class="line">2915</span><br><span class="line">2916</span><br><span class="line">2917</span><br><span class="line">2918</span><br><span class="line">2919</span><br><span class="line">2920</span><br><span class="line">2921</span><br><span class="line">2922</span><br><span class="line">2923</span><br><span class="line">2924</span><br><span class="line">2925</span><br><span class="line">2926</span><br><span class="line">2927</span><br><span class="line">2928</span><br><span class="line">2929</span><br><span class="line">2930</span><br><span class="line">2931</span><br><span class="line">2932</span><br><span class="line">2933</span><br><span class="line">2934</span><br><span class="line">2935</span><br><span class="line">2936</span><br><span class="line">2937</span><br><span class="line">2938</span><br><span class="line">2939</span><br><span class="line">2940</span><br><span class="line">2941</span><br><span class="line">2942</span><br><span class="line">2943</span><br><span class="line">2944</span><br><span class="line">2945</span><br><span class="line">2946</span><br><span class="line">2947</span><br><span class="line">2948</span><br><span class="line">2949</span><br><span class="line">2950</span><br><span class="line">2951</span><br><span class="line">2952</span><br><span class="line">2953</span><br><span class="line">2954</span><br><span class="line">2955</span><br><span class="line">2956</span><br><span class="line">2957</span><br><span class="line">2958</span><br><span class="line">2959</span><br><span class="line">2960</span><br><span class="line">2961</span><br><span class="line">2962</span><br><span class="line">2963</span><br><span class="line">2964</span><br><span class="line">2965</span><br><span class="line">2966</span><br><span class="line">2967</span><br><span class="line">2968</span><br><span class="line">2969</span><br><span class="line">2970</span><br><span class="line">2971</span><br><span class="line">2972</span><br><span class="line">2973</span><br><span class="line">2974</span><br><span class="line">2975</span><br><span class="line">2976</span><br><span class="line">2977</span><br><span class="line">2978</span><br><span class="line">2979</span><br><span class="line">2980</span><br><span class="line">2981</span><br><span class="line">2982</span><br><span class="line">2983</span><br><span class="line">2984</span><br><span class="line">2985</span><br><span class="line">2986</span><br><span class="line">2987</span><br><span class="line">2988</span><br><span class="line">2989</span><br><span class="line">2990</span><br><span class="line">2991</span><br><span class="line">2992</span><br><span class="line">2993</span><br><span class="line">2994</span><br><span class="line">2995</span><br><span class="line">2996</span><br><span class="line">2997</span><br><span class="line">2998</span><br><span class="line">2999</span><br><span class="line">3000</span><br><span class="line">3001</span><br><span class="line">3002</span><br><span class="line">3003</span><br><span class="line">3004</span><br><span class="line">3005</span><br><span class="line">3006</span><br><span class="line">3007</span><br><span class="line">3008</span><br><span class="line">3009</span><br><span class="line">3010</span><br><span class="line">3011</span><br><span class="line">3012</span><br><span class="line">3013</span><br><span class="line">3014</span><br><span class="line">3015</span><br><span class="line">3016</span><br><span class="line">3017</span><br><span class="line">3018</span><br><span class="line">3019</span><br><span class="line">3020</span><br><span class="line">3021</span><br><span class="line">3022</span><br><span class="line">3023</span><br><span class="line">3024</span><br><span class="line">3025</span><br><span class="line">3026</span><br><span class="line">3027</span><br><span class="line">3028</span><br><span class="line">3029</span><br><span class="line">3030</span><br><span class="line">3031</span><br><span class="line">3032</span><br><span class="line">3033</span><br><span class="line">3034</span><br><span class="line">3035</span><br><span class="line">3036</span><br><span class="line">3037</span><br><span class="line">3038</span><br><span class="line">3039</span><br><span class="line">3040</span><br><span class="line">3041</span><br><span class="line">3042</span><br><span class="line">3043</span><br><span class="line">3044</span><br><span class="line">3045</span><br><span class="line">3046</span><br><span class="line">3047</span><br><span class="line">3048</span><br><span class="line">3049</span><br><span class="line">3050</span><br><span class="line">3051</span><br><span class="line">3052</span><br><span class="line">3053</span><br><span class="line">3054</span><br><span class="line">3055</span><br><span class="line">3056</span><br><span class="line">3057</span><br><span class="line">3058</span><br><span class="line">3059</span><br><span class="line">3060</span><br><span class="line">3061</span><br><span class="line">3062</span><br><span class="line">3063</span><br><span class="line">3064</span><br><span class="line">3065</span><br><span class="line">3066</span><br><span class="line">3067</span><br><span class="line">3068</span><br><span class="line">3069</span><br><span class="line">3070</span><br><span class="line">3071</span><br><span class="line">3072</span><br><span class="line">3073</span><br><span class="line">3074</span><br><span class="line">3075</span><br><span class="line">3076</span><br><span class="line">3077</span><br><span class="line">3078</span><br><span class="line">3079</span><br><span class="line">3080</span><br><span class="line">3081</span><br><span class="line">3082</span><br><span class="line">3083</span><br><span class="line">3084</span><br><span class="line">3085</span><br><span class="line">3086</span><br><span class="line">3087</span><br><span class="line">3088</span><br><span class="line">3089</span><br><span class="line">3090</span><br><span class="line">3091</span><br><span class="line">3092</span><br><span class="line">3093</span><br><span class="line">3094</span><br><span class="line">3095</span><br><span class="line">3096</span><br><span class="line">3097</span><br><span class="line">3098</span><br><span class="line">3099</span><br><span class="line">3100</span><br><span class="line">3101</span><br><span class="line">3102</span><br><span class="line">3103</span><br><span class="line">3104</span><br><span class="line">3105</span><br><span class="line">3106</span><br><span class="line">3107</span><br><span class="line">3108</span><br><span class="line">3109</span><br><span class="line">3110</span><br><span class="line">3111</span><br><span class="line">3112</span><br><span class="line">3113</span><br><span class="line">3114</span><br><span class="line">3115</span><br><span class="line">3116</span><br><span class="line">3117</span><br><span class="line">3118</span><br><span class="line">3119</span><br><span class="line">3120</span><br><span class="line">3121</span><br><span class="line">3122</span><br><span class="line">3123</span><br><span class="line">3124</span><br><span class="line">3125</span><br><span class="line">3126</span><br><span class="line">3127</span><br><span class="line">3128</span><br><span class="line">3129</span><br><span class="line">3130</span><br><span class="line">3131</span><br><span class="line">3132</span><br><span class="line">3133</span><br><span class="line">3134</span><br><span class="line">3135</span><br><span class="line">3136</span><br><span class="line">3137</span><br><span class="line">3138</span><br><span class="line">3139</span><br><span class="line">3140</span><br><span class="line">3141</span><br><span class="line">3142</span><br><span class="line">3143</span><br><span class="line">3144</span><br><span class="line">3145</span><br><span class="line">3146</span><br><span class="line">3147</span><br><span class="line">3148</span><br><span class="line">3149</span><br><span class="line">3150</span><br><span class="line">3151</span><br><span class="line">3152</span><br><span class="line">3153</span><br><span class="line">3154</span><br><span class="line">3155</span><br><span class="line">3156</span><br><span class="line">3157</span><br><span class="line">3158</span><br><span class="line">3159</span><br><span class="line">3160</span><br><span class="line">3161</span><br><span class="line">3162</span><br><span class="line">3163</span><br><span class="line">3164</span><br><span class="line">3165</span><br><span class="line">3166</span><br><span class="line">3167</span><br><span class="line">3168</span><br><span class="line">3169</span><br><span class="line">3170</span><br><span class="line">3171</span><br><span class="line">3172</span><br><span class="line">3173</span><br><span class="line">3174</span><br><span class="line">3175</span><br><span class="line">3176</span><br><span class="line">3177</span><br><span class="line">3178</span><br><span class="line">3179</span><br><span class="line">3180</span><br><span class="line">3181</span><br><span class="line">3182</span><br><span class="line">3183</span><br><span class="line">3184</span><br><span class="line">3185</span><br><span class="line">3186</span><br><span class="line">3187</span><br><span class="line">3188</span><br><span class="line">3189</span><br><span class="line">3190</span><br><span class="line">3191</span><br><span class="line">3192</span><br><span class="line">3193</span><br><span class="line">3194</span><br><span class="line">3195</span><br><span class="line">3196</span><br><span class="line">3197</span><br><span class="line">3198</span><br><span class="line">3199</span><br><span class="line">3200</span><br><span class="line">3201</span><br><span class="line">3202</span><br><span class="line">3203</span><br><span class="line">3204</span><br><span class="line">3205</span><br><span class="line">3206</span><br><span class="line">3207</span><br><span class="line">3208</span><br><span class="line">3209</span><br><span class="line">3210</span><br><span class="line">3211</span><br><span class="line">3212</span><br><span class="line">3213</span><br><span class="line">3214</span><br><span class="line">3215</span><br><span class="line">3216</span><br><span class="line">3217</span><br><span class="line">3218</span><br><span class="line">3219</span><br><span class="line">3220</span><br><span class="line">3221</span><br><span class="line">3222</span><br><span class="line">3223</span><br><span class="line">3224</span><br><span class="line">3225</span><br><span class="line">3226</span><br><span class="line">3227</span><br><span class="line">3228</span><br><span class="line">3229</span><br><span class="line">3230</span><br><span class="line">3231</span><br><span class="line">3232</span><br><span class="line">3233</span><br><span class="line">3234</span><br><span class="line">3235</span><br><span class="line">3236</span><br><span class="line">3237</span><br><span class="line">3238</span><br><span class="line">3239</span><br><span class="line">3240</span><br><span class="line">3241</span><br><span class="line">3242</span><br><span class="line">3243</span><br><span class="line">3244</span><br><span class="line">3245</span><br><span class="line">3246</span><br><span class="line">3247</span><br><span class="line">3248</span><br><span class="line">3249</span><br><span class="line">3250</span><br><span class="line">3251</span><br><span class="line">3252</span><br><span class="line">3253</span><br><span class="line">3254</span><br><span class="line">3255</span><br><span class="line">3256</span><br></pre></td><td class="code"><pre><span class="line"># app.py - ä¸»åº”ç”¨æ–‡ä»¶</span><br><span class="line">from flask import Flask, render_template, request, jsonify, send_file, session, redirect, url_for</span><br><span class="line">import pandas as pd</span><br><span class="line">import numpy as np</span><br><span class="line">import io</span><br><span class="line">import json</span><br><span class="line">import os</span><br><span class="line">import tempfile</span><br><span class="line">from datetime import datetime</span><br><span class="line">import traceback</span><br><span class="line">from werkzeug.utils import secure_filename</span><br><span class="line">import matplotlib</span><br><span class="line">matplotlib.use(&#x27;Agg&#x27;)</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">import seaborn as sns</span><br><span class="line">import plotly.express as px</span><br><span class="line">import plotly.graph_objects as go</span><br><span class="line">from plotly.subplots import make_subplots</span><br><span class="line">import warnings</span><br><span class="line">warnings.filterwarnings(&#x27;ignore&#x27;)</span><br><span class="line"></span><br><span class="line"># åˆ›å»ºFlaskåº”ç”¨</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = &#x27;data_cleaning_tool_secret_key_2024&#x27;</span><br><span class="line">app.config[&#x27;MAX_CONTENT_LENGTH&#x27;] = 50 * 1024 * 1024  # 50MB æœ€å¤§æ–‡ä»¶å¤§å°</span><br><span class="line">app.config[&#x27;UPLOAD_FOLDER&#x27;] = tempfile.gettempdir()</span><br><span class="line">app.config[&#x27;ALLOWED_EXTENSIONS&#x27;] = &#123;&#x27;csv&#x27;, &#x27;xlsx&#x27;, &#x27;xls&#x27;, &#x27;json&#x27;, &#x27;parquet&#x27;&#125;</span><br><span class="line"></span><br><span class="line">class DataCleaner:</span><br><span class="line">    &quot;&quot;&quot;æ•°æ®æ¸…æ´—æ ¸å¿ƒç±»&quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self):</span><br><span class="line">        self.data = None</span><br><span class="line">        self.original_data = None</span><br><span class="line">        self.history = []</span><br><span class="line">        self.file_info = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">    def load_data(self, file_path, file_type=None):</span><br><span class="line">        &quot;&quot;&quot;åŠ è½½æ•°æ®æ–‡ä»¶&quot;&quot;&quot;</span><br><span class="line">        try:</span><br><span class="line">            if file_type is None:</span><br><span class="line">                file_type = os.path.splitext(file_path)[1].lower().replace(&#x27;.&#x27;, &#x27;&#x27;)</span><br><span class="line">            </span><br><span class="line">            if file_type == &#x27;csv&#x27;:</span><br><span class="line">                self.data = pd.read_csv(file_path)</span><br><span class="line">            elif file_type in [&#x27;xls&#x27;, &#x27;xlsx&#x27;]:</span><br><span class="line">                self.data = pd.read_excel(file_path)</span><br><span class="line">            elif file_type == &#x27;json&#x27;:</span><br><span class="line">                self.data = pd.read_json(file_path)</span><br><span class="line">            elif file_type == &#x27;parquet&#x27;:</span><br><span class="line">                self.data = pd.read_parquet(file_path)</span><br><span class="line">            else:</span><br><span class="line">                # å°è¯•è‡ªåŠ¨æ£€æµ‹</span><br><span class="line">                self.data = pd.read_csv(file_path)</span><br><span class="line">                </span><br><span class="line">            self.original_data = self.data.copy()</span><br><span class="line">            </span><br><span class="line">            # è®°å½•æ–‡ä»¶ä¿¡æ¯</span><br><span class="line">            self.file_info = &#123;</span><br><span class="line">                &#x27;filename&#x27;: os.path.basename(file_path),</span><br><span class="line">                &#x27;file_type&#x27;: file_type,</span><br><span class="line">                &#x27;rows&#x27;: len(self.data),</span><br><span class="line">                &#x27;columns&#x27;: len(self.data.columns),</span><br><span class="line">                &#x27;size&#x27;: os.path.getsize(file_path) if os.path.exists(file_path) else 0</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            self.add_history(f&quot;åŠ è½½æ–‡ä»¶: &#123;self.file_info[&#x27;filename&#x27;]&#125;&quot;)</span><br><span class="line">            return True, &quot;æ–‡ä»¶åŠ è½½æˆåŠŸ&quot;</span><br><span class="line">            </span><br><span class="line">        except Exception as e:</span><br><span class="line">            return False, f&quot;åŠ è½½æ–‡ä»¶å¤±è´¥: &#123;str(e)&#125;&quot;</span><br><span class="line">    </span><br><span class="line">    def load_data_from_bytes(self, file_bytes, filename):</span><br><span class="line">        &quot;&quot;&quot;ä»å­—èŠ‚æµåŠ è½½æ•°æ®&quot;&quot;&quot;</span><br><span class="line">        try:</span><br><span class="line">            file_type = os.path.splitext(filename)[1].lower().replace(&#x27;.&#x27;, &#x27;&#x27;)</span><br><span class="line">            </span><br><span class="line">            if file_type == &#x27;csv&#x27;:</span><br><span class="line">                self.data = pd.read_csv(io.BytesIO(file_bytes))</span><br><span class="line">            elif file_type in [&#x27;xls&#x27;, &#x27;xlsx&#x27;]:</span><br><span class="line">                self.data = pd.read_excel(io.BytesIO(file_bytes))</span><br><span class="line">            elif file_type == &#x27;json&#x27;:</span><br><span class="line">                self.data = pd.read_json(io.BytesIO(file_bytes))</span><br><span class="line">            elif file_type == &#x27;parquet&#x27;:</span><br><span class="line">                self.data = pd.read_parquet(io.BytesIO(file_bytes))</span><br><span class="line">            else:</span><br><span class="line">                # å°è¯•CSV</span><br><span class="line">                self.data = pd.read_csv(io.BytesIO(file_bytes))</span><br><span class="line">                </span><br><span class="line">            self.original_data = self.data.copy()</span><br><span class="line">            </span><br><span class="line">            self.file_info = &#123;</span><br><span class="line">                &#x27;filename&#x27;: filename,</span><br><span class="line">                &#x27;file_type&#x27;: file_type,</span><br><span class="line">                &#x27;rows&#x27;: len(self.data),</span><br><span class="line">                &#x27;columns&#x27;: len(self.data.columns),</span><br><span class="line">                &#x27;size&#x27;: len(file_bytes)</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            self.add_history(f&quot;åŠ è½½æ–‡ä»¶: &#123;filename&#125;&quot;)</span><br><span class="line">            return True, &quot;æ–‡ä»¶åŠ è½½æˆåŠŸ&quot;</span><br><span class="line">            </span><br><span class="line">        except Exception as e:</span><br><span class="line">            return False, f&quot;åŠ è½½æ–‡ä»¶å¤±è´¥: &#123;str(e)&#125;&quot;</span><br><span class="line">    </span><br><span class="line">    def get_info(self):</span><br><span class="line">        &quot;&quot;&quot;è·å–æ•°æ®åŸºæœ¬ä¿¡æ¯&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return None</span><br><span class="line">        </span><br><span class="line">        info = &#123;</span><br><span class="line">            &#x27;shape&#x27;: self.data.shape,</span><br><span class="line">            &#x27;columns&#x27;: list(self.data.columns),</span><br><span class="line">            &#x27;dtypes&#x27;: &#123;col: str(dtype) for col, dtype in self.data.dtypes.items()&#125;,</span><br><span class="line">            &#x27;null_counts&#x27;: self.data.isnull().sum().to_dict(),</span><br><span class="line">            &#x27;memory_usage&#x27;: int(self.data.memory_usage(deep=True).sum()),</span><br><span class="line">            &#x27;file_info&#x27;: self.file_info</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        # æ•°å€¼åˆ—çš„æè¿°æ€§ç»Ÿè®¡</span><br><span class="line">        numeric_cols = self.data.select_dtypes(include=[np.number]).columns</span><br><span class="line">        if len(numeric_cols) &gt; 0:</span><br><span class="line">            info[&#x27;describe&#x27;] = self.data[numeric_cols].describe().to_dict()</span><br><span class="line">        else:</span><br><span class="line">            info[&#x27;describe&#x27;] = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        # éæ•°å€¼åˆ—çš„å”¯ä¸€å€¼ç»Ÿè®¡</span><br><span class="line">        object_cols = self.data.select_dtypes(include=[&#x27;object&#x27;, &#x27;category&#x27;]).columns</span><br><span class="line">        info[&#x27;unique_counts&#x27;] = &#123;col: int(self.data[col].nunique()) for col in object_cols&#125;</span><br><span class="line">        </span><br><span class="line">        return info</span><br><span class="line">    </span><br><span class="line">    def handle_missing_values(self, strategy=&#x27;mean&#x27;, columns=None, custom_value=None):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†ç¼ºå¤±å€¼&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False, &quot;æ²¡æœ‰åŠ è½½æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        if columns is None:</span><br><span class="line">            columns = self.data.columns</span><br><span class="line">        elif isinstance(columns, str):</span><br><span class="line">            columns = [columns]</span><br><span class="line">        </span><br><span class="line">        affected_cols = []</span><br><span class="line">        for col in columns:</span><br><span class="line">            if col in self.data.columns and self.data[col].isnull().any():</span><br><span class="line">                affected_cols.append(col)</span><br><span class="line">                </span><br><span class="line">                if strategy == &#x27;drop&#x27;:</span><br><span class="line">                    self.data = self.data.dropna(subset=[col])</span><br><span class="line">                elif strategy == &#x27;mean&#x27; and self.data[col].dtype in [np.float64, np.int64]:</span><br><span class="line">                    self.data[col] = self.data[col].fillna(self.data[col].mean())</span><br><span class="line">                elif strategy == &#x27;median&#x27; and self.data[col].dtype in [np.float64, np.int64]:</span><br><span class="line">                    self.data[col] = self.data[col].fillna(self.data[col].median())</span><br><span class="line">                elif strategy == &#x27;mode&#x27;:</span><br><span class="line">                    mode_val = self.data[col].mode()</span><br><span class="line">                    fill_val = mode_val[0] if not mode_val.empty else custom_value</span><br><span class="line">                    self.data[col] = self.data[col].fillna(fill_val)</span><br><span class="line">                elif strategy == &#x27;forward&#x27;:</span><br><span class="line">                    self.data[col] = self.data[col].fillna(method=&#x27;ffill&#x27;)</span><br><span class="line">                elif strategy == &#x27;backward&#x27;:</span><br><span class="line">                    self.data[col] = self.data[col].fillna(method=&#x27;bfill&#x27;)</span><br><span class="line">                elif strategy == &#x27;custom&#x27;:</span><br><span class="line">                    self.data[col] = self.data[col].fillna(custom_value)</span><br><span class="line">        </span><br><span class="line">        if affected_cols:</span><br><span class="line">            self.add_history(f&quot;å¤„ç†ç¼ºå¤±å€¼: &#123;strategy&#125; - å½±å“çš„åˆ—: &#123;&#x27;, &#x27;.join(affected_cols)&#125;&quot;)</span><br><span class="line">            return True, f&quot;æˆåŠŸå¤„ç† &#123;len(affected_cols)&#125; åˆ—çš„ç¼ºå¤±å€¼&quot;</span><br><span class="line">        else:</span><br><span class="line">            return True, &quot;æ²¡æœ‰å‘ç°ç¼ºå¤±å€¼&quot;</span><br><span class="line">    </span><br><span class="line">    def remove_duplicates(self, subset=None, keep=&#x27;first&#x27;):</span><br><span class="line">        &quot;&quot;&quot;å»é™¤é‡å¤å€¼&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False, &quot;æ²¡æœ‰åŠ è½½æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        before = len(self.data)</span><br><span class="line">        </span><br><span class="line">        if subset is None or subset == &#x27;all&#x27;:</span><br><span class="line">            subset = None</span><br><span class="line">        elif isinstance(subset, str):</span><br><span class="line">            subset = [col.strip() for col in subset.split(&#x27;,&#x27;)]</span><br><span class="line">        </span><br><span class="line">        self.data = self.data.drop_duplicates(subset=subset, keep=keep)</span><br><span class="line">        after = len(self.data)</span><br><span class="line">        </span><br><span class="line">        removed = before - after</span><br><span class="line">        self.add_history(f&quot;å»é™¤é‡å¤å€¼: ä» &#123;before&#125; è¡Œå‡å°‘åˆ° &#123;after&#125; è¡Œï¼Œç§»é™¤äº† &#123;removed&#125; è¡Œ&quot;)</span><br><span class="line">        </span><br><span class="line">        if removed &gt; 0:</span><br><span class="line">            return True, f&quot;ç§»é™¤äº† &#123;removed&#125; ä¸ªé‡å¤è¡Œ&quot;</span><br><span class="line">        else:</span><br><span class="line">            return True, &quot;æ²¡æœ‰å‘ç°é‡å¤è¡Œ&quot;</span><br><span class="line">    </span><br><span class="line">    def change_column_type(self, column, new_type):</span><br><span class="line">        &quot;&quot;&quot;æ›´æ”¹åˆ—æ•°æ®ç±»å‹&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False, &quot;æ²¡æœ‰åŠ è½½æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        if column not in self.data.columns:</span><br><span class="line">            return False, f&quot;åˆ— &#x27;&#123;column&#125;&#x27; ä¸å­˜åœ¨&quot;</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            old_type = str(self.data[column].dtype)</span><br><span class="line">            </span><br><span class="line">            if new_type == &#x27;int&#x27;:</span><br><span class="line">                self.data[column] = pd.to_numeric(self.data[column], errors=&#x27;coerce&#x27;).astype(&#x27;Int64&#x27;)</span><br><span class="line">            elif new_type == &#x27;float&#x27;:</span><br><span class="line">                self.data[column] = pd.to_numeric(self.data[column], errors=&#x27;coerce&#x27;).astype(&#x27;float64&#x27;)</span><br><span class="line">            elif new_type == &#x27;str&#x27;:</span><br><span class="line">                self.data[column] = self.data[column].astype(str)</span><br><span class="line">            elif new_type == &#x27;datetime&#x27;:</span><br><span class="line">                self.data[column] = pd.to_datetime(self.data[column], errors=&#x27;coerce&#x27;)</span><br><span class="line">            elif new_type == &#x27;category&#x27;:</span><br><span class="line">                self.data[column] = self.data[column].astype(&#x27;category&#x27;)</span><br><span class="line">            elif new_type == &#x27;bool&#x27;:</span><br><span class="line">                self.data[column] = self.data[column].astype(bool)</span><br><span class="line">            </span><br><span class="line">            self.add_history(f&quot;æ›´æ”¹åˆ—ç±»å‹: &#123;column&#125; ä» &#123;old_type&#125; æ”¹ä¸º &#123;new_type&#125;&quot;)</span><br><span class="line">            return True, f&quot;æˆåŠŸå°†åˆ— &#x27;&#123;column&#125;&#x27; ç±»å‹ä» &#123;old_type&#125; æ”¹ä¸º &#123;new_type&#125;&quot;</span><br><span class="line">            </span><br><span class="line">        except Exception as e:</span><br><span class="line">            return False, f&quot;ç±»å‹è½¬æ¢å¤±è´¥: &#123;str(e)&#125;&quot;</span><br><span class="line">    </span><br><span class="line">    def rename_columns(self, rename_dict):</span><br><span class="line">        &quot;&quot;&quot;é‡å‘½ååˆ—&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False, &quot;æ²¡æœ‰åŠ è½½æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        # éªŒè¯é‡å‘½åå­—å…¸</span><br><span class="line">        valid_rename = &#123;&#125;</span><br><span class="line">        for old_name, new_name in rename_dict.items():</span><br><span class="line">            if old_name in self.data.columns and new_name.strip():</span><br><span class="line">                valid_rename[old_name] = new_name.strip()</span><br><span class="line">        </span><br><span class="line">        if not valid_rename:</span><br><span class="line">            return False, &quot;æ²¡æœ‰æœ‰æ•ˆçš„é‡å‘½åæ˜ å°„&quot;</span><br><span class="line">        </span><br><span class="line">        self.data = self.data.rename(columns=valid_rename)</span><br><span class="line">        renamed = &#x27;, &#x27;.join([f&quot;&#123;k&#125; â†’ &#123;v&#125;&quot; for k, v in valid_rename.items()])</span><br><span class="line">        self.add_history(f&quot;é‡å‘½ååˆ—: &#123;renamed&#125;&quot;)</span><br><span class="line">        return True, f&quot;æˆåŠŸé‡å‘½å &#123;len(valid_rename)&#125; åˆ—&quot;</span><br><span class="line">    </span><br><span class="line">    def filter_data(self, condition):</span><br><span class="line">        &quot;&quot;&quot;è¿‡æ»¤æ•°æ®&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False, &quot;æ²¡æœ‰åŠ è½½æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            before = len(self.data)</span><br><span class="line">            </span><br><span class="line">            # å¤„ç†æ¡ä»¶å­—ç¬¦ä¸²</span><br><span class="line">            condition = condition.strip()</span><br><span class="line">            if not condition:</span><br><span class="line">                return False, &quot;è¿‡æ»¤æ¡ä»¶ä¸èƒ½ä¸ºç©º&quot;</span><br><span class="line">            </span><br><span class="line">            # ä½¿ç”¨evalè¿›è¡Œæ¡ä»¶è¿‡æ»¤</span><br><span class="line">            self.data = self.data.query(condition)</span><br><span class="line">            after = len(self.data)</span><br><span class="line">            </span><br><span class="line">            removed = before - after</span><br><span class="line">            self.add_history(f&quot;æ•°æ®è¿‡æ»¤: &#123;condition&#125; - ä» &#123;before&#125; è¡Œå‡å°‘åˆ° &#123;after&#125; è¡Œ&quot;)</span><br><span class="line">            </span><br><span class="line">            if removed &gt; 0:</span><br><span class="line">                return True, f&quot;è¿‡æ»¤åå‰©ä½™ &#123;after&#125; è¡Œï¼Œç§»é™¤äº† &#123;removed&#125; è¡Œ&quot;</span><br><span class="line">            else:</span><br><span class="line">                return True, &quot;æ²¡æœ‰æ•°æ®è¢«è¿‡æ»¤&quot;</span><br><span class="line">                </span><br><span class="line">        except Exception as e:</span><br><span class="line">            return False, f&quot;è¿‡æ»¤æ¡ä»¶é”™è¯¯: &#123;str(e)&#125;&quot;</span><br><span class="line">    </span><br><span class="line">    def drop_columns(self, columns):</span><br><span class="line">        &quot;&quot;&quot;åˆ é™¤åˆ—&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False, &quot;æ²¡æœ‰åŠ è½½æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        if isinstance(columns, str):</span><br><span class="line">            columns = [col.strip() for col in columns.split(&#x27;,&#x27;)]</span><br><span class="line">        </span><br><span class="line">        # åªåˆ é™¤å­˜åœ¨çš„åˆ—</span><br><span class="line">        existing_cols = [col for col in columns if col in self.data.columns]</span><br><span class="line">        </span><br><span class="line">        if not existing_cols:</span><br><span class="line">            return False, &quot;æ²¡æœ‰æ‰¾åˆ°è¦åˆ é™¤çš„åˆ—&quot;</span><br><span class="line">        </span><br><span class="line">        before = len(self.data.columns)</span><br><span class="line">        self.data = self.data.drop(columns=existing_cols, errors=&#x27;ignore&#x27;)</span><br><span class="line">        after = len(self.data.columns)</span><br><span class="line">        </span><br><span class="line">        removed = before - after</span><br><span class="line">        self.add_history(f&quot;åˆ é™¤åˆ—: &#123;&#x27;, &#x27;.join(existing_cols)&#125;&quot;)</span><br><span class="line">        return True, f&quot;æˆåŠŸåˆ é™¤ &#123;removed&#125; åˆ—&quot;</span><br><span class="line">    </span><br><span class="line">    def normalize_column(self, column, method=&#x27;minmax&#x27;):</span><br><span class="line">        &quot;&quot;&quot;æ ‡å‡†åŒ–/å½’ä¸€åŒ–æ•°å€¼åˆ—&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False, &quot;æ²¡æœ‰åŠ è½½æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        if column not in self.data.columns:</span><br><span class="line">            return False, f&quot;åˆ— &#x27;&#123;column&#125;&#x27; ä¸å­˜åœ¨&quot;</span><br><span class="line">        </span><br><span class="line">        if not pd.api.types.is_numeric_dtype(self.data[column]):</span><br><span class="line">            return False, f&quot;åˆ— &#x27;&#123;column&#125;&#x27; ä¸æ˜¯æ•°å€¼ç±»å‹&quot;</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            if method == &#x27;minmax&#x27;:</span><br><span class="line">                min_val = self.data[column].min()</span><br><span class="line">                max_val = self.data[column].max()</span><br><span class="line">                if max_val != min_val:</span><br><span class="line">                    self.data[column] = (self.data[column] - min_val) / (max_val - min_val)</span><br><span class="line">                else:</span><br><span class="line">                    self.data[column] = 0</span><br><span class="line">                    </span><br><span class="line">            elif method == &#x27;zscore&#x27;:</span><br><span class="line">                mean_val = self.data[column].mean()</span><br><span class="line">                std_val = self.data[column].std()</span><br><span class="line">                if std_val != 0:</span><br><span class="line">                    self.data[column] = (self.data[column] - mean_val) / std_val</span><br><span class="line">                else:</span><br><span class="line">                    self.data[column] = 0</span><br><span class="line">            </span><br><span class="line">            elif method == &#x27;log&#x27;:</span><br><span class="line">                # å¤„ç†é›¶å’Œè´Ÿå€¼</span><br><span class="line">                if (self.data[column] &lt;= 0).any():</span><br><span class="line">                    # å°†æ‰€æœ‰å€¼åŠ ä¸Šæœ€å°å€¼+1çš„ç»å¯¹å€¼ï¼Œç¡®ä¿ä¸ºæ­£</span><br><span class="line">                    min_val = self.data[column].min()</span><br><span class="line">                    if min_val &lt;= 0:</span><br><span class="line">                        shift = abs(min_val) + 1</span><br><span class="line">                        self.data[column] = np.log(self.data[column] + shift)</span><br><span class="line">                else:</span><br><span class="line">                    self.data[column] = np.log(self.data[column])</span><br><span class="line">            </span><br><span class="line">            self.add_history(f&quot;æ ‡å‡†åŒ–åˆ—: &#123;column&#125; ä½¿ç”¨ &#123;method&#125;&quot;)</span><br><span class="line">            return True, f&quot;æˆåŠŸå¯¹åˆ— &#x27;&#123;column&#125;&#x27; è¿›è¡Œ &#123;method&#125; æ ‡å‡†åŒ–&quot;</span><br><span class="line">            </span><br><span class="line">        except Exception as e:</span><br><span class="line">            return False, f&quot;æ ‡å‡†åŒ–å¤±è´¥: &#123;str(e)&#125;&quot;</span><br><span class="line">    </span><br><span class="line">    def handle_outliers(self, column, method=&#x27;iqr&#x27;, threshold=1.5):</span><br><span class="line">        &quot;&quot;&quot;å¤„ç†å¼‚å¸¸å€¼&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False, &quot;æ²¡æœ‰åŠ è½½æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        if column not in self.data.columns:</span><br><span class="line">            return False, f&quot;åˆ— &#x27;&#123;column&#125;&#x27; ä¸å­˜åœ¨&quot;</span><br><span class="line">        </span><br><span class="line">        if not pd.api.types.is_numeric_dtype(self.data[column]):</span><br><span class="line">            return False, f&quot;åˆ— &#x27;&#123;column&#125;&#x27; ä¸æ˜¯æ•°å€¼ç±»å‹&quot;</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            if method == &#x27;iqr&#x27;:</span><br><span class="line">                Q1 = self.data[column].quantile(0.25)</span><br><span class="line">                Q3 = self.data[column].quantile(0.75)</span><br><span class="line">                IQR = Q3 - Q1</span><br><span class="line">                lower_bound = Q1 - threshold * IQR</span><br><span class="line">                upper_bound = Q3 + threshold * IQR</span><br><span class="line">                </span><br><span class="line">                # æ£€æµ‹å¼‚å¸¸å€¼æ•°é‡</span><br><span class="line">                outliers = ((self.data[column] &lt; lower_bound) | (self.data[column] &gt; upper_bound)).sum()</span><br><span class="line">                </span><br><span class="line">                # æ›¿æ¢ä¸ºè¾¹ç•Œå€¼</span><br><span class="line">                self.data[column] = self.data[column].clip(lower_bound, upper_bound)</span><br><span class="line">                </span><br><span class="line">                message = f&quot;æ£€æµ‹åˆ° &#123;outliers&#125; ä¸ªå¼‚å¸¸å€¼ï¼Œå·²ä½¿ç”¨IQRæ–¹æ³•å¤„ç†&quot;</span><br><span class="line">                </span><br><span class="line">            elif method == &#x27;zscore&#x27;:</span><br><span class="line">                mean_val = self.data[column].mean()</span><br><span class="line">                std_val = self.data[column].std()</span><br><span class="line">                z_scores = np.abs((self.data[column] - mean_val) / std_val)</span><br><span class="line">                </span><br><span class="line">                # æ£€æµ‹å¼‚å¸¸å€¼æ•°é‡</span><br><span class="line">                outliers = (z_scores &gt; threshold).sum()</span><br><span class="line">                </span><br><span class="line">                # æ›¿æ¢å¼‚å¸¸å€¼ä¸ºå‡å€¼</span><br><span class="line">                self.data.loc[z_scores &gt; threshold, column] = mean_val</span><br><span class="line">                </span><br><span class="line">                message = f&quot;æ£€æµ‹åˆ° &#123;outliers&#125; ä¸ªå¼‚å¸¸å€¼ï¼Œå·²ä½¿ç”¨Z-Scoreæ–¹æ³•å¤„ç†&quot;</span><br><span class="line">            </span><br><span class="line">            elif method == &#x27;remove&#x27;:</span><br><span class="line">                Q1 = self.data[column].quantile(0.25)</span><br><span class="line">                Q3 = self.data[column].quantile(0.75)</span><br><span class="line">                IQR = Q3 - Q1</span><br><span class="line">                lower_bound = Q1 - threshold * IQR</span><br><span class="line">                upper_bound = Q3 + threshold * IQR</span><br><span class="line">                </span><br><span class="line">                before = len(self.data)</span><br><span class="line">                self.data = self.data[(self.data[column] &gt;= lower_bound) &amp; (self.data[column] &lt;= upper_bound)]</span><br><span class="line">                after = len(self.data)</span><br><span class="line">                </span><br><span class="line">                outliers = before - after</span><br><span class="line">                message = f&quot;æ£€æµ‹åˆ°å¹¶ç§»é™¤äº† &#123;outliers&#125; ä¸ªå¼‚å¸¸å€¼&quot;</span><br><span class="line">            </span><br><span class="line">            self.add_history(f&quot;å¤„ç†å¼‚å¸¸å€¼: &#123;column&#125; ä½¿ç”¨ &#123;method&#125;&quot;)</span><br><span class="line">            return True, message</span><br><span class="line">            </span><br><span class="line">        except Exception as e:</span><br><span class="line">            return False, f&quot;å¼‚å¸¸å€¼å¤„ç†å¤±è´¥: &#123;str(e)&#125;&quot;</span><br><span class="line">    </span><br><span class="line">    def encode_categorical(self, column, method=&#x27;onehot&#x27;):</span><br><span class="line">        &quot;&quot;&quot;ç¼–ç åˆ†ç±»å˜é‡&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False, &quot;æ²¡æœ‰åŠ è½½æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        if column not in self.data.columns:</span><br><span class="line">            return False, f&quot;åˆ— &#x27;&#123;column&#125;&#x27; ä¸å­˜åœ¨&quot;</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            if method == &#x27;onehot&#x27;:</span><br><span class="line">                # è·å–å”¯ä¸€å€¼æ•°é‡</span><br><span class="line">                unique_count = self.data[column].nunique()</span><br><span class="line">                </span><br><span class="line">                if unique_count &gt; 20:</span><br><span class="line">                    return False, f&quot;åˆ— &#x27;&#123;column&#125;&#x27; æœ‰ &#123;unique_count&#125; ä¸ªå”¯ä¸€å€¼ï¼ŒOne-Hotç¼–ç å¯èƒ½äº§ç”Ÿå¤ªå¤šåˆ—&quot;</span><br><span class="line">                </span><br><span class="line">                dummies = pd.get_dummies(self.data[column], prefix=column)</span><br><span class="line">                self.data = pd.concat([self.data, dummies], axis=1)</span><br><span class="line">                message = f&quot;æˆåŠŸè¿›è¡ŒOne-Hotç¼–ç ï¼Œæ–°å¢ &#123;len(dummies.columns)&#125; åˆ—&quot;</span><br><span class="line">                </span><br><span class="line">            elif method == &#x27;label&#x27;:</span><br><span class="line">                from sklearn.preprocessing import LabelEncoder</span><br><span class="line">                le = LabelEncoder()</span><br><span class="line">                self.data[column + &#x27;_encoded&#x27;] = le.fit_transform(self.data[column])</span><br><span class="line">                message = f&quot;æˆåŠŸè¿›è¡ŒLabelç¼–ç ï¼Œæ–°å¢åˆ— &#x27;&#123;column&#125;_encoded&#x27;&quot;</span><br><span class="line">            </span><br><span class="line">            elif method == &#x27;frequency&#x27;:</span><br><span class="line">                # é¢‘ç‡ç¼–ç </span><br><span class="line">                freq_encoding = self.data[column].value_counts(normalize=True)</span><br><span class="line">                self.data[column + &#x27;_freq&#x27;] = self.data[column].map(freq_encoding)</span><br><span class="line">                message = f&quot;æˆåŠŸè¿›è¡Œé¢‘ç‡ç¼–ç ï¼Œæ–°å¢åˆ— &#x27;&#123;column&#125;_freq&#x27;&quot;</span><br><span class="line">            </span><br><span class="line">            self.add_history(f&quot;ç¼–ç åˆ†ç±»å˜é‡: &#123;column&#125; ä½¿ç”¨ &#123;method&#125;&quot;)</span><br><span class="line">            return True, message</span><br><span class="line">            </span><br><span class="line">        except Exception as e:</span><br><span class="line">            return False, f&quot;ç¼–ç å¤±è´¥: &#123;str(e)&#125;&quot;</span><br><span class="line">    </span><br><span class="line">    def extract_datetime_features(self, column):</span><br><span class="line">        &quot;&quot;&quot;ä»æ—¥æœŸæ—¶é—´åˆ—æå–ç‰¹å¾&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return False, &quot;æ²¡æœ‰åŠ è½½æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        if column not in self.data.columns:</span><br><span class="line">            return False, f&quot;åˆ— &#x27;&#123;column&#125;&#x27; ä¸å­˜åœ¨&quot;</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            # å°è¯•è½¬æ¢ä¸ºdatetime</span><br><span class="line">            self.data[column] = pd.to_datetime(self.data[column], errors=&#x27;coerce&#x27;)</span><br><span class="line">            </span><br><span class="line">            # æå–ç‰¹å¾</span><br><span class="line">            features_added = []</span><br><span class="line">            </span><br><span class="line">            if self.data[column].dt.year.notnull().any():</span><br><span class="line">                self.data[f&#x27;&#123;column&#125;_year&#x27;] = self.data[column].dt.year</span><br><span class="line">                features_added.append(&#x27;year&#x27;)</span><br><span class="line">            </span><br><span class="line">            if self.data[column].dt.month.notnull().any():</span><br><span class="line">                self.data[f&#x27;&#123;column&#125;_month&#x27;] = self.data[column].dt.month</span><br><span class="line">                features_added.append(&#x27;month&#x27;)</span><br><span class="line">            </span><br><span class="line">            if self.data[column].dt.day.notnull().any():</span><br><span class="line">                self.data[f&#x27;&#123;column&#125;_day&#x27;] = self.data[column].dt.day</span><br><span class="line">                features_added.append(&#x27;day&#x27;)</span><br><span class="line">            </span><br><span class="line">            if self.data[column].dt.weekday.notnull().any():</span><br><span class="line">                self.data[f&#x27;&#123;column&#125;_weekday&#x27;] = self.data[column].dt.weekday</span><br><span class="line">                features_added.append(&#x27;weekday&#x27;)</span><br><span class="line">            </span><br><span class="line">            if self.data[column].dt.hour.notnull().any():</span><br><span class="line">                self.data[f&#x27;&#123;column&#125;_hour&#x27;] = self.data[column].dt.hour</span><br><span class="line">                features_added.append(&#x27;hour&#x27;)</span><br><span class="line">            </span><br><span class="line">            if self.data[column].dt.quarter.notnull().any():</span><br><span class="line">                self.data[f&#x27;&#123;column&#125;_quarter&#x27;] = self.data[column].dt.quarter</span><br><span class="line">                features_added.append(&#x27;quarter&#x27;)</span><br><span class="line">            </span><br><span class="line">            self.add_history(f&quot;æå–æ—¥æœŸç‰¹å¾: &#123;column&#125;&quot;)</span><br><span class="line">            return True, f&quot;æˆåŠŸæå– &#123;len(features_added)&#125; ä¸ªæ—¥æœŸç‰¹å¾: &#123;&#x27;, &#x27;.join(features_added)&#125;&quot;</span><br><span class="line">            </span><br><span class="line">        except Exception as e:</span><br><span class="line">            return False, f&quot;æ—¥æœŸç‰¹å¾æå–å¤±è´¥: &#123;str(e)&#125;&quot;</span><br><span class="line">    </span><br><span class="line">    def add_history(self, action):</span><br><span class="line">        &quot;&quot;&quot;è®°å½•æ“ä½œå†å²&quot;&quot;&quot;</span><br><span class="line">        self.history.append(&#123;</span><br><span class="line">            &#x27;timestamp&#x27;: datetime.now().strftime(&quot;%Y-%m-%d %H:%M:%S&quot;),</span><br><span class="line">            &#x27;action&#x27;: action,</span><br><span class="line">            &#x27;shape&#x27;: self.data.shape if self.data is not None else None</span><br><span class="line">        &#125;)</span><br><span class="line">    </span><br><span class="line">    def undo(self):</span><br><span class="line">        &quot;&quot;&quot;æ’¤é”€ä¸Šä¸€æ­¥æ“ä½œ&quot;&quot;&quot;</span><br><span class="line">        if len(self.history) &gt; 1 and self.original_data is not None:</span><br><span class="line">            # ç®€å•å®ç°ï¼šé‡æ–°åŠ è½½åŸå§‹æ•°æ®ï¼Œç„¶åé‡æ–°åº”ç”¨é™¤æœ€åä¸€æ­¥å¤–çš„æ‰€æœ‰æ“ä½œ</span><br><span class="line">            last_action = self.history.pop()</span><br><span class="line">            self.data = self.original_data.copy()</span><br><span class="line">            </span><br><span class="line">            # é‡æ–°åº”ç”¨å†å²æ“ä½œï¼ˆé™¤æœ€åä¸€æ­¥å¤–ï¼‰</span><br><span class="line">            for i in range(1, len(self.history)):</span><br><span class="line">                # è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…åº”è¯¥é‡æ–°æ‰§è¡Œæ¯ä¸ªæ“ä½œ</span><br><span class="line">                pass</span><br><span class="line">            </span><br><span class="line">            return True, f&quot;å·²æ’¤é”€: &#123;last_action[&#x27;action&#x27;]&#125;&quot;</span><br><span class="line">        else:</span><br><span class="line">            return False, &quot;æ— æ³•æ’¤é”€&quot;</span><br><span class="line">    </span><br><span class="line">    def generate_report(self):</span><br><span class="line">        &quot;&quot;&quot;ç”Ÿæˆæ•°æ®æ¸…æ´—æŠ¥å‘Š&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return &quot;æ²¡æœ‰å¯ç”¨çš„æ•°æ®&quot;</span><br><span class="line">        </span><br><span class="line">        report_lines = []</span><br><span class="line">        report_lines.append(&quot;=&quot; * 80)</span><br><span class="line">        report_lines.append(&quot;æ•°æ®æ¸…æ´—æŠ¥å‘Š&quot;)</span><br><span class="line">        report_lines.append(&quot;=&quot; * 80)</span><br><span class="line">        report_lines.append(f&quot;ç”Ÿæˆæ—¶é—´: &#123;datetime.now().strftime(&#x27;%Y-%m-%d %H:%M:%S&#x27;)&#125;&quot;)</span><br><span class="line">        report_lines.append(f&quot;æ–‡ä»¶: &#123;self.file_info.get(&#x27;filename&#x27;, &#x27;æœªçŸ¥&#x27;)&#125;&quot;)</span><br><span class="line">        report_lines.append(f&quot;æ•°æ®å½¢çŠ¶: &#123;self.data.shape[0]&#125; è¡Œ Ã— &#123;self.data.shape[1]&#125; åˆ—&quot;)</span><br><span class="line">        report_lines.append(f&quot;åŸå§‹æ•°æ®: &#123;self.original_data.shape[0]&#125; è¡Œ Ã— &#123;self.original_data.shape[1]&#125; åˆ—&quot;)</span><br><span class="line">        report_lines.append(&quot;&quot;)</span><br><span class="line">        </span><br><span class="line">        # åˆ—ä¿¡æ¯</span><br><span class="line">        report_lines.append(&quot;åˆ—ä¿¡æ¯:&quot;)</span><br><span class="line">        report_lines.append(&quot;-&quot; * 80)</span><br><span class="line">        for col in self.data.columns:</span><br><span class="line">            dtype = self.data[col].dtype</span><br><span class="line">            null_count = self.data[col].isnull().sum()</span><br><span class="line">            null_pct = (null_count / len(self.data)) * 100</span><br><span class="line">            unique_count = self.data[col].nunique()</span><br><span class="line">            report_lines.append(f&quot;  &#123;col:30s&#125; | &#123;str(dtype):15s&#125; | ç©ºå€¼: &#123;null_count:4d&#125; (&#123;null_pct:5.1f&#125;%) | å”¯ä¸€å€¼: &#123;unique_count:4d&#125;&quot;)</span><br><span class="line">        </span><br><span class="line">        report_lines.append(&quot;&quot;)</span><br><span class="line">        report_lines.append(&quot;æ“ä½œå†å²:&quot;)</span><br><span class="line">        report_lines.append(&quot;-&quot; * 80)</span><br><span class="line">        for i, record in enumerate(self.history, 1):</span><br><span class="line">            shape_info = f&quot; [&#123;record[&#x27;shape&#x27;][0]&#125;Ã—&#123;record[&#x27;shape&#x27;][1]&#125;]&quot; if record[&#x27;shape&#x27;] else &quot;&quot;</span><br><span class="line">            report_lines.append(f&quot;  &#123;i:2d&#125;. [&#123;record[&#x27;timestamp&#x27;]&#125;]&#123;shape_info&#125; &#123;record[&#x27;action&#x27;]&#125;&quot;)</span><br><span class="line">        </span><br><span class="line">        return &quot;\n&quot;.join(report_lines)</span><br><span class="line">    </span><br><span class="line">    def save_to_bytes(self, format=&#x27;csv&#x27;):</span><br><span class="line">        &quot;&quot;&quot;å°†æ•°æ®ä¿å­˜ä¸ºå­—èŠ‚æµ&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return None</span><br><span class="line">        </span><br><span class="line">        buffer = io.BytesIO()</span><br><span class="line">        </span><br><span class="line">        try:</span><br><span class="line">            if format == &#x27;csv&#x27;:</span><br><span class="line">                self.data.to_csv(buffer, index=False, encoding=&#x27;utf-8&#x27;)</span><br><span class="line">                content_type = &#x27;text/csv&#x27;</span><br><span class="line">                filename = f&quot;cleaned_data_&#123;datetime.now().strftime(&#x27;%Y%m%d_%H%M%S&#x27;)&#125;.csv&quot;</span><br><span class="line">                </span><br><span class="line">            elif format == &#x27;excel&#x27;:</span><br><span class="line">                with pd.ExcelWriter(buffer, engine=&#x27;openpyxl&#x27;) as writer:</span><br><span class="line">                    self.data.to_excel(writer, index=False, sheet_name=&#x27;Data&#x27;)</span><br><span class="line">                content_type = &#x27;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#x27;</span><br><span class="line">                filename = f&quot;cleaned_data_&#123;datetime.now().strftime(&#x27;%Y%m%d_%H%M%S&#x27;)&#125;.xlsx&quot;</span><br><span class="line">                </span><br><span class="line">            elif format == &#x27;json&#x27;:</span><br><span class="line">                self.data.to_json(buffer, orient=&#x27;records&#x27;, indent=2)</span><br><span class="line">                content_type = &#x27;application/json&#x27;</span><br><span class="line">                filename = f&quot;cleaned_data_&#123;datetime.now().strftime(&#x27;%Y%m%d_%H%M%S&#x27;)&#125;.json&quot;</span><br><span class="line">            </span><br><span class="line">            buffer.seek(0)</span><br><span class="line">            return buffer, content_type, filename</span><br><span class="line">            </span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(f&quot;ä¿å­˜æ•°æ®å¤±è´¥: &#123;e&#125;&quot;)</span><br><span class="line">            return None</span><br><span class="line">    </span><br><span class="line">    def get_sample_data(self, n=100):</span><br><span class="line">        &quot;&quot;&quot;è·å–æ•°æ®æ ·æœ¬ç”¨äºé¢„è§ˆ&quot;&quot;&quot;</span><br><span class="line">        if self.data is None:</span><br><span class="line">            return None</span><br><span class="line">        </span><br><span class="line">        sample = self.data.head(n)</span><br><span class="line">        return sample.to_dict(&#x27;records&#x27;)</span><br><span class="line">    </span><br><span class="line">    def get_column_stats(self, column):</span><br><span class="line">        &quot;&quot;&quot;è·å–åˆ—çš„ç»Ÿè®¡ä¿¡æ¯&quot;&quot;&quot;</span><br><span class="line">        if self.data is None or column not in self.data.columns:</span><br><span class="line">            return None</span><br><span class="line">        </span><br><span class="line">        col_data = self.data[column]</span><br><span class="line">        stats = &#123;</span><br><span class="line">            &#x27;name&#x27;: column,</span><br><span class="line">            &#x27;dtype&#x27;: str(col_data.dtype),</span><br><span class="line">            &#x27;count&#x27;: int(col_data.count()),</span><br><span class="line">            &#x27;null_count&#x27;: int(col_data.isnull().sum()),</span><br><span class="line">            &#x27;null_percentage&#x27;: float((col_data.isnull().sum() / len(col_data)) * 100),</span><br><span class="line">            &#x27;unique_count&#x27;: int(col_data.nunique())</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        if pd.api.types.is_numeric_dtype(col_data):</span><br><span class="line">            stats.update(&#123;</span><br><span class="line">                &#x27;min&#x27;: float(col_data.min()) if not col_data.isnull().all() else None,</span><br><span class="line">                &#x27;max&#x27;: float(col_data.max()) if not col_data.isnull().all() else None,</span><br><span class="line">                &#x27;mean&#x27;: float(col_data.mean()) if not col_data.isnull().all() else None,</span><br><span class="line">                &#x27;median&#x27;: float(col_data.median()) if not col_data.isnull().all() else None,</span><br><span class="line">                &#x27;std&#x27;: float(col_data.std()) if not col_data.isnull().all() else None,</span><br><span class="line">                &#x27;q1&#x27;: float(col_data.quantile(0.25)) if not col_data.isnull().all() else None,</span><br><span class="line">                &#x27;q3&#x27;: float(col_data.quantile(0.75)) if not col_data.isnull().all() else None,</span><br><span class="line">                &#x27;type&#x27;: &#x27;numeric&#x27;</span><br><span class="line">            &#125;)</span><br><span class="line">        elif pd.api.types.is_datetime64_any_dtype(col_data):</span><br><span class="line">            stats.update(&#123;</span><br><span class="line">                &#x27;min&#x27;: col_data.min().strftime(&#x27;%Y-%m-%d %H:%M:%S&#x27;) if not col_data.isnull().all() else None,</span><br><span class="line">                &#x27;max&#x27;: col_data.max().strftime(&#x27;%Y-%m-%d %H:%M:%S&#x27;) if not col_data.isnull().all() else None,</span><br><span class="line">                &#x27;type&#x27;: &#x27;datetime&#x27;</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            # æ–‡æœ¬æˆ–åˆ†ç±»åˆ—</span><br><span class="line">            top_values = col_data.value_counts().head(10).to_dict()</span><br><span class="line">            stats.update(&#123;</span><br><span class="line">                &#x27;top_values&#x27;: top_values,</span><br><span class="line">                &#x27;type&#x27;: &#x27;categorical&#x27;</span><br><span class="line">            &#125;)</span><br><span class="line">        </span><br><span class="line">        return stats</span><br><span class="line"></span><br><span class="line"># å…¨å±€æ•°æ®æ¸…æ´—å™¨å®ä¾‹</span><br><span class="line">cleaner = DataCleaner()</span><br><span class="line"></span><br><span class="line"># HTMLæ¨¡æ¿ (åµŒå…¥åœ¨Pythonæ–‡ä»¶ä¸­ä»¥ç®€åŒ–éƒ¨ç½²)</span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def index():</span><br><span class="line">    &quot;&quot;&quot;ä¸»é¡µ&quot;&quot;&quot;</span><br><span class="line">    html = &#x27;&#x27;&#x27;</span><br><span class="line">    &lt;!DOCTYPE html&gt;</span><br><span class="line">    &lt;html lang=&quot;zh-CN&quot;&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">        &lt;title&gt;æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·&lt;/title&gt;</span><br><span class="line">        &lt;link href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;</span><br><span class="line">        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css&quot;&gt;</span><br><span class="line">        &lt;style&gt;</span><br><span class="line">            :root &#123;</span><br><span class="line">                --primary-color: #4361ee;</span><br><span class="line">                --secondary-color: #3a0ca3;</span><br><span class="line">                --success-color: #4cc9f0;</span><br><span class="line">                --light-color: #f8f9fa;</span><br><span class="line">                --dark-color: #212529;</span><br><span class="line">            &#125;</span><br><span class="line">            body &#123;</span><br><span class="line">                background-color: #f5f7fb;</span><br><span class="line">                font-family: &#x27;Segoe UI&#x27;, Tahoma, Geneva, Verdana, sans-serif;</span><br><span class="line">            &#125;</span><br><span class="line">            .navbar-brand &#123;</span><br><span class="line">                font-weight: 700;</span><br><span class="line">                color: var(--primary-color) !important;</span><br><span class="line">            &#125;</span><br><span class="line">            .card &#123;</span><br><span class="line">                border-radius: 15px;</span><br><span class="line">                border: none;</span><br><span class="line">                box-shadow: 0 5px 15px rgba(0,0,0,0.08);</span><br><span class="line">                transition: transform 0.3s;</span><br><span class="line">            &#125;</span><br><span class="line">            .card:hover &#123;</span><br><span class="line">                transform: translateY(-5px);</span><br><span class="line">            &#125;</span><br><span class="line">            .btn-primary &#123;</span><br><span class="line">                background-color: var(--primary-color);</span><br><span class="line">                border-color: var(--primary-color);</span><br><span class="line">            &#125;</span><br><span class="line">            .btn-primary:hover &#123;</span><br><span class="line">                background-color: var(--secondary-color);</span><br><span class="line">                border-color: var(--secondary-color);</span><br><span class="line">            &#125;</span><br><span class="line">            .sidebar &#123;</span><br><span class="line">                background: white;</span><br><span class="line">                border-radius: 15px;</span><br><span class="line">                padding: 20px;</span><br><span class="line">                height: fit-content;</span><br><span class="line">                position: sticky;</span><br><span class="line">                top: 20px;</span><br><span class="line">            &#125;</span><br><span class="line">            .operation-card &#123;</span><br><span class="line">                cursor: pointer;</span><br><span class="line">                transition: all 0.3s;</span><br><span class="line">                border-left: 4px solid transparent;</span><br><span class="line">            &#125;</span><br><span class="line">            .operation-card:hover &#123;</span><br><span class="line">                background-color: #f0f5ff;</span><br><span class="line">                border-left-color: var(--primary-color);</span><br><span class="line">            &#125;</span><br><span class="line">            .data-table-container &#123;</span><br><span class="line">                max-height: 500px;</span><br><span class="line">                overflow-y: auto;</span><br><span class="line">                border-radius: 10px;</span><br><span class="line">                border: 1px solid #dee2e6;</span><br><span class="line">            &#125;</span><br><span class="line">            .history-item &#123;</span><br><span class="line">                padding: 8px 12px;</span><br><span class="line">                margin-bottom: 5px;</span><br><span class="line">                background-color: #f8f9fa;</span><br><span class="line">                border-radius: 8px;</span><br><span class="line">                border-left: 4px solid var(--primary-color);</span><br><span class="line">                font-size: 0.9rem;</span><br><span class="line">            &#125;</span><br><span class="line">            .status-badge &#123;</span><br><span class="line">                font-size: 0.75rem;</span><br><span class="line">                padding: 3px 8px;</span><br><span class="line">                border-radius: 10px;</span><br><span class="line">            &#125;</span><br><span class="line">            .modal-header &#123;</span><br><span class="line">                background-color: var(--primary-color);</span><br><span class="line">                color: white;</span><br><span class="line">                border-radius: 0;</span><br><span class="line">            &#125;</span><br><span class="line">            .step-indicator &#123;</span><br><span class="line">                display: flex;</span><br><span class="line">                justify-content: space-between;</span><br><span class="line">                margin-bottom: 30px;</span><br><span class="line">                position: relative;</span><br><span class="line">            &#125;</span><br><span class="line">            .step-indicator::before &#123;</span><br><span class="line">                content: &#x27;&#x27;;</span><br><span class="line">                position: absolute;</span><br><span class="line">                top: 20px;</span><br><span class="line">                left: 0;</span><br><span class="line">                right: 0;</span><br><span class="line">                height: 2px;</span><br><span class="line">                background-color: #e0e0e0;</span><br><span class="line">                z-index: 1;</span><br><span class="line">            &#125;</span><br><span class="line">            .step &#123;</span><br><span class="line">                position: relative;</span><br><span class="line">                z-index: 2;</span><br><span class="line">                text-align: center;</span><br><span class="line">                width: 100px;</span><br><span class="line">            &#125;</span><br><span class="line">            .step-circle &#123;</span><br><span class="line">                width: 40px;</span><br><span class="line">                height: 40px;</span><br><span class="line">                border-radius: 50%;</span><br><span class="line">                background-color: #e0e0e0;</span><br><span class="line">                color: #666;</span><br><span class="line">                display: flex;</span><br><span class="line">                align-items: center;</span><br><span class="line">                justify-content: center;</span><br><span class="line">                font-weight: bold;</span><br><span class="line">                margin: 0 auto 10px;</span><br><span class="line">                border: 3px solid white;</span><br><span class="line">            &#125;</span><br><span class="line">            .step.active .step-circle &#123;</span><br><span class="line">                background-color: var(--primary-color);</span><br><span class="line">                color: white;</span><br><span class="line">            &#125;</span><br><span class="line">            .step.completed .step-circle &#123;</span><br><span class="line">                background-color: var(--success-color);</span><br><span class="line">                color: white;</span><br><span class="line">            &#125;</span><br><span class="line">            .step-label &#123;</span><br><span class="line">                font-size: 0.85rem;</span><br><span class="line">                color: #666;</span><br><span class="line">            &#125;</span><br><span class="line">            .step.active .step-label &#123;</span><br><span class="line">                color: var(--primary-color);</span><br><span class="line">                font-weight: bold;</span><br><span class="line">            &#125;</span><br><span class="line">        &lt;/style&gt;</span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;!-- å¯¼èˆªæ  --&gt;</span><br><span class="line">        &lt;nav class=&quot;navbar navbar-expand-lg navbar-light bg-white shadow-sm&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">                &lt;a class=&quot;navbar-brand&quot; href=&quot;#&quot;&gt;</span><br><span class="line">                    &lt;i class=&quot;bi bi-database-gear me-2&quot;&gt;&lt;/i&gt;æ•°æ®æ¸…æ´—å¤„ç†å·¥å…·</span><br><span class="line">                &lt;/a&gt;</span><br><span class="line">                &lt;div class=&quot;d-flex align-items-center&quot;&gt;</span><br><span class="line">                    &lt;span class=&quot;badge bg-primary me-3&quot; id=&quot;data-status&quot;&gt;æœªåŠ è½½æ•°æ®&lt;/span&gt;</span><br><span class="line">                    &lt;button class=&quot;btn btn-outline-primary btn-sm&quot; onclick=&quot;location.reload()&quot;&gt;</span><br><span class="line">                        &lt;i class=&quot;bi bi-arrow-clockwise&quot;&gt;&lt;/i&gt; é‡ç½®</span><br><span class="line">                    &lt;/button&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/nav&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- ä¸»å†…å®¹ --&gt;</span><br><span class="line">        &lt;div class=&quot;container mt-4&quot;&gt;</span><br><span class="line">            &lt;!-- æ­¥éª¤æŒ‡ç¤ºå™¨ --&gt;</span><br><span class="line">            &lt;div class=&quot;step-indicator&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;step active&quot; id=&quot;step1&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;step-circle&quot;&gt;1&lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;step-label&quot;&gt;ä¸Šä¼ æ•°æ®&lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;step&quot; id=&quot;step2&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;step-circle&quot;&gt;2&lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;step-label&quot;&gt;æ•°æ®æ¢ç´¢&lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;step&quot; id=&quot;step3&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;step-circle&quot;&gt;3&lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;step-label&quot;&gt;æ•°æ®æ¸…æ´—&lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;step&quot; id=&quot;step4&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;step-circle&quot;&gt;4&lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;step-label&quot;&gt;å¯¼å‡ºæ•°æ®&lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">            &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">                &lt;!-- å·¦ä¾§è¾¹æ  --&gt;</span><br><span class="line">                &lt;div class=&quot;col-lg-3&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;sidebar shadow-sm mb-4&quot;&gt;</span><br><span class="line">                        &lt;h5 class=&quot;mb-3&quot;&gt;&lt;i class=&quot;bi bi-menu-button me-2&quot;&gt;&lt;/i&gt;æ“ä½œèœå•&lt;/h5&gt;</span><br><span class="line">                        </span><br><span class="line">                        &lt;div class=&quot;mb-4&quot;&gt;</span><br><span class="line">                            &lt;h6 class=&quot;text-muted mb-2&quot;&gt;&lt;i class=&quot;bi bi-cloud-upload me-2&quot;&gt;&lt;/i&gt;æ•°æ®åŠ è½½&lt;/h6&gt;</span><br><span class="line">                            &lt;button class=&quot;btn btn-outline-primary w-100 mb-2&quot; onclick=&quot;showUploadModal()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-upload me-2&quot;&gt;&lt;/i&gt;ä¸Šä¼ æ•°æ®</span><br><span class="line">                            &lt;/button&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        </span><br><span class="line">                        &lt;div class=&quot;mb-4&quot;&gt;</span><br><span class="line">                            &lt;h6 class=&quot;text-muted mb-2&quot;&gt;&lt;i class=&quot;bi bi-bar-chart me-2&quot;&gt;&lt;/i&gt;æ•°æ®æ¢ç´¢&lt;/h6&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3 mb-2&quot; onclick=&quot;showDataInfo()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-info-circle me-2&quot;&gt;&lt;/i&gt;æŸ¥çœ‹æ•°æ®ä¿¡æ¯</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3 mb-2&quot; onclick=&quot;showColumnAnalysis()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-graph-up me-2&quot;&gt;&lt;/i&gt;åˆ—åˆ†æ</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3&quot; onclick=&quot;showMissingAnalysis()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-question-circle me-2&quot;&gt;&lt;/i&gt;ç¼ºå¤±å€¼åˆ†æ</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        </span><br><span class="line">                        &lt;div class=&quot;mb-4&quot;&gt;</span><br><span class="line">                            &lt;h6 class=&quot;text-muted mb-2&quot;&gt;&lt;i class=&quot;bi bi-brush me-2&quot;&gt;&lt;/i&gt;æ•°æ®æ¸…æ´—&lt;/h6&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3 mb-2&quot; onclick=&quot;showMissingModal()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-dash-circle me-2&quot;&gt;&lt;/i&gt;å¤„ç†ç¼ºå¤±å€¼</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3 mb-2&quot; onclick=&quot;showDedupModal()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-files me-2&quot;&gt;&lt;/i&gt;å»é™¤é‡å¤</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3 mb-2&quot; onclick=&quot;showRenameModal()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-fonts me-2&quot;&gt;&lt;/i&gt;é‡å‘½ååˆ—</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3 mb-2&quot; onclick=&quot;showTypeModal()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-type me-2&quot;&gt;&lt;/i&gt;æ›´æ”¹æ•°æ®ç±»å‹</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3 mb-2&quot; onclick=&quot;showFilterModal()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-funnel me-2&quot;&gt;&lt;/i&gt;æ•°æ®è¿‡æ»¤</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3 mb-2&quot; onclick=&quot;showDropModal()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-trash me-2&quot;&gt;&lt;/i&gt;åˆ é™¤åˆ—</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3 mb-2&quot; onclick=&quot;showNormalizeModal()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-sliders me-2&quot;&gt;&lt;/i&gt;æ•°æ®æ ‡å‡†åŒ–</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3 mb-2&quot; onclick=&quot;showOutlierModal()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-exclamation-triangle me-2&quot;&gt;&lt;/i&gt;å¤„ç†å¼‚å¸¸å€¼</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3 mb-2&quot; onclick=&quot;showEncodeModal()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-code me-2&quot;&gt;&lt;/i&gt;ç¼–ç åˆ†ç±»å˜é‡</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;operation-card p-3&quot; onclick=&quot;showDateModal()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-calendar me-2&quot;&gt;&lt;/i&gt;æå–æ—¥æœŸç‰¹å¾</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        </span><br><span class="line">                        &lt;div class=&quot;mb-4&quot;&gt;</span><br><span class="line">                            &lt;h6 class=&quot;text-muted mb-2&quot;&gt;&lt;i class=&quot;bi bi-download me-2&quot;&gt;&lt;/i&gt;å¯¼å‡ºæ•°æ®&lt;/h6&gt;</span><br><span class="line">                            &lt;button class=&quot;btn btn-success w-100 mb-2&quot; onclick=&quot;exportData(&#x27;csv&#x27;)&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-file-earmark-spreadsheet me-2&quot;&gt;&lt;/i&gt;å¯¼å‡ºCSV</span><br><span class="line">                            &lt;/button&gt;</span><br><span class="line">                            &lt;button class=&quot;btn btn-success w-100 mb-2&quot; onclick=&quot;exportData(&#x27;excel&#x27;)&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-file-earmark-excel me-2&quot;&gt;&lt;/i&gt;å¯¼å‡ºExcel</span><br><span class="line">                            &lt;/button&gt;</span><br><span class="line">                            &lt;button class=&quot;btn btn-success w-100&quot; onclick=&quot;exportData(&#x27;json&#x27;)&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-file-earmark-text me-2&quot;&gt;&lt;/i&gt;å¯¼å‡ºJSON</span><br><span class="line">                            &lt;/button&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        </span><br><span class="line">                        &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                            &lt;h6 class=&quot;text-muted mb-2&quot;&gt;&lt;i class=&quot;bi bi-clock-history me-2&quot;&gt;&lt;/i&gt;æ“ä½œå†å²&lt;/h6&gt;</span><br><span class="line">                            &lt;div id=&quot;history-list&quot; class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                &lt;div class=&quot;text-muted text-center py-3&quot;&gt;æ— æ“ä½œå†å²&lt;/div&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;button class=&quot;btn btn-outline-secondary w-100 btn-sm&quot; onclick=&quot;undoLast()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-arrow-counterclockwise me-2&quot;&gt;&lt;/i&gt;æ’¤é”€ä¸Šä¸€æ­¥</span><br><span class="line">                            &lt;/button&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        </span><br><span class="line">                        &lt;div&gt;</span><br><span class="line">                            &lt;button class=&quot;btn btn-outline-danger w-100&quot; onclick=&quot;showReport()&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-file-earmark-text me-2&quot;&gt;&lt;/i&gt;ç”ŸæˆæŠ¥å‘Š</span><br><span class="line">                            &lt;/button&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                </span><br><span class="line">                &lt;!-- ä¸»å†…å®¹åŒº --&gt;</span><br><span class="line">                &lt;div class=&quot;col-lg-9&quot;&gt;</span><br><span class="line">                    &lt;!-- æ•°æ®é¢„è§ˆåŒºåŸŸ --&gt;</span><br><span class="line">                    &lt;div class=&quot;card shadow-sm mb-4&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;card-header bg-white d-flex justify-content-between align-items-center&quot;&gt;</span><br><span class="line">                            &lt;h5 class=&quot;mb-0&quot;&gt;&lt;i class=&quot;bi bi-table me-2&quot;&gt;&lt;/i&gt;æ•°æ®é¢„è§ˆ&lt;/h5&gt;</span><br><span class="line">                            &lt;div&gt;</span><br><span class="line">                                &lt;span class=&quot;badge bg-secondary me-2&quot; id=&quot;row-count&quot;&gt;0 è¡Œ&lt;/span&gt;</span><br><span class="line">                                &lt;span class=&quot;badge bg-secondary&quot; id=&quot;col-count&quot;&gt;0 åˆ—&lt;/span&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        &lt;div class=&quot;card-body&quot;&gt;</span><br><span class="line">                            &lt;div id=&quot;data-preview&quot; class=&quot;text-center py-5&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-cloud-arrow-up display-1 text-muted mb-3&quot;&gt;&lt;/i&gt;</span><br><span class="line">                                &lt;h5 class=&quot;text-muted&quot;&gt;å°šæœªåŠ è½½æ•°æ®&lt;/h5&gt;</span><br><span class="line">                                &lt;p class=&quot;text-muted&quot;&gt;è¯·ç‚¹å‡»å·¦ä¾§çš„&quot;ä¸Šä¼ æ•°æ®&quot;æŒ‰é’®å¼€å§‹&lt;/p&gt;</span><br><span class="line">                                &lt;button class=&quot;btn btn-primary mt-3&quot; onclick=&quot;showUploadModal()&quot;&gt;</span><br><span class="line">                                    &lt;i class=&quot;bi bi-upload me-2&quot;&gt;&lt;/i&gt;ä¸Šä¼ æ•°æ®æ–‡ä»¶</span><br><span class="line">                                &lt;/button&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    </span><br><span class="line">                    &lt;!-- æ“ä½œç»“æœåŒºåŸŸ --&gt;</span><br><span class="line">                    &lt;div class=&quot;card shadow-sm&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;card-header bg-white&quot;&gt;</span><br><span class="line">                            &lt;h5 class=&quot;mb-0&quot;&gt;&lt;i class=&quot;bi bi-activity me-2&quot;&gt;&lt;/i&gt;æ“ä½œç»“æœ&lt;/h5&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        &lt;div class=&quot;card-body&quot;&gt;</span><br><span class="line">                            &lt;div id=&quot;operation-result&quot; class=&quot;text-center py-5&quot;&gt;</span><br><span class="line">                                &lt;i class=&quot;bi bi-chat-square-text display-1 text-muted mb-3&quot;&gt;&lt;/i&gt;</span><br><span class="line">                                &lt;h5 class=&quot;text-muted&quot;&gt;æ“ä½œç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ&lt;/h5&gt;</span><br><span class="line">                                &lt;p class=&quot;text-muted&quot;&gt;æ‰§è¡Œæ•°æ®æ¸…æ´—æ“ä½œåï¼Œç»“æœä¼šåœ¨è¿™é‡Œæ˜¾ç¤º&lt;/p&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- ä¸Šä¼ æ•°æ®æ¨¡æ€æ¡† --&gt;</span><br><span class="line">        &lt;div class=&quot;modal fade&quot; id=&quot;uploadModal&quot; tabindex=&quot;-1&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;modal-dialog&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">                    &lt;div class=&quot;modal-header&quot;&gt;</span><br><span class="line">                        &lt;h5 class=&quot;modal-title&quot;&gt;&lt;i class=&quot;bi bi-upload me-2&quot;&gt;&lt;/i&gt;ä¸Šä¼ æ•°æ®æ–‡ä»¶&lt;/h5&gt;</span><br><span class="line">                        &lt;button type=&quot;button&quot; class=&quot;btn-close btn-close-white&quot; data-bs-dismiss=&quot;modal&quot;&gt;&lt;/button&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">                        &lt;form id=&quot;uploadForm&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">                            &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                &lt;label for=&quot;dataFile&quot; class=&quot;form-label&quot;&gt;é€‰æ‹©æ•°æ®æ–‡ä»¶&lt;/label&gt;</span><br><span class="line">                                &lt;input class=&quot;form-control&quot; type=&quot;file&quot; id=&quot;dataFile&quot; accept=&quot;.csv,.xlsx,.xls,.json,.parquet&quot; required&gt;</span><br><span class="line">                                &lt;div class=&quot;form-text&quot;&gt;</span><br><span class="line">                                    æ”¯æŒçš„æ–‡ä»¶æ ¼å¼: CSV, Excel (.xlsx, .xls), JSON, Parquet</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                &lt;label class=&quot;form-label&quot;&gt;æ–‡ä»¶ç¼–ç  (ä»…CSV)&lt;/label&gt;</span><br><span class="line">                                &lt;select class=&quot;form-select&quot; id=&quot;fileEncoding&quot;&gt;</span><br><span class="line">                                    &lt;option value=&quot;utf-8&quot;&gt;UTF-8&lt;/option&gt;</span><br><span class="line">                                    &lt;option value=&quot;gbk&quot;&gt;GBK&lt;/option&gt;</span><br><span class="line">                                    &lt;option value=&quot;gb2312&quot;&gt;GB2312&lt;/option&gt;</span><br><span class="line">                                    &lt;option value=&quot;latin1&quot;&gt;Latin-1&lt;/option&gt;</span><br><span class="line">                                &lt;/select&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/form&gt;</span><br><span class="line">                        &lt;div id=&quot;uploadProgress&quot; class=&quot;progress mt-3&quot; style=&quot;display: none;&quot;&gt;</span><br><span class="line">                            &lt;div id=&quot;uploadProgressBar&quot; class=&quot;progress-bar progress-bar-striped progress-bar-animated&quot; style=&quot;width: 0%&quot;&gt;&lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">                        &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;å–æ¶ˆ&lt;/button&gt;</span><br><span class="line">                        &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; onclick=&quot;uploadFile()&quot;&gt;ä¸Šä¼ å¹¶åŠ è½½&lt;/button&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- è„šæœ¬ --&gt;</span><br><span class="line">        &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;script src=&quot;https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">        &lt;script&gt;</span><br><span class="line">            // å…¨å±€å˜é‡</span><br><span class="line">            let currentData = null;</span><br><span class="line">            let operationHistory = [];</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºä¸Šä¼ æ¨¡æ€æ¡†</span><br><span class="line">            function showUploadModal() &#123;</span><br><span class="line">                const modal = new bootstrap.Modal(document.getElementById(&#x27;uploadModal&#x27;));</span><br><span class="line">                modal.show();</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // ä¸Šä¼ æ–‡ä»¶</span><br><span class="line">            function uploadFile() &#123;</span><br><span class="line">                const fileInput = document.getElementById(&#x27;dataFile&#x27;);</span><br><span class="line">                const file = fileInput.files[0];</span><br><span class="line">                </span><br><span class="line">                if (!file) &#123;</span><br><span class="line">                    alert(&#x27;è¯·é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                const formData = new FormData();</span><br><span class="line">                formData.append(&#x27;file&#x27;, file);</span><br><span class="line">                </span><br><span class="line">                // æ˜¾ç¤ºè¿›åº¦æ¡</span><br><span class="line">                const progressDiv = document.getElementById(&#x27;uploadProgress&#x27;);</span><br><span class="line">                const progressBar = document.getElementById(&#x27;uploadProgressBar&#x27;);</span><br><span class="line">                progressDiv.style.display = &#x27;block&#x27;;</span><br><span class="line">                progressBar.style.width = &#x27;0%&#x27;;</span><br><span class="line">                </span><br><span class="line">                axios.post(&#x27;/upload&#x27;, formData, &#123;</span><br><span class="line">                    headers: &#123;</span><br><span class="line">                        &#x27;Content-Type&#x27;: &#x27;multipart/form-data&#x27;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    onUploadProgress: function(progressEvent) &#123;</span><br><span class="line">                        const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);</span><br><span class="line">                        progressBar.style.width = percentCompleted + &#x27;%&#x27;;</span><br><span class="line">                        progressBar.textContent = percentCompleted + &#x27;%&#x27;;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .then(response =&gt; &#123;</span><br><span class="line">                    if (response.data.success) &#123;</span><br><span class="line">                        // æ›´æ–°ç•Œé¢</span><br><span class="line">                        currentData = response.data.data;</span><br><span class="line">                        updateDataPreview(currentData);</span><br><span class="line">                        updateStatus(&#x27;å·²åŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                        updateHistory(response.data.history);</span><br><span class="line">                        </span><br><span class="line">                        // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨</span><br><span class="line">                        document.getElementById(&#x27;step1&#x27;).classList.add(&#x27;completed&#x27;);</span><br><span class="line">                        document.getElementById(&#x27;step2&#x27;).classList.add(&#x27;active&#x27;);</span><br><span class="line">                        </span><br><span class="line">                        // éšè—è¿›åº¦æ¡</span><br><span class="line">                        progressDiv.style.display = &#x27;none&#x27;;</span><br><span class="line">                        </span><br><span class="line">                        // å…³é—­æ¨¡æ€æ¡†</span><br><span class="line">                        bootstrap.Modal.getInstance(document.getElementById(&#x27;uploadModal&#x27;)).hide();</span><br><span class="line">                        </span><br><span class="line">                        // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯</span><br><span class="line">                        showResult(&#x27;success&#x27;, &#x27;æ•°æ®åŠ è½½æˆåŠŸ&#x27;, response.data.message);</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        showResult(&#x27;error&#x27;, &#x27;æ•°æ®åŠ è½½å¤±è´¥&#x27;, response.data.message);</span><br><span class="line">                        progressDiv.style.display = &#x27;none&#x27;;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .catch(error =&gt; &#123;</span><br><span class="line">                    console.error(&#x27;ä¸Šä¼ å¤±è´¥:&#x27;, error);</span><br><span class="line">                    showResult(&#x27;error&#x27;, &#x27;ä¸Šä¼ å¤±è´¥&#x27;, error.response?.data?.message || error.message);</span><br><span class="line">                    progressDiv.style.display = &#x27;none&#x27;;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ›´æ–°æ•°æ®é¢„è§ˆ</span><br><span class="line">            function updateDataPreview(data) &#123;</span><br><span class="line">                const previewDiv = document.getElementById(&#x27;data-preview&#x27;);</span><br><span class="line">                const rowCount = document.getElementById(&#x27;row-count&#x27;);</span><br><span class="line">                const colCount = document.getElementById(&#x27;col-count&#x27;);</span><br><span class="line">                </span><br><span class="line">                if (!data || !data.sample || data.sample.length === 0) &#123;</span><br><span class="line">                    previewDiv.innerHTML = `</span><br><span class="line">                        &lt;div class=&quot;text-center py-5&quot;&gt;</span><br><span class="line">                            &lt;i class=&quot;bi bi-exclamation-triangle display-1 text-warning mb-3&quot;&gt;&lt;/i&gt;</span><br><span class="line">                            &lt;h5 class=&quot;text-muted&quot;&gt;æ•°æ®ä¸ºç©º&lt;/h5&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    `;</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                // åˆ›å»ºè¡¨æ ¼</span><br><span class="line">                let html = &#x27;&lt;div class=&quot;data-table-container&quot;&gt;&#x27;;</span><br><span class="line">                html += &#x27;&lt;table class=&quot;table table-sm table-hover&quot;&gt;&#x27;;</span><br><span class="line">                html += &#x27;&lt;thead class=&quot;table-light&quot;&gt;&lt;tr&gt;&#x27;;</span><br><span class="line">                </span><br><span class="line">                // è¡¨å¤´</span><br><span class="line">                const columns = Object.keys(data.sample[0]);</span><br><span class="line">                columns.forEach(col =&gt; &#123;</span><br><span class="line">                    html += `&lt;th&gt;$&#123;col&#125;&lt;/th&gt;`;</span><br><span class="line">                &#125;);</span><br><span class="line">                html += &#x27;&lt;/tr&gt;&lt;/thead&gt;&#x27;;</span><br><span class="line">                html += &#x27;&lt;tbody&gt;&#x27;;</span><br><span class="line">                </span><br><span class="line">                // æ•°æ®è¡Œ</span><br><span class="line">                data.sample.forEach(row =&gt; &#123;</span><br><span class="line">                    html += &#x27;&lt;tr&gt;&#x27;;</span><br><span class="line">                    columns.forEach(col =&gt; &#123;</span><br><span class="line">                        let value = row[col];</span><br><span class="line">                        if (value === null || value === undefined) &#123;</span><br><span class="line">                            value = &#x27;&lt;span class=&quot;text-muted fst-italic&quot;&gt;null&lt;/span&gt;&#x27;;</span><br><span class="line">                        &#125; else if (typeof value === &#x27;string&#x27; &amp;&amp; value.length &gt; 50) &#123;</span><br><span class="line">                            value = value.substring(0, 50) + &#x27;...&#x27;;</span><br><span class="line">                        &#125;</span><br><span class="line">                        html += `&lt;td&gt;$&#123;value&#125;&lt;/td&gt;`;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    html += &#x27;&lt;/tr&gt;&#x27;;</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                html += &#x27;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;&#x27;;</span><br><span class="line">                </span><br><span class="line">                // æ·»åŠ ç»Ÿè®¡ä¿¡æ¯</span><br><span class="line">                html += `</span><br><span class="line">                    &lt;div class=&quot;mt-3 text-start&quot;&gt;</span><br><span class="line">                        &lt;small class=&quot;text-muted&quot;&gt;</span><br><span class="line">                            æ˜¾ç¤ºå‰ $&#123;data.sample.length&#125; è¡Œï¼Œå…± $&#123;data.info.rows&#125; è¡Œ $&#123;data.info.columns&#125; åˆ—</span><br><span class="line">                        &lt;/small&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                previewDiv.innerHTML = html;</span><br><span class="line">                rowCount.textContent = `$&#123;data.info.rows&#125; è¡Œ`;</span><br><span class="line">                colCount.textContent = `$&#123;data.info.columns&#125; åˆ—`;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ›´æ–°çŠ¶æ€</span><br><span class="line">            function updateStatus(status) &#123;</span><br><span class="line">                const statusBadge = document.getElementById(&#x27;data-status&#x27;);</span><br><span class="line">                statusBadge.textContent = status;</span><br><span class="line">                </span><br><span class="line">                if (status === &#x27;æœªåŠ è½½æ•°æ®&#x27;) &#123;</span><br><span class="line">                    statusBadge.className = &#x27;badge bg-secondary&#x27;;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    statusBadge.className = &#x27;badge bg-success&#x27;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ›´æ–°æ“ä½œå†å²</span><br><span class="line">            function updateHistory(history) &#123;</span><br><span class="line">                const historyDiv = document.getElementById(&#x27;history-list&#x27;);</span><br><span class="line">                </span><br><span class="line">                if (!history || history.length === 0) &#123;</span><br><span class="line">                    historyDiv.innerHTML = &#x27;&lt;div class=&quot;text-muted text-center py-3&quot;&gt;æ— æ“ä½œå†å²&lt;/div&gt;&#x27;;</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                let html = &#x27;&#x27;;</span><br><span class="line">                history.slice().reverse().forEach((item, index) =&gt; &#123;</span><br><span class="line">                    html += `</span><br><span class="line">                        &lt;div class=&quot;history-item&quot;&gt;</span><br><span class="line">                            &lt;div class=&quot;d-flex justify-content-between&quot;&gt;</span><br><span class="line">                                &lt;small&gt;$&#123;item.action&#125;&lt;/small&gt;</span><br><span class="line">                                &lt;small class=&quot;text-muted&quot;&gt;$&#123;item.timestamp&#125;&lt;/small&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    `;</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                historyDiv.innerHTML = html;</span><br><span class="line">                operationHistory = history;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºæ“ä½œç»“æœ</span><br><span class="line">            function showResult(type, title, message) &#123;</span><br><span class="line">                const resultDiv = document.getElementById(&#x27;operation-result&#x27;);</span><br><span class="line">                </span><br><span class="line">                let icon = &#x27;bi-info-circle&#x27;;</span><br><span class="line">                let color = &#x27;primary&#x27;;</span><br><span class="line">                </span><br><span class="line">                if (type === &#x27;success&#x27;) &#123;</span><br><span class="line">                    icon = &#x27;bi-check-circle&#x27;;</span><br><span class="line">                    color = &#x27;success&#x27;;</span><br><span class="line">                &#125; else if (type === &#x27;error&#x27;) &#123;</span><br><span class="line">                    icon = &#x27;bi-exclamation-triangle&#x27;;</span><br><span class="line">                    color = &#x27;danger&#x27;;</span><br><span class="line">                &#125; else if (type === &#x27;warning&#x27;) &#123;</span><br><span class="line">                    icon = &#x27;bi-exclamation-circle&#x27;;</span><br><span class="line">                    color = &#x27;warning&#x27;;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                resultDiv.innerHTML = `</span><br><span class="line">                    &lt;div class=&quot;alert alert-$&#123;color&#125;&quot;&gt;</span><br><span class="line">                        &lt;h5&gt;&lt;i class=&quot;bi $&#123;icon&#125; me-2&quot;&gt;&lt;/i&gt;$&#123;title&#125;&lt;/h5&gt;</span><br><span class="line">                        &lt;p class=&quot;mb-0&quot;&gt;$&#123;message&#125;&lt;/p&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                // è‡ªåŠ¨æ»šåŠ¨åˆ°ç»“æœåŒºåŸŸ</span><br><span class="line">                resultDiv.scrollIntoView(&#123; behavior: &#x27;smooth&#x27;, block: &#x27;start&#x27; &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºæ•°æ®ä¿¡æ¯</span><br><span class="line">            function showDataInfo() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                const info = currentData.info;</span><br><span class="line">                let html = &#x27;&lt;div class=&quot;row&quot;&gt;&#x27;;</span><br><span class="line">                </span><br><span class="line">                // åŸºæœ¬ä¿¡æ¯</span><br><span class="line">                html += `</span><br><span class="line">                    &lt;div class=&quot;col-md-6&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;card mb-3&quot;&gt;</span><br><span class="line">                            &lt;div class=&quot;card-header bg-light&quot;&gt;</span><br><span class="line">                                &lt;h6 class=&quot;mb-0&quot;&gt;åŸºæœ¬ä¿¡æ¯&lt;/h6&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;card-body&quot;&gt;</span><br><span class="line">                                &lt;table class=&quot;table table-sm&quot;&gt;</span><br><span class="line">                                    &lt;tr&gt;&lt;td&gt;&lt;strong&gt;æ–‡ä»¶å&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;$&#123;info.file_info.filename&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                    &lt;tr&gt;&lt;td&gt;&lt;strong&gt;æ–‡ä»¶ç±»å‹&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;$&#123;info.file_info.file_type&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                    &lt;tr&gt;&lt;td&gt;&lt;strong&gt;æ•°æ®å½¢çŠ¶&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;$&#123;info.shape[0]&#125; è¡Œ Ã— $&#123;info.shape[1]&#125; åˆ—&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                    &lt;tr&gt;&lt;td&gt;&lt;strong&gt;å†…å­˜ä½¿ç”¨&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;$&#123;(info.memory_usage / 1024 / 1024).toFixed(2)&#125; MB&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                &lt;/table&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                // åˆ—ä¿¡æ¯</span><br><span class="line">                html += `</span><br><span class="line">                    &lt;div class=&quot;col-md-6&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;card mb-3&quot;&gt;</span><br><span class="line">                            &lt;div class=&quot;card-header bg-light&quot;&gt;</span><br><span class="line">                                &lt;h6 class=&quot;mb-0&quot;&gt;åˆ—ä¿¡æ¯&lt;/h6&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;card-body&quot;&gt;</span><br><span class="line">                                &lt;div class=&quot;table-responsive&quot; style=&quot;max-height: 300px;&quot;&gt;</span><br><span class="line">                                    &lt;table class=&quot;table table-sm&quot;&gt;</span><br><span class="line">                                        &lt;thead&gt;</span><br><span class="line">                                            &lt;tr&gt;</span><br><span class="line">                                                &lt;th&gt;åˆ—å&lt;/th&gt;</span><br><span class="line">                                                &lt;th&gt;ç±»å‹&lt;/th&gt;</span><br><span class="line">                                                &lt;th&gt;ç©ºå€¼&lt;/th&gt;</span><br><span class="line">                                                &lt;th&gt;å”¯ä¸€å€¼&lt;/th&gt;</span><br><span class="line">                                            &lt;/tr&gt;</span><br><span class="line">                                        &lt;/thead&gt;</span><br><span class="line">                                        &lt;tbody&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                info.columns.forEach(col =&gt; &#123;</span><br><span class="line">                    const nullCount = info.null_counts[col] || 0;</span><br><span class="line">                    const nullPct = (nullCount / info.shape[0] * 100).toFixed(1);</span><br><span class="line">                    const uniqueCount = info.unique_counts ? (info.unique_counts[col] || &#x27;N/A&#x27;) : &#x27;N/A&#x27;;</span><br><span class="line">                    </span><br><span class="line">                    html += `</span><br><span class="line">                        &lt;tr&gt;</span><br><span class="line">                            &lt;td&gt;&lt;strong&gt;$&#123;col&#125;&lt;/strong&gt;&lt;/td&gt;</span><br><span class="line">                            &lt;td&gt;&lt;span class=&quot;badge bg-secondary&quot;&gt;$&#123;info.dtypes[col]&#125;&lt;/span&gt;&lt;/td&gt;</span><br><span class="line">                            &lt;td&gt;$&#123;nullCount&#125; ($&#123;nullPct&#125;%)&lt;/td&gt;</span><br><span class="line">                            &lt;td&gt;$&#123;uniqueCount&#125;&lt;/td&gt;</span><br><span class="line">                        &lt;/tr&gt;</span><br><span class="line">                    `;</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                html += `</span><br><span class="line">                                        &lt;/tbody&gt;</span><br><span class="line">                                    &lt;/table&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                html += &#x27;&lt;/div&gt;&#x27;;</span><br><span class="line">                document.getElementById(&#x27;operation-result&#x27;).innerHTML = html;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºç¼ºå¤±å€¼åˆ†æ</span><br><span class="line">            function showMissingAnalysis() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                axios.get(&#x27;/missing-analysis&#x27;)</span><br><span class="line">                    .then(response =&gt; &#123;</span><br><span class="line">                        if (response.data.success) &#123;</span><br><span class="line">                            const analysis = response.data.analysis;</span><br><span class="line">                            let html = &#x27;&lt;div class=&quot;card&quot;&gt;&#x27;;</span><br><span class="line">                            html += &#x27;&lt;div class=&quot;card-header bg-light&quot;&gt;&lt;h5 class=&quot;mb-0&quot;&gt;ç¼ºå¤±å€¼åˆ†æ&lt;/h5&gt;&lt;/div&gt;&#x27;;</span><br><span class="line">                            html += &#x27;&lt;div class=&quot;card-body&quot;&gt;&#x27;;</span><br><span class="line">                            </span><br><span class="line">                            if (analysis.total_missing === 0) &#123;</span><br><span class="line">                                html += &#x27;&lt;div class=&quot;alert alert-success&quot;&gt;æ•°æ®ä¸­æ²¡æœ‰ç¼ºå¤±å€¼ï¼&lt;/div&gt;&#x27;;</span><br><span class="line">                            &#125; else &#123;</span><br><span class="line">                                html += `</span><br><span class="line">                                    &lt;div class=&quot;alert alert-warning&quot;&gt;</span><br><span class="line">                                        æ•°æ®ä¸­å…±æœ‰ $&#123;analysis.total_missing&#125; ä¸ªç¼ºå¤±å€¼ï¼Œåˆ†å¸ƒåœ¨ $&#123;analysis.columns_with_missing&#125; åˆ—ä¸­</span><br><span class="line">                                    &lt;/div&gt;</span><br><span class="line">                                    &lt;div class=&quot;table-responsive&quot;&gt;</span><br><span class="line">                                        &lt;table class=&quot;table table-sm&quot;&gt;</span><br><span class="line">                                            &lt;thead&gt;</span><br><span class="line">                                                &lt;tr&gt;</span><br><span class="line">                                                    &lt;th&gt;åˆ—å&lt;/th&gt;</span><br><span class="line">                                                    &lt;th&gt;æ•°æ®ç±»å‹&lt;/th&gt;</span><br><span class="line">                                                    &lt;th&gt;ç¼ºå¤±å€¼æ•°é‡&lt;/th&gt;</span><br><span class="line">                                                    &lt;th&gt;ç¼ºå¤±å€¼ç™¾åˆ†æ¯”&lt;/th&gt;</span><br><span class="line">                                                    &lt;th&gt;å»ºè®®æ“ä½œ&lt;/th&gt;</span><br><span class="line">                                                &lt;/tr&gt;</span><br><span class="line">                                            &lt;/thead&gt;</span><br><span class="line">                                            &lt;tbody&gt;</span><br><span class="line">                                `;</span><br><span class="line">                                </span><br><span class="line">                                analysis.details.forEach(item =&gt; &#123;</span><br><span class="line">                                    let suggestion = &#x27;æ— éœ€å¤„ç†&#x27;;</span><br><span class="line">                                    if (item.missing_percentage &gt; 50) &#123;</span><br><span class="line">                                        suggestion = &#x27;&lt;span class=&quot;badge bg-danger&quot;&gt;è€ƒè™‘åˆ é™¤è¯¥åˆ—&lt;/span&gt;&#x27;;</span><br><span class="line">                                    &#125; else if (item.missing_percentage &gt; 20) &#123;</span><br><span class="line">                                        suggestion = &#x27;&lt;span class=&quot;badge bg-warning&quot;&gt;å»ºè®®ä½¿ç”¨ä¸­ä½æ•°æˆ–ä¼—æ•°å¡«å……&lt;/span&gt;&#x27;;</span><br><span class="line">                                    &#125; else if (item.missing_percentage &gt; 0) &#123;</span><br><span class="line">                                        suggestion = &#x27;&lt;span class=&quot;badge bg-info&quot;&gt;å»ºè®®ä½¿ç”¨å‡å€¼æˆ–å‰å‘å¡«å……&lt;/span&gt;&#x27;;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    </span><br><span class="line">                                    html += `</span><br><span class="line">                                        &lt;tr&gt;</span><br><span class="line">                                            &lt;td&gt;&lt;strong&gt;$&#123;item.column&#125;&lt;/strong&gt;&lt;/td&gt;</span><br><span class="line">                                            &lt;td&gt;&lt;span class=&quot;badge bg-secondary&quot;&gt;$&#123;item.dtype&#125;&lt;/span&gt;&lt;/td&gt;</span><br><span class="line">                                            &lt;td&gt;$&#123;item.missing_count&#125;&lt;/td&gt;</span><br><span class="line">                                            &lt;td&gt;$&#123;item.missing_percentage.toFixed(1)&#125;%&lt;/td&gt;</span><br><span class="line">                                            &lt;td&gt;$&#123;suggestion&#125;&lt;/td&gt;</span><br><span class="line">                                        &lt;/tr&gt;</span><br><span class="line">                                    `;</span><br><span class="line">                                &#125;);</span><br><span class="line">                                </span><br><span class="line">                                html += &#x27;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;&#x27;;</span><br><span class="line">                            &#125;</span><br><span class="line">                            </span><br><span class="line">                            html += &#x27;&lt;/div&gt;&lt;/div&gt;&#x27;;</span><br><span class="line">                            document.getElementById(&#x27;operation-result&#x27;).innerHTML = html;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .catch(error =&gt; &#123;</span><br><span class="line">                        showResult(&#x27;error&#x27;, &#x27;åˆ†æå¤±è´¥&#x27;, error.message);</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºå¤„ç†ç¼ºå¤±å€¼æ¨¡æ€æ¡†</span><br><span class="line">            function showMissingModal() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                axios.get(&#x27;/missing-analysis&#x27;)</span><br><span class="line">                    .then(response =&gt; &#123;</span><br><span class="line">                        if (response.data.success) &#123;</span><br><span class="line">                            const analysis = response.data.analysis;</span><br><span class="line">                            </span><br><span class="line">                            let modalHtml = `</span><br><span class="line">                                &lt;div class=&quot;modal fade&quot; id=&quot;missingModal&quot; tabindex=&quot;-1&quot;&gt;</span><br><span class="line">                                    &lt;div class=&quot;modal-dialog modal-lg&quot;&gt;</span><br><span class="line">                                        &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-header bg-primary text-white&quot;&gt;</span><br><span class="line">                                                &lt;h5 class=&quot;modal-title&quot;&gt;&lt;i class=&quot;bi bi-dash-circle me-2&quot;&gt;&lt;/i&gt;å¤„ç†ç¼ºå¤±å€¼&lt;/h5&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn-close btn-close-white&quot; data-bs-dismiss=&quot;modal&quot;&gt;&lt;/button&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">                                                &lt;form id=&quot;missingForm&quot;&gt;</span><br><span class="line">                                                    &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                                        &lt;label class=&quot;form-label&quot;&gt;é€‰æ‹©å¤„ç†ç­–ç•¥&lt;/label&gt;</span><br><span class="line">                                                        &lt;select class=&quot;form-select&quot; id=&quot;missingStrategy&quot; onchange=&quot;updateMissingOptions()&quot;&gt;</span><br><span class="line">                                                            &lt;option value=&quot;mean&quot;&gt;å‡å€¼å¡«å…… (æ•°å€¼åˆ—)&lt;/option&gt;</span><br><span class="line">                                                            &lt;option value=&quot;median&quot;&gt;ä¸­ä½æ•°å¡«å…… (æ•°å€¼åˆ—)&lt;/option&gt;</span><br><span class="line">                                                            &lt;option value=&quot;mode&quot;&gt;ä¼—æ•°å¡«å…… (æ‰€æœ‰åˆ—)&lt;/option&gt;</span><br><span class="line">                                                            &lt;option value=&quot;forward&quot;&gt;å‰å‘å¡«å……&lt;/option&gt;</span><br><span class="line">                                                            &lt;option value=&quot;backward&quot;&gt;åå‘å¡«å……&lt;/option&gt;</span><br><span class="line">                                                            &lt;option value=&quot;custom&quot;&gt;è‡ªå®šä¹‰å€¼å¡«å……&lt;/option&gt;</span><br><span class="line">                                                            &lt;option value=&quot;drop&quot;&gt;åˆ é™¤åŒ…å«ç¼ºå¤±å€¼çš„è¡Œ&lt;/option&gt;</span><br><span class="line">                                                        &lt;/select&gt;</span><br><span class="line">                                                    &lt;/div&gt;</span><br><span class="line">                                                    </span><br><span class="line">                                                    &lt;div class=&quot;mb-3&quot; id=&quot;customValueDiv&quot; style=&quot;display: none;&quot;&gt;</span><br><span class="line">                                                        &lt;label class=&quot;form-label&quot;&gt;è‡ªå®šä¹‰å¡«å……å€¼&lt;/label&gt;</span><br><span class="line">                                                        &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;customValue&quot; placeholder=&quot;ä¾‹å¦‚: 0, unknown, NaN&quot;&gt;</span><br><span class="line">                                                    &lt;/div&gt;</span><br><span class="line">                                                    </span><br><span class="line">                                                    &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                                        &lt;label class=&quot;form-label&quot;&gt;é€‰æ‹©è¦å¤„ç†çš„åˆ—&lt;/label&gt;</span><br><span class="line">                                                        &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                                                            &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; name=&quot;columnScope&quot; id=&quot;scopeAll&quot; value=&quot;all&quot; checked&gt;</span><br><span class="line">                                                            &lt;label class=&quot;form-check-label&quot; for=&quot;scopeAll&quot;&gt;æ‰€æœ‰åŒ…å«ç¼ºå¤±å€¼çš„åˆ— ($&#123;analysis.columns_with_missing&#125;åˆ—)&lt;/label&gt;</span><br><span class="line">                                                        &lt;/div&gt;</span><br><span class="line">                                                        &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                                                            &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; name=&quot;columnScope&quot; id=&quot;scopeSelect&quot; value=&quot;select&quot;&gt;</span><br><span class="line">                                                            &lt;label class=&quot;form-check-label&quot; for=&quot;scopeSelect&quot;&gt;é€‰æ‹©ç‰¹å®šåˆ—&lt;/label&gt;</span><br><span class="line">                                                        &lt;/div&gt;</span><br><span class="line">                                                        </span><br><span class="line">                                                        &lt;div id=&quot;columnSelectDiv&quot; style=&quot;display: none; margin-top: 10px; max-height: 200px; overflow-y: auto;&quot;&gt;</span><br><span class="line">                            `;</span><br><span class="line">                            </span><br><span class="line">                            // æ·»åŠ åˆ—é€‰æ‹©</span><br><span class="line">                            analysis.details.forEach(item =&gt; &#123;</span><br><span class="line">                                if (item.missing_count &gt; 0) &#123;</span><br><span class="line">                                    modalHtml += `</span><br><span class="line">                                        &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                                            &lt;input class=&quot;form-check-input column-check&quot; type=&quot;checkbox&quot; value=&quot;$&#123;item.column&#125;&quot; id=&quot;col_$&#123;item.column&#125;&quot;&gt;</span><br><span class="line">                                            &lt;label class=&quot;form-check-label&quot; for=&quot;col_$&#123;item.column&#125;&quot;&gt;</span><br><span class="line">                                                $&#123;item.column&#125; &lt;small class=&quot;text-muted&quot;&gt;($&#123;item.dtype&#125;, $&#123;item.missing_count&#125;ä¸ªç¼ºå¤±å€¼)&lt;/small&gt;</span><br><span class="line">                                            &lt;/label&gt;</span><br><span class="line">                                        &lt;/div&gt;</span><br><span class="line">                                    `;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;);</span><br><span class="line">                            </span><br><span class="line">                            modalHtml += `</span><br><span class="line">                                                        &lt;/div&gt;</span><br><span class="line">                                                    &lt;/div&gt;</span><br><span class="line">                                                &lt;/form&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;å–æ¶ˆ&lt;/button&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; onclick=&quot;applyMissingHandling()&quot;&gt;åº”ç”¨å¤„ç†&lt;/button&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                        &lt;/div&gt;</span><br><span class="line">                                    &lt;/div&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                </span><br><span class="line">                                &lt;script&gt;</span><br><span class="line">                                function updateMissingOptions() &#123;</span><br><span class="line">                                    const strategy = document.getElementById(&#x27;missingStrategy&#x27;).value;</span><br><span class="line">                                    const customDiv = document.getElementById(&#x27;customValueDiv&#x27;);</span><br><span class="line">                                    customDiv.style.display = strategy === &#x27;custom&#x27; ? &#x27;block&#x27; : &#x27;none&#x27;;</span><br><span class="line">                                &#125;</span><br><span class="line">                                </span><br><span class="line">                                function applyMissingHandling() &#123;</span><br><span class="line">                                    const strategy = document.getElementById(&#x27;missingStrategy&#x27;).value;</span><br><span class="line">                                    const customValue = document.getElementById(&#x27;customValue&#x27;).value;</span><br><span class="line">                                    const scope = document.querySelector(&#x27;input[name=&quot;columnScope&quot;]:checked&#x27;).value;</span><br><span class="line">                                    </span><br><span class="line">                                    let columns = null;</span><br><span class="line">                                    if (scope === &#x27;select&#x27;) &#123;</span><br><span class="line">                                        const selectedCols = Array.from(document.querySelectorAll(&#x27;.column-check:checked&#x27;))</span><br><span class="line">                                            .map(cb =&gt; cb.value);</span><br><span class="line">                                        if (selectedCols.length === 0) &#123;</span><br><span class="line">                                            alert(&#x27;è¯·è‡³å°‘é€‰æ‹©ä¸€åˆ—&#x27;);</span><br><span class="line">                                            return;</span><br><span class="line">                                        &#125;</span><br><span class="line">                                        columns = selectedCols;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    </span><br><span class="line">                                    const params = &#123;</span><br><span class="line">                                        strategy: strategy,</span><br><span class="line">                                        columns: columns,</span><br><span class="line">                                        custom_value: customValue || null</span><br><span class="line">                                    &#125;;</span><br><span class="line">                                    </span><br><span class="line">                                    axios.post(&#x27;/handle-missing&#x27;, params)</span><br><span class="line">                                        .then(response =&gt; &#123;</span><br><span class="line">                                            if (response.data.success) &#123;</span><br><span class="line">                                                // æ›´æ–°æ•°æ®é¢„è§ˆ</span><br><span class="line">                                                currentData = response.data.data;</span><br><span class="line">                                                updateDataPreview(currentData);</span><br><span class="line">                                                updateHistory(response.data.history);</span><br><span class="line">                                                </span><br><span class="line">                                                // å…³é—­æ¨¡æ€æ¡†</span><br><span class="line">                                                bootstrap.Modal.getInstance(document.getElementById(&#x27;missingModal&#x27;)).hide();</span><br><span class="line">                                                </span><br><span class="line">                                                // æ˜¾ç¤ºç»“æœ</span><br><span class="line">                                                showResult(&#x27;success&#x27;, &#x27;å¤„ç†æˆåŠŸ&#x27;, response.data.message);</span><br><span class="line">                                            &#125; else &#123;</span><br><span class="line">                                                showResult(&#x27;error&#x27;, &#x27;å¤„ç†å¤±è´¥&#x27;, response.data.message);</span><br><span class="line">                                            &#125;</span><br><span class="line">                                        &#125;)</span><br><span class="line">                                        .catch(error =&gt; &#123;</span><br><span class="line">                                            showResult(&#x27;error&#x27;, &#x27;å¤„ç†å¤±è´¥&#x27;, error.response?.data?.message || error.message);</span><br><span class="line">                                        &#125;);</span><br><span class="line">                                &#125;</span><br><span class="line">                                &lt;\/script&gt;</span><br><span class="line">                            `;</span><br><span class="line">                            </span><br><span class="line">                            // åˆ›å»ºå¹¶æ˜¾ç¤ºæ¨¡æ€æ¡†</span><br><span class="line">                            const modalContainer = document.createElement(&#x27;div&#x27;);</span><br><span class="line">                            modalContainer.innerHTML = modalHtml;</span><br><span class="line">                            document.body.appendChild(modalContainer);</span><br><span class="line">                            </span><br><span class="line">                            const modal = new bootstrap.Modal(document.getElementById(&#x27;missingModal&#x27;));</span><br><span class="line">                            modal.show();</span><br><span class="line">                            </span><br><span class="line">                            // ç›‘å¬åˆ—èŒƒå›´é€‰æ‹©</span><br><span class="line">                            document.querySelectorAll(&#x27;input[name=&quot;columnScope&quot;]&#x27;).forEach(radio =&gt; &#123;</span><br><span class="line">                                radio.addEventListener(&#x27;change&#x27;, function() &#123;</span><br><span class="line">                                    const selectDiv = document.getElementById(&#x27;columnSelectDiv&#x27;);</span><br><span class="line">                                    selectDiv.style.display = this.value === &#x27;select&#x27; ? &#x27;block&#x27; : &#x27;none&#x27;;</span><br><span class="line">                                &#125;);</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .catch(error =&gt; &#123;</span><br><span class="line">                        showResult(&#x27;error&#x27;, &#x27;è·å–åˆ†æå¤±è´¥&#x27;, error.message);</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºå»é‡æ¨¡æ€æ¡†</span><br><span class="line">            function showDedupModal() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                let modalHtml = `</span><br><span class="line">                    &lt;div class=&quot;modal fade&quot; id=&quot;dedupModal&quot; tabindex=&quot;-1&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;modal-dialog&quot;&gt;</span><br><span class="line">                            &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-header bg-primary text-white&quot;&gt;</span><br><span class="line">                                    &lt;h5 class=&quot;modal-title&quot;&gt;&lt;i class=&quot;bi bi-files me-2&quot;&gt;&lt;/i&gt;å»é™¤é‡å¤å€¼&lt;/h5&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn-close btn-close-white&quot; data-bs-dismiss=&quot;modal&quot;&gt;&lt;/button&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">                                    &lt;form id=&quot;dedupForm&quot;&gt;</span><br><span class="line">                                        &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                            &lt;label class=&quot;form-label&quot;&gt;åŸºäºå“ªäº›åˆ—å»é‡&lt;/label&gt;</span><br><span class="line">                                            &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                                                &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; name=&quot;dedupScope&quot; id=&quot;dedupAll&quot; value=&quot;all&quot; checked&gt;</span><br><span class="line">                                                &lt;label class=&quot;form-check-label&quot; for=&quot;dedupAll&quot;&gt;æ‰€æœ‰åˆ— (å®Œå…¨ç›¸åŒçš„è¡Œ)&lt;/label&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                            &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                                                &lt;input class=&quot;form-check-input&quot; type=&quot;radio&quot; name=&quot;dedupScope&quot; id=&quot;dedupSelected&quot; value=&quot;selected&quot;&gt;</span><br><span class="line">                                                &lt;label class=&quot;form-check-label&quot; for=&quot;dedupSelected&quot;&gt;é€‰æ‹©ç‰¹å®šåˆ—&lt;/label&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                            </span><br><span class="line">                                            &lt;div id=&quot;dedupColumnSelect&quot; style=&quot;display: none; margin-top: 10px; max-height: 200px; overflow-y: auto;&quot;&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                // æ·»åŠ åˆ—é€‰æ‹©</span><br><span class="line">                currentData.info.columns.forEach(col =&gt; &#123;</span><br><span class="line">                    modalHtml += `</span><br><span class="line">                        &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                            &lt;input class=&quot;form-check-input dedup-col-check&quot; type=&quot;checkbox&quot; value=&quot;$&#123;col&#125;&quot; id=&quot;dedup_col_$&#123;col&#125;&quot;&gt;</span><br><span class="line">                            &lt;label class=&quot;form-check-label&quot; for=&quot;dedup_col_$&#123;col&#125;&quot;&gt;$&#123;col&#125;&lt;/label&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    `;</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                modalHtml += `</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                        &lt;/div&gt;</span><br><span class="line">                                        </span><br><span class="line">                                        &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                            &lt;label class=&quot;form-label&quot;&gt;ä¿ç•™ç­–ç•¥&lt;/label&gt;</span><br><span class="line">                                            &lt;select class=&quot;form-select&quot; id=&quot;keepStrategy&quot;&gt;</span><br><span class="line">                                                &lt;option value=&quot;first&quot;&gt;ä¿ç•™ç¬¬ä¸€ä¸ªå‡ºç°çš„è¡Œ&lt;/option&gt;</span><br><span class="line">                                                &lt;option value=&quot;last&quot;&gt;ä¿ç•™æœ€åä¸€ä¸ªå‡ºç°çš„è¡Œ&lt;/option&gt;</span><br><span class="line">                                                &lt;option value=&quot;none&quot;&gt;åˆ é™¤æ‰€æœ‰é‡å¤è¡Œ&lt;/option&gt;</span><br><span class="line">                                            &lt;/select&gt;</span><br><span class="line">                                        &lt;/div&gt;</span><br><span class="line">                                    &lt;/form&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;å–æ¶ˆ&lt;/button&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; onclick=&quot;applyDedup()&quot;&gt;å»é™¤é‡å¤&lt;/button&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    </span><br><span class="line">                    &lt;script&gt;</span><br><span class="line">                    function applyDedup() &#123;</span><br><span class="line">                        const scope = document.querySelector(&#x27;input[name=&quot;dedupScope&quot;]:checked&#x27;).value;</span><br><span class="line">                        const keep = document.getElementById(&#x27;keepStrategy&#x27;).value;</span><br><span class="line">                        </span><br><span class="line">                        let subset = null;</span><br><span class="line">                        if (scope === &#x27;selected&#x27;) &#123;</span><br><span class="line">                            const selectedCols = Array.from(document.querySelectorAll(&#x27;.dedup-col-check:checked&#x27;))</span><br><span class="line">                                .map(cb =&gt; cb.value);</span><br><span class="line">                            if (selectedCols.length === 0) &#123;</span><br><span class="line">                                alert(&#x27;è¯·è‡³å°‘é€‰æ‹©ä¸€åˆ—&#x27;);</span><br><span class="line">                                return;</span><br><span class="line">                            &#125;</span><br><span class="line">                            subset = selectedCols;</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        const params = &#123;</span><br><span class="line">                            subset: subset,</span><br><span class="line">                            keep: keep</span><br><span class="line">                        &#125;;</span><br><span class="line">                        </span><br><span class="line">                        axios.post(&#x27;/remove-duplicates&#x27;, params)</span><br><span class="line">                            .then(response =&gt; &#123;</span><br><span class="line">                                if (response.data.success) &#123;</span><br><span class="line">                                    // æ›´æ–°æ•°æ®é¢„è§ˆ</span><br><span class="line">                                    currentData = response.data.data;</span><br><span class="line">                                    updateDataPreview(currentData);</span><br><span class="line">                                    updateHistory(response.data.history);</span><br><span class="line">                                    </span><br><span class="line">                                    // å…³é—­æ¨¡æ€æ¡†</span><br><span class="line">                                    bootstrap.Modal.getInstance(document.getElementById(&#x27;dedupModal&#x27;)).hide();</span><br><span class="line">                                    </span><br><span class="line">                                    // æ˜¾ç¤ºç»“æœ</span><br><span class="line">                                    showResult(&#x27;success&#x27;, &#x27;å»é‡æˆåŠŸ&#x27;, response.data.message);</span><br><span class="line">                                &#125; else &#123;</span><br><span class="line">                                    showResult(&#x27;error&#x27;, &#x27;å»é‡å¤±è´¥&#x27;, response.data.message);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;)</span><br><span class="line">                            .catch(error =&gt; &#123;</span><br><span class="line">                                showResult(&#x27;error&#x27;, &#x27;å»é‡å¤±è´¥&#x27;, error.response?.data?.message || error.message);</span><br><span class="line">                            &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &lt;\/script&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                // åˆ›å»ºå¹¶æ˜¾ç¤ºæ¨¡æ€æ¡†</span><br><span class="line">                const modalContainer = document.createElement(&#x27;div&#x27;);</span><br><span class="line">                modalContainer.innerHTML = modalHtml;</span><br><span class="line">                document.body.appendChild(modalContainer);</span><br><span class="line">                </span><br><span class="line">                const modal = new bootstrap.Modal(document.getElementById(&#x27;dedupModal&#x27;));</span><br><span class="line">                modal.show();</span><br><span class="line">                </span><br><span class="line">                // ç›‘å¬åˆ—èŒƒå›´é€‰æ‹©</span><br><span class="line">                document.querySelectorAll(&#x27;input[name=&quot;dedupScope&quot;]&#x27;).forEach(radio =&gt; &#123;</span><br><span class="line">                    radio.addEventListener(&#x27;change&#x27;, function() &#123;</span><br><span class="line">                        const selectDiv = document.getElementById(&#x27;dedupColumnSelect&#x27;);</span><br><span class="line">                        selectDiv.style.display = this.value === &#x27;selected&#x27; ? &#x27;block&#x27; : &#x27;none&#x27;;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºé‡å‘½ååˆ—æ¨¡æ€æ¡†</span><br><span class="line">            function showRenameModal() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                let modalHtml = `</span><br><span class="line">                    &lt;div class=&quot;modal fade&quot; id=&quot;renameModal&quot; tabindex=&quot;-1&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;modal-dialog modal-lg&quot;&gt;</span><br><span class="line">                            &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-header bg-primary text-white&quot;&gt;</span><br><span class="line">                                    &lt;h5 class=&quot;modal-title&quot;&gt;&lt;i class=&quot;bi bi-fonts me-2&quot;&gt;&lt;/i&gt;é‡å‘½ååˆ—&lt;/h5&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn-close btn-close-white&quot; data-bs-dismiss=&quot;modal&quot;&gt;&lt;/button&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">                                    &lt;p class=&quot;text-muted mb-3&quot;&gt;ä¸ºéœ€è¦é‡å‘½åçš„åˆ—è¾“å…¥æ–°åç§°ï¼Œç•™ç©ºè¡¨ç¤ºä¸é‡å‘½å&lt;/p&gt;</span><br><span class="line">                                    &lt;div class=&quot;table-responsive&quot; style=&quot;max-height: 400px;&quot;&gt;</span><br><span class="line">                                        &lt;table class=&quot;table table-sm&quot;&gt;</span><br><span class="line">                                            &lt;thead&gt;</span><br><span class="line">                                                &lt;tr&gt;</span><br><span class="line">                                                    &lt;th&gt;åŸåˆ—å&lt;/th&gt;</span><br><span class="line">                                                    &lt;th&gt;æ•°æ®ç±»å‹&lt;/th&gt;</span><br><span class="line">                                                    &lt;th&gt;æ–°åˆ—å&lt;/th&gt;</span><br><span class="line">                                                &lt;/tr&gt;</span><br><span class="line">                                            &lt;/thead&gt;</span><br><span class="line">                                            &lt;tbody&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                // æ·»åŠ åˆ—é‡å‘½åè¡Œ</span><br><span class="line">                currentData.info.columns.forEach(col =&gt; &#123;</span><br><span class="line">                    modalHtml += `</span><br><span class="line">                        &lt;tr&gt;</span><br><span class="line">                            &lt;td&gt;&lt;strong&gt;$&#123;col&#125;&lt;/strong&gt;&lt;/td&gt;</span><br><span class="line">                            &lt;td&gt;&lt;span class=&quot;badge bg-secondary&quot;&gt;$&#123;currentData.info.dtypes[col]&#125;&lt;/span&gt;&lt;/td&gt;</span><br><span class="line">                            &lt;td&gt;</span><br><span class="line">                                &lt;input type=&quot;text&quot; class=&quot;form-control form-control-sm rename-input&quot; </span><br><span class="line">                                       data-original=&quot;$&#123;col&#125;&quot; value=&quot;$&#123;col&#125;&quot; placeholder=&quot;è¾“å…¥æ–°åç§°&quot;&gt;</span><br><span class="line">                            &lt;/td&gt;</span><br><span class="line">                        &lt;/tr&gt;</span><br><span class="line">                    `;</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                modalHtml += `</span><br><span class="line">                                            &lt;/tbody&gt;</span><br><span class="line">                                        &lt;/table&gt;</span><br><span class="line">                                    &lt;/div&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;å–æ¶ˆ&lt;/button&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; onclick=&quot;applyRename()&quot;&gt;åº”ç”¨é‡å‘½å&lt;/button&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    </span><br><span class="line">                    &lt;script&gt;</span><br><span class="line">                    function applyRename() &#123;</span><br><span class="line">                        const renameInputs = document.querySelectorAll(&#x27;.rename-input&#x27;);</span><br><span class="line">                        const renameDict = &#123;&#125;;</span><br><span class="line">                        </span><br><span class="line">                        renameInputs.forEach(input =&gt; &#123;</span><br><span class="line">                            const original = input.dataset.original;</span><br><span class="line">                            const newName = input.value.trim();</span><br><span class="line">                            </span><br><span class="line">                            if (newName &amp;&amp; newName !== original) &#123;</span><br><span class="line">                                renameDict[original] = newName;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;);</span><br><span class="line">                        </span><br><span class="line">                        if (Object.keys(renameDict).length === 0) &#123;</span><br><span class="line">                            alert(&#x27;æ²¡æœ‰éœ€è¦é‡å‘½åçš„åˆ—&#x27;);</span><br><span class="line">                            return;</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        axios.post(&#x27;/rename-columns&#x27;, &#123; rename_dict: renameDict &#125;)</span><br><span class="line">                            .then(response =&gt; &#123;</span><br><span class="line">                                if (response.data.success) &#123;</span><br><span class="line">                                    // æ›´æ–°æ•°æ®é¢„è§ˆ</span><br><span class="line">                                    currentData = response.data.data;</span><br><span class="line">                                    updateDataPreview(currentData);</span><br><span class="line">                                    updateHistory(response.data.history);</span><br><span class="line">                                    </span><br><span class="line">                                    // å…³é—­æ¨¡æ€æ¡†</span><br><span class="line">                                    bootstrap.Modal.getInstance(document.getElementById(&#x27;renameModal&#x27;)).hide();</span><br><span class="line">                                    </span><br><span class="line">                                    // æ˜¾ç¤ºç»“æœ</span><br><span class="line">                                    showResult(&#x27;success&#x27;, &#x27;é‡å‘½åæˆåŠŸ&#x27;, response.data.message);</span><br><span class="line">                                &#125; else &#123;</span><br><span class="line">                                    showResult(&#x27;error&#x27;, &#x27;é‡å‘½åå¤±è´¥&#x27;, response.data.message);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;)</span><br><span class="line">                            .catch(error =&gt; &#123;</span><br><span class="line">                                showResult(&#x27;error&#x27;, &#x27;é‡å‘½åå¤±è´¥&#x27;, error.response?.data?.message || error.message);</span><br><span class="line">                            &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &lt;\/script&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                // åˆ›å»ºå¹¶æ˜¾ç¤ºæ¨¡æ€æ¡†</span><br><span class="line">                const modalContainer = document.createElement(&#x27;div&#x27;);</span><br><span class="line">                modalContainer.innerHTML = modalHtml;</span><br><span class="line">                document.body.appendChild(modalContainer);</span><br><span class="line">                </span><br><span class="line">                const modal = new bootstrap.Modal(document.getElementById(&#x27;renameModal&#x27;));</span><br><span class="line">                modal.show();</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºæ›´æ”¹æ•°æ®ç±»å‹æ¨¡æ€æ¡†</span><br><span class="line">            function showTypeModal() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                let modalHtml = `</span><br><span class="line">                    &lt;div class=&quot;modal fade&quot; id=&quot;typeModal&quot; tabindex=&quot;-1&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;modal-dialog modal-lg&quot;&gt;</span><br><span class="line">                            &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-header bg-primary text-white&quot;&gt;</span><br><span class="line">                                    &lt;h5 class=&quot;modal-title&quot;&gt;&lt;i class=&quot;bi bi-type me-2&quot;&gt;&lt;/i&gt;æ›´æ”¹æ•°æ®ç±»å‹&lt;/h5&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn-close btn-close-white&quot; data-bs-dismiss=&quot;modal&quot;&gt;&lt;/button&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">                                    &lt;div class=&quot;table-responsive&quot; style=&quot;max-height: 400px;&quot;&gt;</span><br><span class="line">                                        &lt;table class=&quot;table table-sm&quot;&gt;</span><br><span class="line">                                            &lt;thead&gt;</span><br><span class="line">                                                &lt;tr&gt;</span><br><span class="line">                                                    &lt;th&gt;åˆ—å&lt;/th&gt;</span><br><span class="line">                                                    &lt;th&gt;å½“å‰ç±»å‹&lt;/th&gt;</span><br><span class="line">                                                    &lt;th&gt;æ–°ç±»å‹&lt;/th&gt;</span><br><span class="line">                                                    &lt;th&gt;æ“ä½œ&lt;/th&gt;</span><br><span class="line">                                                &lt;/tr&gt;</span><br><span class="line">                                            &lt;/thead&gt;</span><br><span class="line">                                            &lt;tbody&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                // æ·»åŠ æ•°æ®ç±»å‹æ›´æ”¹è¡Œ</span><br><span class="line">                currentData.info.columns.forEach(col =&gt; &#123;</span><br><span class="line">                    const currentType = currentData.info.dtypes[col];</span><br><span class="line">                    </span><br><span class="line">                    modalHtml += `</span><br><span class="line">                        &lt;tr&gt;</span><br><span class="line">                            &lt;td&gt;&lt;strong&gt;$&#123;col&#125;&lt;/strong&gt;&lt;/td&gt;</span><br><span class="line">                            &lt;td&gt;&lt;span class=&quot;badge bg-secondary&quot;&gt;$&#123;currentType&#125;&lt;/span&gt;&lt;/td&gt;</span><br><span class="line">                            &lt;td&gt;</span><br><span class="line">                                &lt;select class=&quot;form-select form-select-sm type-select&quot; data-column=&quot;$&#123;col&#125;&quot;&gt;</span><br><span class="line">                                    &lt;option value=&quot;&quot;&gt;-- ä¸æ›´æ”¹ --&lt;/option&gt;</span><br><span class="line">                                    &lt;option value=&quot;int&quot;&gt;æ•´æ•° (int)&lt;/option&gt;</span><br><span class="line">                                    &lt;option value=&quot;float&quot;&gt;æµ®ç‚¹æ•° (float)&lt;/option&gt;</span><br><span class="line">                                    &lt;option value=&quot;str&quot;&gt;å­—ç¬¦ä¸² (str)&lt;/option&gt;</span><br><span class="line">                                    &lt;option value=&quot;datetime&quot;&gt;æ—¥æœŸæ—¶é—´ (datetime)&lt;/option&gt;</span><br><span class="line">                                    &lt;option value=&quot;category&quot;&gt;åˆ†ç±» (category)&lt;/option&gt;</span><br><span class="line">                                    &lt;option value=&quot;bool&quot;&gt;å¸ƒå°”å€¼ (bool)&lt;/option&gt;</span><br><span class="line">                                &lt;/select&gt;</span><br><span class="line">                            &lt;/td&gt;</span><br><span class="line">                            &lt;td&gt;</span><br><span class="line">                                &lt;button type=&quot;button&quot; class=&quot;btn btn-sm btn-outline-primary&quot; onclick=&quot;changeColumnType(&#x27;$&#123;col&#125;&#x27;)&quot;&gt;åº”ç”¨&lt;/button&gt;</span><br><span class="line">                            &lt;/td&gt;</span><br><span class="line">                        &lt;/tr&gt;</span><br><span class="line">                    `;</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                modalHtml += `</span><br><span class="line">                                            &lt;/tbody&gt;</span><br><span class="line">                                        &lt;/table&gt;</span><br><span class="line">                                    &lt;/div&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;å…³é—­&lt;/button&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    </span><br><span class="line">                    &lt;script&gt;</span><br><span class="line">                    function changeColumnType(column) &#123;</span><br><span class="line">                        const select = document.querySelector(\`.type-select[data-column=&quot;\$&#123;column&#125;&quot;]\`);</span><br><span class="line">                        const newType = select.value;</span><br><span class="line">                        </span><br><span class="line">                        if (!newType) &#123;</span><br><span class="line">                            alert(&#x27;è¯·é€‰æ‹©æ–°ç±»å‹&#x27;);</span><br><span class="line">                            return;</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        axios.post(&#x27;/change-column-type&#x27;, &#123; </span><br><span class="line">                            column: column, </span><br><span class="line">                            new_type: newType </span><br><span class="line">                        &#125;)</span><br><span class="line">                            .then(response =&gt; &#123;</span><br><span class="line">                                if (response.data.success) &#123;</span><br><span class="line">                                    // æ›´æ–°æ•°æ®é¢„è§ˆ</span><br><span class="line">                                    currentData = response.data.data;</span><br><span class="line">                                    updateDataPreview(currentData);</span><br><span class="line">                                    updateHistory(response.data.history);</span><br><span class="line">                                    </span><br><span class="line">                                    // æ˜¾ç¤ºç»“æœ</span><br><span class="line">                                    showResult(&#x27;success&#x27;, &#x27;ç±»å‹è½¬æ¢æˆåŠŸ&#x27;, response.data.message);</span><br><span class="line">                                &#125; else &#123;</span><br><span class="line">                                    showResult(&#x27;error&#x27;, &#x27;ç±»å‹è½¬æ¢å¤±è´¥&#x27;, response.data.message);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;)</span><br><span class="line">                            .catch(error =&gt; &#123;</span><br><span class="line">                                showResult(&#x27;error&#x27;, &#x27;ç±»å‹è½¬æ¢å¤±è´¥&#x27;, error.response?.data?.message || error.message);</span><br><span class="line">                            &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &lt;\/script&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                // åˆ›å»ºå¹¶æ˜¾ç¤ºæ¨¡æ€æ¡†</span><br><span class="line">                const modalContainer = document.createElement(&#x27;div&#x27;);</span><br><span class="line">                modalContainer.innerHTML = modalHtml;</span><br><span class="line">                document.body.appendChild(modalContainer);</span><br><span class="line">                </span><br><span class="line">                const modal = new bootstrap.Modal(document.getElementById(&#x27;typeModal&#x27;));</span><br><span class="line">                modal.show();</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºæ•°æ®è¿‡æ»¤æ¨¡æ€æ¡†</span><br><span class="line">            function showFilterModal() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                let modalHtml = `</span><br><span class="line">                    &lt;div class=&quot;modal fade&quot; id=&quot;filterModal&quot; tabindex=&quot;-1&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;modal-dialog&quot;&gt;</span><br><span class="line">                            &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-header bg-primary text-white&quot;&gt;</span><br><span class="line">                                    &lt;h5 class=&quot;modal-title&quot;&gt;&lt;i class=&quot;bi bi-funnel me-2&quot;&gt;&lt;/i&gt;æ•°æ®è¿‡æ»¤&lt;/h5&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn-close btn-close-white&quot; data-bs-dismiss=&quot;modal&quot;&gt;&lt;/button&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">                                    &lt;form id=&quot;filterForm&quot;&gt;</span><br><span class="line">                                        &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                            &lt;label class=&quot;form-label&quot;&gt;è¿‡æ»¤æ¡ä»¶&lt;/label&gt;</span><br><span class="line">                                            &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;filterCondition&quot; </span><br><span class="line">                                                   placeholder=&quot;ä¾‹å¦‚: age &gt; 18 and city == &#x27;Beijing&#x27;&quot;&gt;</span><br><span class="line">                                            &lt;div class=&quot;form-text&quot;&gt;</span><br><span class="line">                                                ä½¿ç”¨PandasæŸ¥è¯¢è¯­æ³•ã€‚ç¤ºä¾‹: </span><br><span class="line">                                                &lt;ul class=&quot;mb-0&quot;&gt;</span><br><span class="line">                                                    &lt;li&gt;&lt;code&gt;age &gt; 30&lt;/code&gt; - å¹´é¾„å¤§äº30&lt;/li&gt;</span><br><span class="line">                                                    &lt;li&gt;&lt;code&gt;salary &gt;= 5000 and department == &#x27;Sales&#x27;&lt;/code&gt; - é”€å”®éƒ¨é—¨ä¸”å·¥èµ„â‰¥5000&lt;/li&gt;</span><br><span class="line">                                                    &lt;li&gt;&lt;code&gt;name.str.contains(&#x27;John&#x27;)&lt;/code&gt; - å§“ååŒ…å«John&lt;/li&gt;</span><br><span class="line">                                                    &lt;li&gt;&lt;code&gt;date &gt; &#x27;2023-01-01&#x27;&lt;/code&gt; - æ—¥æœŸåœ¨2023å¹´ä¹‹å&lt;/li&gt;</span><br><span class="line">                                                &lt;/ul&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                        &lt;/div&gt;</span><br><span class="line">                                        </span><br><span class="line">                                        &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                            &lt;label class=&quot;form-label&quot;&gt;å¸¸ç”¨è¿‡æ»¤æ¡ä»¶&lt;/label&gt;</span><br><span class="line">                                            &lt;div class=&quot;d-flex flex-wrap gap-2&quot;&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-sm btn-outline-secondary&quot; onclick=&quot;setFilter(&#x27;age &gt; 18&#x27;)&quot;&gt;å¹´é¾„&gt;18&lt;/button&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-sm btn-outline-secondary&quot; onclick=&quot;setFilter(&#x27;salary &gt;= 5000&#x27;)&quot;&gt;å·¥èµ„â‰¥5000&lt;/button&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-sm btn-outline-secondary&quot; onclick=&quot;setFilter(&#x27;name.str.contains(\&quot;John\&quot;)&#x27;)&quot;&gt;å§“åå«John&lt;/button&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-sm btn-outline-secondary&quot; onclick=&quot;setFilter(&#x27;city in [\&quot;Beijing\&quot;, \&quot;Shanghai\&quot;]&#x27;)&quot;&gt;åŒ—äº¬æˆ–ä¸Šæµ·&lt;/button&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                        &lt;/div&gt;</span><br><span class="line">                                    &lt;/form&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;å–æ¶ˆ&lt;/button&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; onclick=&quot;applyFilter()&quot;&gt;åº”ç”¨è¿‡æ»¤&lt;/button&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    </span><br><span class="line">                    &lt;script&gt;</span><br><span class="line">                    function setFilter(condition) &#123;</span><br><span class="line">                        document.getElementById(&#x27;filterCondition&#x27;).value = condition;</span><br><span class="line">                    &#125;</span><br><span class="line">                    </span><br><span class="line">                    function applyFilter() &#123;</span><br><span class="line">                        const condition = document.getElementById(&#x27;filterCondition&#x27;).value.trim();</span><br><span class="line">                        </span><br><span class="line">                        if (!condition) &#123;</span><br><span class="line">                            alert(&#x27;è¯·è¾“å…¥è¿‡æ»¤æ¡ä»¶&#x27;);</span><br><span class="line">                            return;</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        axios.post(&#x27;/filter-data&#x27;, &#123; condition: condition &#125;)</span><br><span class="line">                            .then(response =&gt; &#123;</span><br><span class="line">                                if (response.data.success) &#123;</span><br><span class="line">                                    // æ›´æ–°æ•°æ®é¢„è§ˆ</span><br><span class="line">                                    currentData = response.data.data;</span><br><span class="line">                                    updateDataPreview(currentData);</span><br><span class="line">                                    updateHistory(response.data.history);</span><br><span class="line">                                    </span><br><span class="line">                                    // å…³é—­æ¨¡æ€æ¡†</span><br><span class="line">                                    bootstrap.Modal.getInstance(document.getElementById(&#x27;filterModal&#x27;)).hide();</span><br><span class="line">                                    </span><br><span class="line">                                    // æ˜¾ç¤ºç»“æœ</span><br><span class="line">                                    showResult(&#x27;success&#x27;, &#x27;è¿‡æ»¤æˆåŠŸ&#x27;, response.data.message);</span><br><span class="line">                                &#125; else &#123;</span><br><span class="line">                                    showResult(&#x27;error&#x27;, &#x27;è¿‡æ»¤å¤±è´¥&#x27;, response.data.message);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;)</span><br><span class="line">                            .catch(error =&gt; &#123;</span><br><span class="line">                                showResult(&#x27;error&#x27;, &#x27;è¿‡æ»¤å¤±è´¥&#x27;, error.response?.data?.message || error.message);</span><br><span class="line">                            &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &lt;\/script&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                // åˆ›å»ºå¹¶æ˜¾ç¤ºæ¨¡æ€æ¡†</span><br><span class="line">                const modalContainer = document.createElement(&#x27;div&#x27;);</span><br><span class="line">                modalContainer.innerHTML = modalHtml;</span><br><span class="line">                document.body.appendChild(modalContainer);</span><br><span class="line">                </span><br><span class="line">                const modal = new bootstrap.Modal(document.getElementById(&#x27;filterModal&#x27;));</span><br><span class="line">                modal.show();</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºåˆ é™¤åˆ—æ¨¡æ€æ¡†</span><br><span class="line">            function showDropModal() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                let modalHtml = `</span><br><span class="line">                    &lt;div class=&quot;modal fade&quot; id=&quot;dropModal&quot; tabindex=&quot;-1&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;modal-dialog modal-lg&quot;&gt;</span><br><span class="line">                            &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-header bg-primary text-white&quot;&gt;</span><br><span class="line">                                    &lt;h5 class=&quot;modal-title&quot;&gt;&lt;i class=&quot;bi bi-trash me-2&quot;&gt;&lt;/i&gt;åˆ é™¤åˆ—&lt;/h5&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn-close btn-close-white&quot; data-bs-dismiss=&quot;modal&quot;&gt;&lt;/button&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">                                    &lt;p class=&quot;text-muted mb-3&quot;&gt;é€‰æ‹©è¦åˆ é™¤çš„åˆ—ï¼š&lt;/p&gt;</span><br><span class="line">                                    &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                // åˆ†ç»„æ˜¾ç¤ºåˆ—</span><br><span class="line">                const columns = currentData.info.columns;</span><br><span class="line">                const chunkSize = Math.ceil(columns.length / 3);</span><br><span class="line">                </span><br><span class="line">                for (let i = 0; i &lt; 3; i++) &#123;</span><br><span class="line">                    modalHtml += &#x27;&lt;div class=&quot;col-md-4&quot;&gt;&#x27;;</span><br><span class="line">                    const start = i * chunkSize;</span><br><span class="line">                    const end = Math.min(start + chunkSize, columns.length);</span><br><span class="line">                    </span><br><span class="line">                    for (let j = start; j &lt; end; j++) &#123;</span><br><span class="line">                        const col = columns[j];</span><br><span class="line">                        modalHtml += `</span><br><span class="line">                            &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                                &lt;input class=&quot;form-check-input drop-col-check&quot; type=&quot;checkbox&quot; value=&quot;$&#123;col&#125;&quot; id=&quot;drop_col_$&#123;col&#125;&quot;&gt;</span><br><span class="line">                                &lt;label class=&quot;form-check-label&quot; for=&quot;drop_col_$&#123;col&#125;&quot;&gt;</span><br><span class="line">                                    $&#123;col&#125; &lt;small class=&quot;text-muted&quot;&gt;($&#123;currentData.info.dtypes[col]&#125;)&lt;/small&gt;</span><br><span class="line">                                &lt;/label&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        `;</span><br><span class="line">                    &#125;</span><br><span class="line">                    modalHtml += &#x27;&lt;/div&gt;&#x27;;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                modalHtml += `</span><br><span class="line">                                    &lt;/div&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;å–æ¶ˆ&lt;/button&gt;</span><br><span class="line">                                    &lt;button type=&quot;button&quot; class=&quot;btn btn-danger&quot; onclick=&quot;applyDrop()&quot;&gt;åˆ é™¤é€‰ä¸­åˆ—&lt;/button&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    </span><br><span class="line">                    &lt;script&gt;</span><br><span class="line">                    function applyDrop() &#123;</span><br><span class="line">                        const selectedCols = Array.from(document.querySelectorAll(&#x27;.drop-col-check:checked&#x27;))</span><br><span class="line">                            .map(cb =&gt; cb.value);</span><br><span class="line">                        </span><br><span class="line">                        if (selectedCols.length === 0) &#123;</span><br><span class="line">                            alert(&#x27;è¯·è‡³å°‘é€‰æ‹©ä¸€åˆ—&#x27;);</span><br><span class="line">                            return;</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        if (selectedCols.length === currentData.info.columns.length) &#123;</span><br><span class="line">                            if (!confirm(&#x27;æ‚¨é€‰æ‹©äº†æ‰€æœ‰åˆ—ï¼Œåˆ é™¤åå°†æ²¡æœ‰æ•°æ®ã€‚ç¡®å®šè¦ç»§ç»­å—ï¼Ÿ&#x27;)) &#123;</span><br><span class="line">                                return;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        axios.post(&#x27;/drop-columns&#x27;, &#123; columns: selectedCols &#125;)</span><br><span class="line">                            .then(response =&gt; &#123;</span><br><span class="line">                                if (response.data.success) &#123;</span><br><span class="line">                                    // æ›´æ–°æ•°æ®é¢„è§ˆ</span><br><span class="line">                                    currentData = response.data.data;</span><br><span class="line">                                    updateDataPreview(currentData);</span><br><span class="line">                                    updateHistory(response.data.history);</span><br><span class="line">                                    </span><br><span class="line">                                    // å…³é—­æ¨¡æ€æ¡†</span><br><span class="line">                                    bootstrap.Modal.getInstance(document.getElementById(&#x27;dropModal&#x27;)).hide();</span><br><span class="line">                                    </span><br><span class="line">                                    // æ˜¾ç¤ºç»“æœ</span><br><span class="line">                                    showResult(&#x27;success&#x27;, &#x27;åˆ é™¤æˆåŠŸ&#x27;, response.data.message);</span><br><span class="line">                                &#125; else &#123;</span><br><span class="line">                                    showResult(&#x27;error&#x27;, &#x27;åˆ é™¤å¤±è´¥&#x27;, response.data.message);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;)</span><br><span class="line">                            .catch(error =&gt; &#123;</span><br><span class="line">                                showResult(&#x27;error&#x27;, &#x27;åˆ é™¤å¤±è´¥&#x27;, error.response?.data?.message || error.message);</span><br><span class="line">                            &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &lt;\/script&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                // åˆ›å»ºå¹¶æ˜¾ç¤ºæ¨¡æ€æ¡†</span><br><span class="line">                const modalContainer = document.createElement(&#x27;div&#x27;);</span><br><span class="line">                modalContainer.innerHTML = modalHtml;</span><br><span class="line">                document.body.appendChild(modalContainer);</span><br><span class="line">                </span><br><span class="line">                const modal = new bootstrap.Modal(document.getElementById(&#x27;dropModal&#x27;));</span><br><span class="line">                modal.show();</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºæ ‡å‡†åŒ–æ¨¡æ€æ¡†</span><br><span class="line">            function showNormalizeModal() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                // è·å–æ•°å€¼åˆ—</span><br><span class="line">                axios.get(&#x27;/numeric-columns&#x27;)</span><br><span class="line">                    .then(response =&gt; &#123;</span><br><span class="line">                        if (response.data.success) &#123;</span><br><span class="line">                            const numericCols = response.data.columns;</span><br><span class="line">                            </span><br><span class="line">                            if (numericCols.length === 0) &#123;</span><br><span class="line">                                showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;æ²¡æœ‰æ•°å€¼åˆ—å¯ä»¥æ ‡å‡†åŒ–&#x27;);</span><br><span class="line">                                return;</span><br><span class="line">                            &#125;</span><br><span class="line">                            </span><br><span class="line">                            let modalHtml = `</span><br><span class="line">                                &lt;div class=&quot;modal fade&quot; id=&quot;normalizeModal&quot; tabindex=&quot;-1&quot;&gt;</span><br><span class="line">                                    &lt;div class=&quot;modal-dialog&quot;&gt;</span><br><span class="line">                                        &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-header bg-primary text-white&quot;&gt;</span><br><span class="line">                                                &lt;h5 class=&quot;modal-title&quot;&gt;&lt;i class=&quot;bi bi-sliders me-2&quot;&gt;&lt;/i&gt;æ•°æ®æ ‡å‡†åŒ–&lt;/h5&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn-close btn-close-white&quot; data-bs-dismiss=&quot;modal&quot;&gt;&lt;/button&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">                                                &lt;form id=&quot;normalizeForm&quot;&gt;</span><br><span class="line">                                                    &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                                        &lt;label class=&quot;form-label&quot;&gt;é€‰æ‹©åˆ—&lt;/label&gt;</span><br><span class="line">                                                        &lt;select class=&quot;form-select&quot; id=&quot;normalizeColumn&quot;&gt;</span><br><span class="line">                            `;</span><br><span class="line">                            </span><br><span class="line">                            numericCols.forEach(col =&gt; &#123;</span><br><span class="line">                                modalHtml += `&lt;option value=&quot;$&#123;col&#125;&quot;&gt;$&#123;col&#125;&lt;/option&gt;`;</span><br><span class="line">                            &#125;);</span><br><span class="line">                            </span><br><span class="line">                            modalHtml += `</span><br><span class="line">                                                        &lt;/select&gt;</span><br><span class="line">                                                    &lt;/div&gt;</span><br><span class="line">                                                    </span><br><span class="line">                                                    &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                                        &lt;label class=&quot;form-label&quot;&gt;æ ‡å‡†åŒ–æ–¹æ³•&lt;/label&gt;</span><br><span class="line">                                                        &lt;select class=&quot;form-select&quot; id=&quot;normalizeMethod&quot;&gt;</span><br><span class="line">                                                            &lt;option value=&quot;minmax&quot;&gt;Min-Maxæ ‡å‡†åŒ– (0-1èŒƒå›´)&lt;/option&gt;</span><br><span class="line">                                                            &lt;option value=&quot;zscore&quot;&gt;Z-Scoreæ ‡å‡†åŒ– (å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1)&lt;/option&gt;</span><br><span class="line">                                                            &lt;option value=&quot;log&quot;&gt;å¯¹æ•°å˜æ¢ (å¤„ç†åæ€åˆ†å¸ƒ)&lt;/option&gt;</span><br><span class="line">                                                        &lt;/select&gt;</span><br><span class="line">                                                    &lt;/div&gt;</span><br><span class="line">                                                &lt;/form&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;å–æ¶ˆ&lt;/button&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; onclick=&quot;applyNormalize()&quot;&gt;åº”ç”¨æ ‡å‡†åŒ–&lt;/button&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                        &lt;/div&gt;</span><br><span class="line">                                    &lt;/div&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                </span><br><span class="line">                                &lt;script&gt;</span><br><span class="line">                                function applyNormalize() &#123;</span><br><span class="line">                                    const column = document.getElementById(&#x27;normalizeColumn&#x27;).value;</span><br><span class="line">                                    const method = document.getElementById(&#x27;normalizeMethod&#x27;).value;</span><br><span class="line">                                    </span><br><span class="line">                                    axios.post(&#x27;/normalize-column&#x27;, &#123; </span><br><span class="line">                                        column: column, </span><br><span class="line">                                        method: method </span><br><span class="line">                                    &#125;)</span><br><span class="line">                                        .then(response =&gt; &#123;</span><br><span class="line">                                            if (response.data.success) &#123;</span><br><span class="line">                                                // æ›´æ–°æ•°æ®é¢„è§ˆ</span><br><span class="line">                                                currentData = response.data.data;</span><br><span class="line">                                                updateDataPreview(currentData);</span><br><span class="line">                                                updateHistory(response.data.history);</span><br><span class="line">                                                </span><br><span class="line">                                                // å…³é—­æ¨¡æ€æ¡†</span><br><span class="line">                                                bootstrap.Modal.getInstance(document.getElementById(&#x27;normalizeModal&#x27;)).hide();</span><br><span class="line">                                                </span><br><span class="line">                                                // æ˜¾ç¤ºç»“æœ</span><br><span class="line">                                                showResult(&#x27;success&#x27;, &#x27;æ ‡å‡†åŒ–æˆåŠŸ&#x27;, response.data.message);</span><br><span class="line">                                            &#125; else &#123;</span><br><span class="line">                                                showResult(&#x27;error&#x27;, &#x27;æ ‡å‡†åŒ–å¤±è´¥&#x27;, response.data.message);</span><br><span class="line">                                            &#125;</span><br><span class="line">                                        &#125;)</span><br><span class="line">                                        .catch(error =&gt; &#123;</span><br><span class="line">                                            showResult(&#x27;error&#x27;, &#x27;æ ‡å‡†åŒ–å¤±è´¥&#x27;, error.response?.data?.message || error.message);</span><br><span class="line">                                        &#125;);</span><br><span class="line">                                &#125;</span><br><span class="line">                                &lt;\/script&gt;</span><br><span class="line">                            `;</span><br><span class="line">                            </span><br><span class="line">                            // åˆ›å»ºå¹¶æ˜¾ç¤ºæ¨¡æ€æ¡†</span><br><span class="line">                            const modalContainer = document.createElement(&#x27;div&#x27;);</span><br><span class="line">                            modalContainer.innerHTML = modalHtml;</span><br><span class="line">                            document.body.appendChild(modalContainer);</span><br><span class="line">                            </span><br><span class="line">                            const modal = new bootstrap.Modal(document.getElementById(&#x27;normalizeModal&#x27;));</span><br><span class="line">                            modal.show();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .catch(error =&gt; &#123;</span><br><span class="line">                        showResult(&#x27;error&#x27;, &#x27;è·å–æ•°å€¼åˆ—å¤±è´¥&#x27;, error.message);</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºå¼‚å¸¸å€¼å¤„ç†æ¨¡æ€æ¡†</span><br><span class="line">            function showOutlierModal() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                // è·å–æ•°å€¼åˆ—</span><br><span class="line">                axios.get(&#x27;/numeric-columns&#x27;)</span><br><span class="line">                    .then(response =&gt; &#123;</span><br><span class="line">                        if (response.data.success) &#123;</span><br><span class="line">                            const numericCols = response.data.columns;</span><br><span class="line">                            </span><br><span class="line">                            if (numericCols.length === 0) &#123;</span><br><span class="line">                                showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;æ²¡æœ‰æ•°å€¼åˆ—å¯ä»¥å¤„ç†å¼‚å¸¸å€¼&#x27;);</span><br><span class="line">                                return;</span><br><span class="line">                            &#125;</span><br><span class="line">                            </span><br><span class="line">                            let modalHtml = `</span><br><span class="line">                                &lt;div class=&quot;modal fade&quot; id=&quot;outlierModal&quot; tabindex=&quot;-1&quot;&gt;</span><br><span class="line">                                    &lt;div class=&quot;modal-dialog&quot;&gt;</span><br><span class="line">                                        &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-header bg-primary text-white&quot;&gt;</span><br><span class="line">                                                &lt;h5 class=&quot;modal-title&quot;&gt;&lt;i class=&quot;bi bi-exclamation-triangle me-2&quot;&gt;&lt;/i&gt;å¤„ç†å¼‚å¸¸å€¼&lt;/h5&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn-close btn-close-white&quot; data-bs-dismiss=&quot;modal&quot;&gt;&lt;/button&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">                                                &lt;form id=&quot;outlierForm&quot;&gt;</span><br><span class="line">                                                    &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                                        &lt;label class=&quot;form-label&quot;&gt;é€‰æ‹©åˆ—&lt;/label&gt;</span><br><span class="line">                                                        &lt;select class=&quot;form-select&quot; id=&quot;outlierColumn&quot;&gt;</span><br><span class="line">                            `;</span><br><span class="line">                            </span><br><span class="line">                            numericCols.forEach(col =&gt; &#123;</span><br><span class="line">                                modalHtml += `&lt;option value=&quot;$&#123;col&#125;&quot;&gt;$&#123;col&#125;&lt;/option&gt;`;</span><br><span class="line">                            &#125;);</span><br><span class="line">                            </span><br><span class="line">                            modalHtml += `</span><br><span class="line">                                                        &lt;/select&gt;</span><br><span class="line">                                                    &lt;/div&gt;</span><br><span class="line">                                                    </span><br><span class="line">                                                    &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                                        &lt;label class=&quot;form-label&quot;&gt;å¤„ç†æ–¹æ³•&lt;/label&gt;</span><br><span class="line">                                                        &lt;select class=&quot;form-select&quot; id=&quot;outlierMethod&quot; onchange=&quot;updateOutlierOptions()&quot;&gt;</span><br><span class="line">                                                            &lt;option value=&quot;iqr&quot;&gt;IQRæ–¹æ³• (æ›¿æ¢ä¸ºè¾¹ç•Œå€¼)&lt;/option&gt;</span><br><span class="line">                                                            &lt;option value=&quot;zscore&quot;&gt;Z-Scoreæ–¹æ³• (æ›¿æ¢ä¸ºå‡å€¼)&lt;/option&gt;</span><br><span class="line">                                                            &lt;option value=&quot;remove&quot;&gt;ç›´æ¥ç§»é™¤å¼‚å¸¸å€¼&lt;/option&gt;</span><br><span class="line">                                                        &lt;/select&gt;</span><br><span class="line">                                                    &lt;/div&gt;</span><br><span class="line">                                                    </span><br><span class="line">                                                    &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                                        &lt;label class=&quot;form-label&quot;&gt;é˜ˆå€¼&lt;/label&gt;</span><br><span class="line">                                                        &lt;input type=&quot;range&quot; class=&quot;form-range&quot; id=&quot;outlierThreshold&quot; min=&quot;1.0&quot; max=&quot;5.0&quot; step=&quot;0.5&quot; value=&quot;1.5&quot;&gt;</span><br><span class="line">                                                        &lt;div class=&quot;d-flex justify-content-between&quot;&gt;</span><br><span class="line">                                                            &lt;small&gt;1.0&lt;/small&gt;</span><br><span class="line">                                                            &lt;small id=&quot;thresholdValue&quot;&gt;1.5&lt;/small&gt;</span><br><span class="line">                                                            &lt;small&gt;5.0&lt;/small&gt;</span><br><span class="line">                                                        &lt;/div&gt;</span><br><span class="line">                                                        &lt;div class=&quot;form-text&quot;&gt;</span><br><span class="line">                                                            IQRæ–¹æ³•: é€šå¸¸ä½¿ç”¨1.5 (ä¸­ç­‰æ•æ„Ÿ) æˆ– 3.0 (è¾ƒä¸æ•æ„Ÿ)</span><br><span class="line">                                                            Z-Scoreæ–¹æ³•: é€šå¸¸ä½¿ç”¨2æˆ–3ä½œä¸ºé˜ˆå€¼</span><br><span class="line">                                                        &lt;/div&gt;</span><br><span class="line">                                                    &lt;/div&gt;</span><br><span class="line">                                                &lt;/form&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;å–æ¶ˆ&lt;/button&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; onclick=&quot;applyOutlierHandling()&quot;&gt;å¤„ç†å¼‚å¸¸å€¼&lt;/button&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                        &lt;/div&gt;</span><br><span class="line">                                    &lt;/div&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                </span><br><span class="line">                                &lt;script&gt;</span><br><span class="line">                                function updateOutlierOptions() &#123;</span><br><span class="line">                                    const method = document.getElementById(&#x27;outlierMethod&#x27;).value;</span><br><span class="line">                                    const thresholdSlider = document.getElementById(&#x27;outlierThreshold&#x27;);</span><br><span class="line">                                    </span><br><span class="line">                                    if (method === &#x27;zscore&#x27;) &#123;</span><br><span class="line">                                        thresholdSlider.min = 2;</span><br><span class="line">                                        thresholdSlider.max = 5;</span><br><span class="line">                                        thresholdSlider.step = 0.5;</span><br><span class="line">                                        thresholdSlider.value = 3;</span><br><span class="line">                                    &#125; else &#123;</span><br><span class="line">                                        thresholdSlider.min = 1.0;</span><br><span class="line">                                        thresholdSlider.max = 5.0;</span><br><span class="line">                                        thresholdSlider.step = 0.5;</span><br><span class="line">                                        thresholdSlider.value = 1.5;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    document.getElementById(&#x27;thresholdValue&#x27;).textContent = thresholdSlider.value;</span><br><span class="line">                                &#125;</span><br><span class="line">                                </span><br><span class="line">                                function applyOutlierHandling() &#123;</span><br><span class="line">                                    const column = document.getElementById(&#x27;outlierColumn&#x27;).value;</span><br><span class="line">                                    const method = document.getElementById(&#x27;outlierMethod&#x27;).value;</span><br><span class="line">                                    const threshold = parseFloat(document.getElementById(&#x27;outlierThreshold&#x27;).value);</span><br><span class="line">                                    </span><br><span class="line">                                    axios.post(&#x27;/handle-outliers&#x27;, &#123; </span><br><span class="line">                                        column: column, </span><br><span class="line">                                        method: method,</span><br><span class="line">                                        threshold: threshold</span><br><span class="line">                                    &#125;)</span><br><span class="line">                                        .then(response =&gt; &#123;</span><br><span class="line">                                            if (response.data.success) &#123;</span><br><span class="line">                                                // æ›´æ–°æ•°æ®é¢„è§ˆ</span><br><span class="line">                                                currentData = response.data.data;</span><br><span class="line">                                                updateDataPreview(currentData);</span><br><span class="line">                                                updateHistory(response.data.history);</span><br><span class="line">                                                </span><br><span class="line">                                                // å…³é—­æ¨¡æ€æ¡†</span><br><span class="line">                                                bootstrap.Modal.getInstance(document.getElementById(&#x27;outlierModal&#x27;)).hide();</span><br><span class="line">                                                </span><br><span class="line">                                                // æ˜¾ç¤ºç»“æœ</span><br><span class="line">                                                showResult(&#x27;success&#x27;, &#x27;å¼‚å¸¸å€¼å¤„ç†æˆåŠŸ&#x27;, response.data.message);</span><br><span class="line">                                            &#125; else &#123;</span><br><span class="line">                                                showResult(&#x27;error&#x27;, &#x27;å¼‚å¸¸å€¼å¤„ç†å¤±è´¥&#x27;, response.data.message);</span><br><span class="line">                                            &#125;</span><br><span class="line">                                        &#125;)</span><br><span class="line">                                        .catch(error =&gt; &#123;</span><br><span class="line">                                            showResult(&#x27;error&#x27;, &#x27;å¼‚å¸¸å€¼å¤„ç†å¤±è´¥&#x27;, error.response?.data?.message || error.message);</span><br><span class="line">                                        &#125;);</span><br><span class="line">                                &#125;</span><br><span class="line">                                </span><br><span class="line">                                // åˆå§‹åŒ–é˜ˆå€¼æ˜¾ç¤º</span><br><span class="line">                                document.getElementById(&#x27;outlierThreshold&#x27;).addEventListener(&#x27;input&#x27;, function() &#123;</span><br><span class="line">                                    document.getElementById(&#x27;thresholdValue&#x27;).textContent = this.value;</span><br><span class="line">                                &#125;);</span><br><span class="line">                                &lt;\/script&gt;</span><br><span class="line">                            `;</span><br><span class="line">                            </span><br><span class="line">                            // åˆ›å»ºå¹¶æ˜¾ç¤ºæ¨¡æ€æ¡†</span><br><span class="line">                            const modalContainer = document.createElement(&#x27;div&#x27;);</span><br><span class="line">                            modalContainer.innerHTML = modalHtml;</span><br><span class="line">                            document.body.appendChild(modalContainer);</span><br><span class="line">                            </span><br><span class="line">                            const modal = new bootstrap.Modal(document.getElementById(&#x27;outlierModal&#x27;));</span><br><span class="line">                            modal.show();</span><br><span class="line">                            </span><br><span class="line">                            // åˆå§‹åŒ–é˜ˆå€¼æ˜¾ç¤º</span><br><span class="line">                            const thresholdSlider = document.getElementById(&#x27;outlierThreshold&#x27;);</span><br><span class="line">                            thresholdSlider.addEventListener(&#x27;input&#x27;, function() &#123;</span><br><span class="line">                                document.getElementById(&#x27;thresholdValue&#x27;).textContent = this.value;</span><br><span class="line">                            &#125;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .catch(error =&gt; &#123;</span><br><span class="line">                        showResult(&#x27;error&#x27;, &#x27;è·å–æ•°å€¼åˆ—å¤±è´¥&#x27;, error.message);</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºç¼–ç æ¨¡æ€æ¡†</span><br><span class="line">            function showEncodeModal() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                // è·å–åˆ†ç±»åˆ—</span><br><span class="line">                axios.get(&#x27;/categorical-columns&#x27;)</span><br><span class="line">                    .then(response =&gt; &#123;</span><br><span class="line">                        if (response.data.success) &#123;</span><br><span class="line">                            const categoricalCols = response.data.columns;</span><br><span class="line">                            </span><br><span class="line">                            if (categoricalCols.length === 0) &#123;</span><br><span class="line">                                showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;æ²¡æœ‰åˆ†ç±»åˆ—å¯ä»¥ç¼–ç &#x27;);</span><br><span class="line">                                return;</span><br><span class="line">                            &#125;</span><br><span class="line">                            </span><br><span class="line">                            let modalHtml = `</span><br><span class="line">                                &lt;div class=&quot;modal fade&quot; id=&quot;encodeModal&quot; tabindex=&quot;-1&quot;&gt;</span><br><span class="line">                                    &lt;div class=&quot;modal-dialog&quot;&gt;</span><br><span class="line">                                        &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-header bg-primary text-white&quot;&gt;</span><br><span class="line">                                                &lt;h5 class=&quot;modal-title&quot;&gt;&lt;i class=&quot;bi bi-code me-2&quot;&gt;&lt;/i&gt;ç¼–ç åˆ†ç±»å˜é‡&lt;/h5&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn-close btn-close-white&quot; data-bs-dismiss=&quot;modal&quot;&gt;&lt;/button&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">                                                &lt;form id=&quot;encodeForm&quot;&gt;</span><br><span class="line">                                                    &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                                        &lt;label class=&quot;form-label&quot;&gt;é€‰æ‹©åˆ—&lt;/label&gt;</span><br><span class="line">                                                        &lt;select class=&quot;form-select&quot; id=&quot;encodeColumn&quot;&gt;</span><br><span class="line">                            `;</span><br><span class="line">                            </span><br><span class="line">                            categoricalCols.forEach(col =&gt; &#123;</span><br><span class="line">                                modalHtml += `&lt;option value=&quot;$&#123;col&#125;&quot;&gt;$&#123;col&#125;&lt;/option&gt;`;</span><br><span class="line">                            &#125;);</span><br><span class="line">                            </span><br><span class="line">                            modalHtml += `</span><br><span class="line">                                                        &lt;/select&gt;</span><br><span class="line">                                                    &lt;/div&gt;</span><br><span class="line">                                                    </span><br><span class="line">                                                    &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                                        &lt;label class=&quot;form-label&quot;&gt;ç¼–ç æ–¹æ³•&lt;/label&gt;</span><br><span class="line">                                                        &lt;select class=&quot;form-select&quot; id=&quot;encodeMethod&quot;&gt;</span><br><span class="line">                                                            &lt;option value=&quot;onehot&quot;&gt;One-Hotç¼–ç  (åˆ›å»ºè™šæ‹Ÿå˜é‡)&lt;/option&gt;</span><br><span class="line">                                                            &lt;option value=&quot;label&quot;&gt;Labelç¼–ç  (æ•´æ•°ç¼–ç )&lt;/option&gt;</span><br><span class="line">                                                            &lt;option value=&quot;frequency&quot;&gt;é¢‘ç‡ç¼–ç  (æŒ‰é¢‘ç‡ç¼–ç )&lt;/option&gt;</span><br><span class="line">                                                        &lt;/select&gt;</span><br><span class="line">                                                        &lt;div class=&quot;form-text&quot;&gt;</span><br><span class="line">                                                            One-Hotç¼–ç : é€‚åˆæ— åºåˆ†ç±»å˜é‡ï¼Œä½†å¯èƒ½äº§ç”Ÿå¤§é‡æ–°åˆ—</span><br><span class="line">                                                            Labelç¼–ç : é€‚åˆæœ‰åºåˆ†ç±»å˜é‡æˆ–æ ‘æ¨¡å‹</span><br><span class="line">                                                            é¢‘ç‡ç¼–ç : é€‚åˆé«˜åŸºæ•°åˆ†ç±»å˜é‡</span><br><span class="line">                                                        &lt;/div&gt;</span><br><span class="line">                                                    &lt;/div&gt;</span><br><span class="line">                                                &lt;/form&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;å–æ¶ˆ&lt;/button&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; onclick=&quot;applyEncode()&quot;&gt;åº”ç”¨ç¼–ç &lt;/button&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                        &lt;/div&gt;</span><br><span class="line">                                    &lt;/div&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                </span><br><span class="line">                                &lt;script&gt;</span><br><span class="line">                                function applyEncode() &#123;</span><br><span class="line">                                    const column = document.getElementById(&#x27;encodeColumn&#x27;).value;</span><br><span class="line">                                    const method = document.getElementById(&#x27;encodeMethod&#x27;).value;</span><br><span class="line">                                    </span><br><span class="line">                                    axios.post(&#x27;/encode-categorical&#x27;, &#123; </span><br><span class="line">                                        column: column, </span><br><span class="line">                                        method: method </span><br><span class="line">                                    &#125;)</span><br><span class="line">                                        .then(response =&gt; &#123;</span><br><span class="line">                                            if (response.data.success) &#123;</span><br><span class="line">                                                // æ›´æ–°æ•°æ®é¢„è§ˆ</span><br><span class="line">                                                currentData = response.data.data;</span><br><span class="line">                                                updateDataPreview(currentData);</span><br><span class="line">                                                updateHistory(response.data.history);</span><br><span class="line">                                                </span><br><span class="line">                                                // å…³é—­æ¨¡æ€æ¡†</span><br><span class="line">                                                bootstrap.Modal.getInstance(document.getElementById(&#x27;encodeModal&#x27;)).hide();</span><br><span class="line">                                                </span><br><span class="line">                                                // æ˜¾ç¤ºç»“æœ</span><br><span class="line">                                                showResult(&#x27;success&#x27;, &#x27;ç¼–ç æˆåŠŸ&#x27;, response.data.message);</span><br><span class="line">                                            &#125; else &#123;</span><br><span class="line">                                                showResult(&#x27;error&#x27;, &#x27;ç¼–ç å¤±è´¥&#x27;, response.data.message);</span><br><span class="line">                                            &#125;</span><br><span class="line">                                        &#125;)</span><br><span class="line">                                        .catch(error =&gt; &#123;</span><br><span class="line">                                            showResult(&#x27;error&#x27;, &#x27;ç¼–ç å¤±è´¥&#x27;, error.response?.data?.message || error.message);</span><br><span class="line">                                        &#125;);</span><br><span class="line">                                &#125;</span><br><span class="line">                                &lt;\/script&gt;</span><br><span class="line">                            `;</span><br><span class="line">                            </span><br><span class="line">                            // åˆ›å»ºå¹¶æ˜¾ç¤ºæ¨¡æ€æ¡†</span><br><span class="line">                            const modalContainer = document.createElement(&#x27;div&#x27;);</span><br><span class="line">                            modalContainer.innerHTML = modalHtml;</span><br><span class="line">                            document.body.appendChild(modalContainer);</span><br><span class="line">                            </span><br><span class="line">                            const modal = new bootstrap.Modal(document.getElementById(&#x27;encodeModal&#x27;));</span><br><span class="line">                            modal.show();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .catch(error =&gt; &#123;</span><br><span class="line">                        showResult(&#x27;error&#x27;, &#x27;è·å–åˆ†ç±»åˆ—å¤±è´¥&#x27;, error.message);</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºæ—¥æœŸç‰¹å¾æå–æ¨¡æ€æ¡†</span><br><span class="line">            function showDateModal() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                // è·å–å¯èƒ½æ˜¯æ—¥æœŸçš„åˆ—</span><br><span class="line">                axios.get(&#x27;/date-columns&#x27;)</span><br><span class="line">                    .then(response =&gt; &#123;</span><br><span class="line">                        if (response.data.success) &#123;</span><br><span class="line">                            const dateCols = response.data.columns;</span><br><span class="line">                            </span><br><span class="line">                            if (dateCols.length === 0) &#123;</span><br><span class="line">                                showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;æ²¡æœ‰å¯èƒ½æ˜¯æ—¥æœŸçš„åˆ—&#x27;);</span><br><span class="line">                                return;</span><br><span class="line">                            &#125;</span><br><span class="line">                            </span><br><span class="line">                            let modalHtml = `</span><br><span class="line">                                &lt;div class=&quot;modal fade&quot; id=&quot;dateModal&quot; tabindex=&quot;-1&quot;&gt;</span><br><span class="line">                                    &lt;div class=&quot;modal-dialog&quot;&gt;</span><br><span class="line">                                        &lt;div class=&quot;modal-content&quot;&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-header bg-primary text-white&quot;&gt;</span><br><span class="line">                                                &lt;h5 class=&quot;modal-title&quot;&gt;&lt;i class=&quot;bi bi-calendar me-2&quot;&gt;&lt;/i&gt;æå–æ—¥æœŸç‰¹å¾&lt;/h5&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn-close btn-close-white&quot; data-bs-dismiss=&quot;modal&quot;&gt;&lt;/button&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-body&quot;&gt;</span><br><span class="line">                                                &lt;form id=&quot;dateForm&quot;&gt;</span><br><span class="line">                                                    &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                                        &lt;label class=&quot;form-label&quot;&gt;é€‰æ‹©æ—¥æœŸåˆ—&lt;/label&gt;</span><br><span class="line">                                                        &lt;select class=&quot;form-select&quot; id=&quot;dateColumn&quot;&gt;</span><br><span class="line">                            `;</span><br><span class="line">                            </span><br><span class="line">                            dateCols.forEach(col =&gt; &#123;</span><br><span class="line">                                modalHtml += `&lt;option value=&quot;$&#123;col&#125;&quot;&gt;$&#123;col&#125;&lt;/option&gt;`;</span><br><span class="line">                            &#125;);</span><br><span class="line">                            </span><br><span class="line">                            modalHtml += `</span><br><span class="line">                                                        &lt;/select&gt;</span><br><span class="line">                                                    &lt;/div&gt;</span><br><span class="line">                                                    </span><br><span class="line">                                                    &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                                        &lt;label class=&quot;form-label&quot;&gt;è¦æå–çš„ç‰¹å¾&lt;/label&gt;</span><br><span class="line">                                                        &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                                                            &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; id=&quot;yearFeature&quot; checked&gt;</span><br><span class="line">                                                            &lt;label class=&quot;form-check-label&quot; for=&quot;yearFeature&quot;&gt;å¹´ä»½&lt;/label&gt;</span><br><span class="line">                                                        &lt;/div&gt;</span><br><span class="line">                                                        &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                                                            &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; id=&quot;monthFeature&quot; checked&gt;</span><br><span class="line">                                                            &lt;label class=&quot;form-check-label&quot; for=&quot;monthFeature&quot;&gt;æœˆä»½&lt;/label&gt;</span><br><span class="line">                                                        &lt;/div&gt;</span><br><span class="line">                                                        &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                                                            &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; id=&quot;dayFeature&quot; checked&gt;</span><br><span class="line">                                                            &lt;label class=&quot;form-check-label&quot; for=&quot;dayFeature&quot;&gt;æ—¥&lt;/label&gt;</span><br><span class="line">                                                        &lt;/div&gt;</span><br><span class="line">                                                        &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                                                            &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; id=&quot;weekdayFeature&quot;&gt;</span><br><span class="line">                                                            &lt;label class=&quot;form-check-label&quot; for=&quot;weekdayFeature&quot;&gt;æ˜ŸæœŸå‡  (0=å‘¨ä¸€)&lt;/label&gt;</span><br><span class="line">                                                        &lt;/div&gt;</span><br><span class="line">                                                        &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                                                            &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; id=&quot;hourFeature&quot;&gt;</span><br><span class="line">                                                            &lt;label class=&quot;form-check-label&quot; for=&quot;hourFeature&quot;&gt;å°æ—¶ (å¦‚æœæœ‰æ—¶åˆ†ç§’)&lt;/label&gt;</span><br><span class="line">                                                        &lt;/div&gt;</span><br><span class="line">                                                        &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">                                                            &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; id=&quot;quarterFeature&quot;&gt;</span><br><span class="line">                                                            &lt;label class=&quot;form-check-label&quot; for=&quot;quarterFeature&quot;&gt;å­£åº¦&lt;/label&gt;</span><br><span class="line">                                                        &lt;/div&gt;</span><br><span class="line">                                                    &lt;/div&gt;</span><br><span class="line">                                                &lt;/form&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                            &lt;div class=&quot;modal-footer&quot;&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot; data-bs-dismiss=&quot;modal&quot;&gt;å–æ¶ˆ&lt;/button&gt;</span><br><span class="line">                                                &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot; onclick=&quot;applyDateExtraction()&quot;&gt;æå–ç‰¹å¾&lt;/button&gt;</span><br><span class="line">                                            &lt;/div&gt;</span><br><span class="line">                                        &lt;/div&gt;</span><br><span class="line">                                    &lt;/div&gt;</span><br><span class="line">                                &lt;/div&gt;</span><br><span class="line">                                </span><br><span class="line">                                &lt;script&gt;</span><br><span class="line">                                function applyDateExtraction() &#123;</span><br><span class="line">                                    const column = document.getElementById(&#x27;dateColumn&#x27;).value;</span><br><span class="line">                                    </span><br><span class="line">                                    axios.post(&#x27;/extract-datetime-features&#x27;, &#123; </span><br><span class="line">                                        column: column</span><br><span class="line">                                    &#125;)</span><br><span class="line">                                        .then(response =&gt; &#123;</span><br><span class="line">                                            if (response.data.success) &#123;</span><br><span class="line">                                                // æ›´æ–°æ•°æ®é¢„è§ˆ</span><br><span class="line">                                                currentData = response.data.data;</span><br><span class="line">                                                updateDataPreview(currentData);</span><br><span class="line">                                                updateHistory(response.data.history);</span><br><span class="line">                                                </span><br><span class="line">                                                // å…³é—­æ¨¡æ€æ¡†</span><br><span class="line">                                                bootstrap.Modal.getInstance(document.getElementById(&#x27;dateModal&#x27;)).hide();</span><br><span class="line">                                                </span><br><span class="line">                                                // æ˜¾ç¤ºç»“æœ</span><br><span class="line">                                                showResult(&#x27;success&#x27;, &#x27;æ—¥æœŸç‰¹å¾æå–æˆåŠŸ&#x27;, response.data.message);</span><br><span class="line">                                            &#125; else &#123;</span><br><span class="line">                                                showResult(&#x27;error&#x27;, &#x27;æ—¥æœŸç‰¹å¾æå–å¤±è´¥&#x27;, response.data.message);</span><br><span class="line">                                            &#125;</span><br><span class="line">                                        &#125;)</span><br><span class="line">                                        .catch(error =&gt; &#123;</span><br><span class="line">                                            showResult(&#x27;error&#x27;, &#x27;æ—¥æœŸç‰¹å¾æå–å¤±è´¥&#x27;, error.response?.data?.message || error.message);</span><br><span class="line">                                        &#125;);</span><br><span class="line">                                &#125;</span><br><span class="line">                                &lt;\/script&gt;</span><br><span class="line">                            `;</span><br><span class="line">                            </span><br><span class="line">                            // åˆ›å»ºå¹¶æ˜¾ç¤ºæ¨¡æ€æ¡†</span><br><span class="line">                            const modalContainer = document.createElement(&#x27;div&#x27;);</span><br><span class="line">                            modalContainer.innerHTML = modalHtml;</span><br><span class="line">                            document.body.appendChild(modalContainer);</span><br><span class="line">                            </span><br><span class="line">                            const modal = new bootstrap.Modal(document.getElementById(&#x27;dateModal&#x27;));</span><br><span class="line">                            modal.show();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .catch(error =&gt; &#123;</span><br><span class="line">                        showResult(&#x27;error&#x27;, &#x27;è·å–æ—¥æœŸåˆ—å¤±è´¥&#x27;, error.message);</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºåˆ—åˆ†æ</span><br><span class="line">            function showColumnAnalysis() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                let html = `</span><br><span class="line">                    &lt;div class=&quot;card&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;card-header bg-light&quot;&gt;</span><br><span class="line">                            &lt;h5 class=&quot;mb-0&quot;&gt;åˆ—åˆ†æ&lt;/h5&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        &lt;div class=&quot;card-body&quot;&gt;</span><br><span class="line">                            &lt;div class=&quot;mb-3&quot;&gt;</span><br><span class="line">                                &lt;label class=&quot;form-label&quot;&gt;é€‰æ‹©è¦åˆ†æçš„åˆ—:&lt;/label&gt;</span><br><span class="line">                                &lt;select class=&quot;form-select&quot; id=&quot;analysisColumn&quot; onchange=&quot;analyzeColumn()&quot;&gt;</span><br><span class="line">                                    &lt;option value=&quot;&quot;&gt;-- é€‰æ‹©åˆ— --&lt;/option&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                currentData.info.columns.forEach(col =&gt; &#123;</span><br><span class="line">                    html += `&lt;option value=&quot;$&#123;col&#125;&quot;&gt;$&#123;col&#125; ($&#123;currentData.info.dtypes[col]&#125;)&lt;/option&gt;`;</span><br><span class="line">                &#125;);</span><br><span class="line">                </span><br><span class="line">                html += `</span><br><span class="line">                                &lt;/select&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div id=&quot;columnAnalysisResult&quot;&gt;&lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                    </span><br><span class="line">                    &lt;script&gt;</span><br><span class="line">                    function analyzeColumn() &#123;</span><br><span class="line">                        const column = document.getElementById(&#x27;analysisColumn&#x27;).value;</span><br><span class="line">                        if (!column) return;</span><br><span class="line">                        </span><br><span class="line">                        axios.get(&#x27;/column-stats?column=&#x27; + encodeURIComponent(column))</span><br><span class="line">                            .then(response =&gt; &#123;</span><br><span class="line">                                if (response.data.success) &#123;</span><br><span class="line">                                    const stats = response.data.stats;</span><br><span class="line">                                    let resultHtml = &#x27;&lt;div class=&quot;mt-3&quot;&gt;&#x27;;</span><br><span class="line">                                    </span><br><span class="line">                                    resultHtml += \`</span><br><span class="line">                                        &lt;h6&gt;\$&#123;stats.name&#125; åˆ†æç»“æœ&lt;/h6&gt;</span><br><span class="line">                                        &lt;table class=&quot;table table-sm&quot;&gt;</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;æ•°æ®ç±»å‹&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.dtype&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;éç©ºå€¼æ•°é‡&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.count&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;ç¼ºå¤±å€¼æ•°é‡&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.null_count&#125; (\$&#123;stats.null_percentage.toFixed(1)&#125;%)&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;å”¯ä¸€å€¼æ•°é‡&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.unique_count&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                    \`;</span><br><span class="line">                                    </span><br><span class="line">                                    if (stats.type === &#x27;numeric&#x27;) &#123;</span><br><span class="line">                                        resultHtml += \`</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;æœ€å°å€¼&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.min&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;æœ€å¤§å€¼&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.max&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;å¹³å‡å€¼&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.mean&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;ä¸­ä½æ•°&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.median&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;æ ‡å‡†å·®&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.std&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;ç¬¬ä¸€å››åˆ†ä½æ•°&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.q1&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;ç¬¬ä¸‰å››åˆ†ä½æ•°&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.q3&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                        \`;</span><br><span class="line">                                    &#125; else if (stats.type === &#x27;datetime&#x27;) &#123;</span><br><span class="line">                                        resultHtml += \`</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;æœ€æ—©æ—¥æœŸ&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.min&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                            &lt;tr&gt;&lt;td&gt;&lt;strong&gt;æœ€æ™šæ—¥æœŸ&lt;/strong&gt;&lt;/td&gt;&lt;td&gt;\$&#123;stats.max&#125;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                        \`;</span><br><span class="line">                                    &#125; else if (stats.type === &#x27;categorical&#x27; &amp;&amp; stats.top_values) &#123;</span><br><span class="line">                                        resultHtml += \`</span><br><span class="line">                                            &lt;tr&gt;&lt;td colspan=&quot;2&quot;&gt;&lt;strong&gt;æœ€å¸¸å‡ºç°çš„å€¼:&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">                                        \`;</span><br><span class="line">                                        </span><br><span class="line">                                        Object.entries(stats.top_values).forEach(([value, count]) =&gt; &#123;</span><br><span class="line">                                            const percentage = (count / stats.count * 100).toFixed(1);</span><br><span class="line">                                            resultHtml += \`</span><br><span class="line">                                                &lt;tr&gt;</span><br><span class="line">                                                    &lt;td&gt;\$&#123;value&#125;&lt;/td&gt;</span><br><span class="line">                                                    &lt;td&gt;\$&#123;count&#125; (\$&#123;percentage&#125;%)&lt;/td&gt;</span><br><span class="line">                                                &lt;/tr&gt;</span><br><span class="line">                                            \`;</span><br><span class="line">                                        &#125;);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    </span><br><span class="line">                                    resultHtml += &#x27;&lt;/table&gt;&lt;/div&gt;&#x27;;</span><br><span class="line">                                    </span><br><span class="line">                                    document.getElementById(&#x27;columnAnalysisResult&#x27;).innerHTML = resultHtml;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;)</span><br><span class="line">                            .catch(error =&gt; &#123;</span><br><span class="line">                                console.error(&#x27;åˆ†æå¤±è´¥:&#x27;, error);</span><br><span class="line">                            &#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &lt;\/script&gt;</span><br><span class="line">                `;</span><br><span class="line">                </span><br><span class="line">                document.getElementById(&#x27;operation-result&#x27;).innerHTML = html;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // å¯¼å‡ºæ•°æ®</span><br><span class="line">            function exportData(format) &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨</span><br><span class="line">                document.getElementById(&#x27;step3&#x27;).classList.add(&#x27;completed&#x27;);</span><br><span class="line">                document.getElementById(&#x27;step4&#x27;).classList.add(&#x27;active&#x27;);</span><br><span class="line">                </span><br><span class="line">                // ä¸‹è½½æ–‡ä»¶</span><br><span class="line">                window.open(&#x27;/export?format=&#x27; + format, &#x27;_blank&#x27;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ˜¾ç¤ºæŠ¥å‘Š</span><br><span class="line">            function showReport() &#123;</span><br><span class="line">                if (!currentData) &#123;</span><br><span class="line">                    showResult(&#x27;warning&#x27;, &#x27;æç¤º&#x27;, &#x27;è¯·å…ˆåŠ è½½æ•°æ®&#x27;);</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                axios.get(&#x27;/generate-report&#x27;)</span><br><span class="line">                    .then(response =&gt; &#123;</span><br><span class="line">                        if (response.data.success) &#123;</span><br><span class="line">                            const report = response.data.report;</span><br><span class="line">                            </span><br><span class="line">                            let html = &#x27;&lt;div class=&quot;card&quot;&gt;&#x27;;</span><br><span class="line">                            html += &#x27;&lt;div class=&quot;card-header bg-light d-flex justify-content-between align-items-center&quot;&gt;&#x27;;</span><br><span class="line">                            html += &#x27;&lt;h5 class=&quot;mb-0&quot;&gt;æ•°æ®æ¸…æ´—æŠ¥å‘Š&lt;/h5&gt;&#x27;;</span><br><span class="line">                            html += &#x27;&lt;button class=&quot;btn btn-sm btn-outline-primary&quot; onclick=&quot;downloadReport()&quot;&gt;ä¸‹è½½æŠ¥å‘Š&lt;/button&gt;&#x27;;</span><br><span class="line">                            html += &#x27;&lt;/div&gt;&#x27;;</span><br><span class="line">                            html += &#x27;&lt;div class=&quot;card-body&quot;&gt;&#x27;;</span><br><span class="line">                            html += &#x27;&lt;pre style=&quot;white-space: pre-wrap; font-family: monospace; font-size: 0.9rem;&quot;&gt;&#x27; + report + &#x27;&lt;/pre&gt;&#x27;;</span><br><span class="line">                            html += &#x27;&lt;/div&gt;&lt;/div&gt;&#x27;;</span><br><span class="line">                            </span><br><span class="line">                            document.getElementById(&#x27;operation-result&#x27;).innerHTML = html;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .catch(error =&gt; &#123;</span><br><span class="line">                        showResult(&#x27;error&#x27;, &#x27;ç”ŸæˆæŠ¥å‘Šå¤±è´¥&#x27;, error.message);</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // ä¸‹è½½æŠ¥å‘Š</span><br><span class="line">            function downloadReport() &#123;</span><br><span class="line">                window.open(&#x27;/download-report&#x27;, &#x27;_blank&#x27;);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            // æ’¤é”€ä¸Šä¸€æ­¥æ“ä½œ</span><br><span class="line">            function undoLast() &#123;</span><br><span class="line">                axios.post(&#x27;/undo&#x27;)</span><br><span class="line">                    .then(response =&gt; &#123;</span><br><span class="line">                        if (response.data.success) &#123;</span><br><span class="line">                            // æ›´æ–°æ•°æ®é¢„è§ˆ</span><br><span class="line">                            currentData = response.data.data;</span><br><span class="line">                            updateDataPreview(currentData);</span><br><span class="line">                            updateHistory(response.data.history);</span><br><span class="line">                            </span><br><span class="line">                            // æ˜¾ç¤ºç»“æœ</span><br><span class="line">                            showResult(&#x27;success&#x27;, &#x27;æ’¤é”€æˆåŠŸ&#x27;, response.data.message);</span><br><span class="line">                        &#125; else &#123;</span><br><span class="line">                            showResult(&#x27;warning&#x27;, &#x27;æ— æ³•æ’¤é”€&#x27;, response.data.message);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .catch(error =&gt; &#123;</span><br><span class="line">                        showResult(&#x27;error&#x27;, &#x27;æ’¤é”€å¤±è´¥&#x27;, error.message);</span><br><span class="line">                    &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &lt;/script&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">    &lt;/html&gt;</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    return html</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/upload&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def upload_file():</span><br><span class="line">    &quot;&quot;&quot;ä¸Šä¼ æ–‡ä»¶&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if &#x27;file&#x27; not in request.files:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰æ–‡ä»¶&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        file = request.files[&#x27;file&#x27;]</span><br><span class="line">        if file.filename == &#x27;&#x27;:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰é€‰æ‹©æ–‡ä»¶&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        # è¯»å–æ–‡ä»¶å†…å®¹</span><br><span class="line">        file_bytes = file.read()</span><br><span class="line">        filename = secure_filename(file.filename)</span><br><span class="line">        </span><br><span class="line">        # åŠ è½½æ•°æ®</span><br><span class="line">        success, message = cleaner.load_data_from_bytes(file_bytes, filename)</span><br><span class="line">        </span><br><span class="line">        if success:</span><br><span class="line">            # è·å–æ•°æ®ä¿¡æ¯å’Œæ ·æœ¬</span><br><span class="line">            info = cleaner.get_info()</span><br><span class="line">            sample = cleaner.get_sample_data(100)</span><br><span class="line">            </span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;success&#x27;: True,</span><br><span class="line">                &#x27;message&#x27;: message,</span><br><span class="line">                &#x27;data&#x27;: &#123;</span><br><span class="line">                    &#x27;sample&#x27;: sample,</span><br><span class="line">                    &#x27;info&#x27;: info</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;history&#x27;: cleaner.history</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: message&#125;)</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;ä¸Šä¼ å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/missing-analysis&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def missing_analysis():</span><br><span class="line">    &quot;&quot;&quot;ç¼ºå¤±å€¼åˆ†æ&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        info = cleaner.get_info()</span><br><span class="line">        null_counts = info[&#x27;null_counts&#x27;]</span><br><span class="line">        </span><br><span class="line">        # è®¡ç®—æ€»ä½“ç»Ÿè®¡</span><br><span class="line">        total_missing = sum(null_counts.values())</span><br><span class="line">        total_cells = info[&#x27;shape&#x27;][0] * info[&#x27;shape&#x27;][1]</span><br><span class="line">        missing_percentage = (total_missing / total_cells * 100) if total_cells &gt; 0 else 0</span><br><span class="line">        </span><br><span class="line">        # æŒ‰åˆ—åˆ†æ</span><br><span class="line">        details = []</span><br><span class="line">        columns_with_missing = 0</span><br><span class="line">        </span><br><span class="line">        for col, null_count in null_counts.items():</span><br><span class="line">            if null_count &gt; 0:</span><br><span class="line">                columns_with_missing += 1</span><br><span class="line">                missing_pct = (null_count / info[&#x27;shape&#x27;][0] * 100)</span><br><span class="line">                details.append(&#123;</span><br><span class="line">                    &#x27;column&#x27;: col,</span><br><span class="line">                    &#x27;dtype&#x27;: info[&#x27;dtypes&#x27;][col],</span><br><span class="line">                    &#x27;missing_count&#x27;: null_count,</span><br><span class="line">                    &#x27;missing_percentage&#x27;: missing_pct</span><br><span class="line">                &#125;)</span><br><span class="line">        </span><br><span class="line">        # æŒ‰ç¼ºå¤±å€¼ç™¾åˆ†æ¯”æ’åº</span><br><span class="line">        details.sort(key=lambda x: x[&#x27;missing_percentage&#x27;], reverse=True)</span><br><span class="line">        </span><br><span class="line">        analysis = &#123;</span><br><span class="line">            &#x27;total_missing&#x27;: total_missing,</span><br><span class="line">            &#x27;total_cells&#x27;: total_cells,</span><br><span class="line">            &#x27;missing_percentage&#x27;: missing_percentage,</span><br><span class="line">            &#x27;columns_with_missing&#x27;: columns_with_missing,</span><br><span class="line">            &#x27;details&#x27;: details</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: True, &#x27;analysis&#x27;: analysis&#125;)</span><br><span class="line">        </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;åˆ†æå¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/handle-missing&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def handle_missing():</span><br><span class="line">    &quot;&quot;&quot;å¤„ç†ç¼ºå¤±å€¼&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        data = request.json</span><br><span class="line">        strategy = data.get(&#x27;strategy&#x27;, &#x27;mean&#x27;)</span><br><span class="line">        columns = data.get(&#x27;columns&#x27;)</span><br><span class="line">        custom_value = data.get(&#x27;custom_value&#x27;)</span><br><span class="line">        </span><br><span class="line">        success, message = cleaner.handle_missing_values(strategy, columns, custom_value)</span><br><span class="line">        </span><br><span class="line">        if success:</span><br><span class="line">            info = cleaner.get_info()</span><br><span class="line">            sample = cleaner.get_sample_data(100)</span><br><span class="line">            </span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;success&#x27;: True,</span><br><span class="line">                &#x27;message&#x27;: message,</span><br><span class="line">                &#x27;data&#x27;: &#123;</span><br><span class="line">                    &#x27;sample&#x27;: sample,</span><br><span class="line">                    &#x27;info&#x27;: info</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;history&#x27;: cleaner.history</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: message&#125;)</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;å¤„ç†å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/remove-duplicates&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def remove_duplicates():</span><br><span class="line">    &quot;&quot;&quot;å»é™¤é‡å¤å€¼&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        data = request.json</span><br><span class="line">        subset = data.get(&#x27;subset&#x27;)</span><br><span class="line">        keep = data.get(&#x27;keep&#x27;, &#x27;first&#x27;)</span><br><span class="line">        </span><br><span class="line">        success, message = cleaner.remove_duplicates(subset, keep)</span><br><span class="line">        </span><br><span class="line">        if success:</span><br><span class="line">            info = cleaner.get_info()</span><br><span class="line">            sample = cleaner.get_sample_data(100)</span><br><span class="line">            </span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;success&#x27;: True,</span><br><span class="line">                &#x27;message&#x27;: message,</span><br><span class="line">                &#x27;data&#x27;: &#123;</span><br><span class="line">                    &#x27;sample&#x27;: sample,</span><br><span class="line">                    &#x27;info&#x27;: info</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;history&#x27;: cleaner.history</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: message&#125;)</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;å»é‡å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/rename-columns&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def rename_columns():</span><br><span class="line">    &quot;&quot;&quot;é‡å‘½ååˆ—&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        data = request.json</span><br><span class="line">        rename_dict = data.get(&#x27;rename_dict&#x27;, &#123;&#125;)</span><br><span class="line">        </span><br><span class="line">        success, message = cleaner.rename_columns(rename_dict)</span><br><span class="line">        </span><br><span class="line">        if success:</span><br><span class="line">            info = cleaner.get_info()</span><br><span class="line">            sample = cleaner.get_sample_data(100)</span><br><span class="line">            </span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;success&#x27;: True,</span><br><span class="line">                &#x27;message&#x27;: message,</span><br><span class="line">                &#x27;data&#x27;: &#123;</span><br><span class="line">                    &#x27;sample&#x27;: sample,</span><br><span class="line">                    &#x27;info&#x27;: info</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;history&#x27;: cleaner.history</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: message&#125;)</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;é‡å‘½åå¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/change-column-type&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def change_column_type():</span><br><span class="line">    &quot;&quot;&quot;æ›´æ”¹åˆ—æ•°æ®ç±»å‹&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        data = request.json</span><br><span class="line">        column = data.get(&#x27;column&#x27;)</span><br><span class="line">        new_type = data.get(&#x27;new_type&#x27;)</span><br><span class="line">        </span><br><span class="line">        success, message = cleaner.change_column_type(column, new_type)</span><br><span class="line">        </span><br><span class="line">        if success:</span><br><span class="line">            info = cleaner.get_info()</span><br><span class="line">            sample = cleaner.get_sample_data(100)</span><br><span class="line">            </span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;success&#x27;: True,</span><br><span class="line">                &#x27;message&#x27;: message,</span><br><span class="line">                &#x27;data&#x27;: &#123;</span><br><span class="line">                    &#x27;sample&#x27;: sample,</span><br><span class="line">                    &#x27;info&#x27;: info</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;history&#x27;: cleaner.history</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: message&#125;)</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;ç±»å‹è½¬æ¢å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/filter-data&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def filter_data():</span><br><span class="line">    &quot;&quot;&quot;è¿‡æ»¤æ•°æ®&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        data = request.json</span><br><span class="line">        condition = data.get(&#x27;condition&#x27;)</span><br><span class="line">        </span><br><span class="line">        success, message = cleaner.filter_data(condition)</span><br><span class="line">        </span><br><span class="line">        if success:</span><br><span class="line">            info = cleaner.get_info()</span><br><span class="line">            sample = cleaner.get_sample_data(100)</span><br><span class="line">            </span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;success&#x27;: True,</span><br><span class="line">                &#x27;message&#x27;: message,</span><br><span class="line">                &#x27;data&#x27;: &#123;</span><br><span class="line">                    &#x27;sample&#x27;: sample,</span><br><span class="line">                    &#x27;info&#x27;: info</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;history&#x27;: cleaner.history</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: message&#125;)</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;è¿‡æ»¤å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/drop-columns&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def drop_columns():</span><br><span class="line">    &quot;&quot;&quot;åˆ é™¤åˆ—&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        data = request.json</span><br><span class="line">        columns = data.get(&#x27;columns&#x27;, [])</span><br><span class="line">        </span><br><span class="line">        success, message = cleaner.drop_columns(columns)</span><br><span class="line">        </span><br><span class="line">        if success:</span><br><span class="line">            info = cleaner.get_info()</span><br><span class="line">            sample = cleaner.get_sample_data(100)</span><br><span class="line">            </span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;success&#x27;: True,</span><br><span class="line">                &#x27;message&#x27;: message,</span><br><span class="line">                &#x27;data&#x27;: &#123;</span><br><span class="line">                    &#x27;sample&#x27;: sample,</span><br><span class="line">                    &#x27;info&#x27;: info</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;history&#x27;: cleaner.history</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: message&#125;)</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;åˆ é™¤å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/numeric-columns&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def get_numeric_columns():</span><br><span class="line">    &quot;&quot;&quot;è·å–æ•°å€¼åˆ—&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        numeric_cols = cleaner.data.select_dtypes(include=[np.number]).columns.tolist()</span><br><span class="line">        </span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: True, &#x27;columns&#x27;: numeric_cols&#125;)</span><br><span class="line">        </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;è·å–æ•°å€¼åˆ—å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/categorical-columns&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def get_categorical_columns():</span><br><span class="line">    &quot;&quot;&quot;è·å–åˆ†ç±»åˆ—&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        # è·å–æ–‡æœ¬å’Œåˆ†ç±»åˆ—</span><br><span class="line">        categorical_cols = cleaner.data.select_dtypes(</span><br><span class="line">            include=[&#x27;object&#x27;, &#x27;category&#x27;]</span><br><span class="line">        ).columns.tolist()</span><br><span class="line">        </span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: True, &#x27;columns&#x27;: categorical_cols&#125;)</span><br><span class="line">        </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;è·å–åˆ†ç±»åˆ—å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/date-columns&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def get_date_columns():</span><br><span class="line">    &quot;&quot;&quot;è·å–å¯èƒ½æ˜¯æ—¥æœŸçš„åˆ—&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        # è·å–å¯èƒ½æ˜¯æ—¥æœŸçš„åˆ—ï¼ˆå¯¹è±¡ç±»å‹æˆ–åŒ…å«date/timeå­—ç¬¦ä¸²ï¼‰</span><br><span class="line">        date_cols = []</span><br><span class="line">        for col in cleaner.data.columns:</span><br><span class="line">            dtype = str(cleaner.data[col].dtype)</span><br><span class="line">            if dtype in [&#x27;object&#x27;, &#x27;datetime64[ns]&#x27;]:</span><br><span class="line">                # æ£€æŸ¥åˆ—åæ˜¯å¦åŒ…å«æ—¥æœŸç›¸å…³çš„å…³é”®è¯</span><br><span class="line">                date_keywords = [&#x27;date&#x27;, &#x27;time&#x27;, &#x27;year&#x27;, &#x27;month&#x27;, &#x27;day&#x27;, &#x27;hour&#x27;, &#x27;minute&#x27;, &#x27;second&#x27;]</span><br><span class="line">                if any(keyword in col.lower() for keyword in date_keywords):</span><br><span class="line">                    date_cols.append(col)</span><br><span class="line">                else:</span><br><span class="line">                    # å°è¯•è§£æå‰å‡ ä¸ªå€¼æ˜¯å¦ä¸ºæ—¥æœŸ</span><br><span class="line">                    sample = cleaner.data[col].dropna().head(5)</span><br><span class="line">                    if len(sample) &gt; 0:</span><br><span class="line">                        try:</span><br><span class="line">                            pd.to_datetime(sample)</span><br><span class="line">                            date_cols.append(col)</span><br><span class="line">                        except:</span><br><span class="line">                            pass</span><br><span class="line">        </span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: True, &#x27;columns&#x27;: date_cols&#125;)</span><br><span class="line">        </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;è·å–æ—¥æœŸåˆ—å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/normalize-column&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def normalize_column():</span><br><span class="line">    &quot;&quot;&quot;æ ‡å‡†åŒ–åˆ—&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        data = request.json</span><br><span class="line">        column = data.get(&#x27;column&#x27;)</span><br><span class="line">        method = data.get(&#x27;method&#x27;, &#x27;minmax&#x27;)</span><br><span class="line">        </span><br><span class="line">        success, message = cleaner.normalize_column(column, method)</span><br><span class="line">        </span><br><span class="line">        if success:</span><br><span class="line">            info = cleaner.get_info()</span><br><span class="line">            sample = cleaner.get_sample_data(100)</span><br><span class="line">            </span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;success&#x27;: True,</span><br><span class="line">                &#x27;message&#x27;: message,</span><br><span class="line">                &#x27;data&#x27;: &#123;</span><br><span class="line">                    &#x27;sample&#x27;: sample,</span><br><span class="line">                    &#x27;info&#x27;: info</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;history&#x27;: cleaner.history</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: message&#125;)</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;æ ‡å‡†åŒ–å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/handle-outliers&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def handle_outliers():</span><br><span class="line">    &quot;&quot;&quot;å¤„ç†å¼‚å¸¸å€¼&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        data = request.json</span><br><span class="line">        column = data.get(&#x27;column&#x27;)</span><br><span class="line">        method = data.get(&#x27;method&#x27;, &#x27;iqr&#x27;)</span><br><span class="line">        threshold = data.get(&#x27;threshold&#x27;, 1.5)</span><br><span class="line">        </span><br><span class="line">        success, message = cleaner.handle_outliers(column, method, threshold)</span><br><span class="line">        </span><br><span class="line">        if success:</span><br><span class="line">            info = cleaner.get_info()</span><br><span class="line">            sample = cleaner.get_sample_data(100)</span><br><span class="line">            </span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;success&#x27;: True,</span><br><span class="line">                &#x27;message&#x27;: message,</span><br><span class="line">                &#x27;data&#x27;: &#123;</span><br><span class="line">                    &#x27;sample&#x27;: sample,</span><br><span class="line">                    &#x27;info&#x27;: info</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;history&#x27;: cleaner.history</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: message&#125;)</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;å¼‚å¸¸å€¼å¤„ç†å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/encode-categorical&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def encode_categorical():</span><br><span class="line">    &quot;&quot;&quot;ç¼–ç åˆ†ç±»å˜é‡&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        data = request.json</span><br><span class="line">        column = data.get(&#x27;column&#x27;)</span><br><span class="line">        method = data.get(&#x27;method&#x27;, &#x27;onehot&#x27;)</span><br><span class="line">        </span><br><span class="line">        success, message = cleaner.encode_categorical(column, method)</span><br><span class="line">        </span><br><span class="line">        if success:</span><br><span class="line">            info = cleaner.get_info()</span><br><span class="line">            sample = cleaner.get_sample_data(100)</span><br><span class="line">            </span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;success&#x27;: True,</span><br><span class="line">                &#x27;message&#x27;: message,</span><br><span class="line">                &#x27;data&#x27;: &#123;</span><br><span class="line">                    &#x27;sample&#x27;: sample,</span><br><span class="line">                    &#x27;info&#x27;: info</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;history&#x27;: cleaner.history</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: message&#125;)</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;ç¼–ç å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/extract-datetime-features&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def extract_datetime_features():</span><br><span class="line">    &quot;&quot;&quot;æå–æ—¥æœŸæ—¶é—´ç‰¹å¾&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        data = request.json</span><br><span class="line">        column = data.get(&#x27;column&#x27;)</span><br><span class="line">        </span><br><span class="line">        success, message = cleaner.extract_datetime_features(column)</span><br><span class="line">        </span><br><span class="line">        if success:</span><br><span class="line">            info = cleaner.get_info()</span><br><span class="line">            sample = cleaner.get_sample_data(100)</span><br><span class="line">            </span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;success&#x27;: True,</span><br><span class="line">                &#x27;message&#x27;: message,</span><br><span class="line">                &#x27;data&#x27;: &#123;</span><br><span class="line">                    &#x27;sample&#x27;: sample,</span><br><span class="line">                    &#x27;info&#x27;: info</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;history&#x27;: cleaner.history</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: message&#125;)</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;æ—¥æœŸç‰¹å¾æå–å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/column-stats&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def column_stats():</span><br><span class="line">    &quot;&quot;&quot;è·å–åˆ—ç»Ÿè®¡ä¿¡æ¯&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æ²¡æœ‰åŠ è½½æ•°æ®&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        column = request.args.get(&#x27;column&#x27;)</span><br><span class="line">        if not column:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: &#x27;æœªæŒ‡å®šåˆ—å&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">        stats = cleaner.get_column_stats(column)</span><br><span class="line">        </span><br><span class="line">        if stats:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: True, &#x27;stats&#x27;: stats&#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;åˆ— &#123;column&#125; ä¸å­˜åœ¨&#x27;&#125;)</span><br><span class="line">        </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;è·å–ç»Ÿè®¡ä¿¡æ¯å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/undo&#x27;, methods=[&#x27;POST&#x27;])</span><br><span class="line">def undo():</span><br><span class="line">    &quot;&quot;&quot;æ’¤é”€ä¸Šä¸€æ­¥æ“ä½œ&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        success, message = cleaner.undo()</span><br><span class="line">        </span><br><span class="line">        if success:</span><br><span class="line">            info = cleaner.get_info()</span><br><span class="line">            sample = cleaner.get_sample_data(100)</span><br><span class="line">            </span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;success&#x27;: True,</span><br><span class="line">                &#x27;message&#x27;: message,</span><br><span class="line">                &#x27;data&#x27;: &#123;</span><br><span class="line">                    &#x27;sample&#x27;: sample,</span><br><span class="line">                    &#x27;info&#x27;: info</span><br><span class="line">                &#125;,</span><br><span class="line">                &#x27;history&#x27;: cleaner.history</span><br><span class="line">            &#125;)</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: message&#125;)</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;æ’¤é”€å¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/generate-report&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def generate_report():</span><br><span class="line">    &quot;&quot;&quot;ç”ŸæˆæŠ¥å‘Š&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        report = cleaner.generate_report()</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: True, &#x27;report&#x27;: report&#125;)</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return jsonify(&#123;&#x27;success&#x27;: False, &#x27;message&#x27;: f&#x27;ç”ŸæˆæŠ¥å‘Šå¤±è´¥: &#123;str(e)&#125;&#x27;&#125;)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/download-report&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def download_report():</span><br><span class="line">    &quot;&quot;&quot;ä¸‹è½½æŠ¥å‘Š&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        report = cleaner.generate_report()</span><br><span class="line">        </span><br><span class="line">        # åˆ›å»ºæ–‡æœ¬æ–‡ä»¶</span><br><span class="line">        buffer = io.BytesIO()</span><br><span class="line">        buffer.write(report.encode(&#x27;utf-8&#x27;))</span><br><span class="line">        buffer.seek(0)</span><br><span class="line">        </span><br><span class="line">        filename = f&quot;data_cleaning_report_&#123;datetime.now().strftime(&#x27;%Y%m%d_%H%M%S&#x27;)&#125;.txt&quot;</span><br><span class="line">        </span><br><span class="line">        return send_file(</span><br><span class="line">            buffer,</span><br><span class="line">            as_attachment=True,</span><br><span class="line">            download_name=filename,</span><br><span class="line">            mimetype=&#x27;text/plain&#x27;</span><br><span class="line">        )</span><br><span class="line">    except Exception as e:</span><br><span class="line">        return f&quot;ä¸‹è½½å¤±è´¥: &#123;str(e)&#125;&quot;, 500</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/export&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def export_data():</span><br><span class="line">    &quot;&quot;&quot;å¯¼å‡ºæ•°æ®&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        if cleaner.data is None:</span><br><span class="line">            return &quot;æ²¡æœ‰å¯å¯¼å‡ºçš„æ•°æ®&quot;, 400</span><br><span class="line">        </span><br><span class="line">        format = request.args.get(&#x27;format&#x27;, &#x27;csv&#x27;)</span><br><span class="line">        </span><br><span class="line">        result = cleaner.save_to_bytes(format)</span><br><span class="line">        if result:</span><br><span class="line">            buffer, content_type, filename = result</span><br><span class="line">            return send_file(</span><br><span class="line">                buffer,</span><br><span class="line">                as_attachment=True,</span><br><span class="line">                download_name=filename,</span><br><span class="line">                mimetype=content_type</span><br><span class="line">            )</span><br><span class="line">        else:</span><br><span class="line">            return &quot;å¯¼å‡ºå¤±è´¥&quot;, 500</span><br><span class="line">            </span><br><span class="line">    except Exception as e:</span><br><span class="line">        return f&quot;å¯¼å‡ºå¤±è´¥: &#123;str(e)&#125;&quot;, 500</span><br><span class="line"></span><br><span class="line"># å¯åŠ¨åº”ç”¨</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    import argparse</span><br><span class="line">    </span><br><span class="line">    parser = argparse.ArgumentParser(description=&#x27;Webæ•°æ®æ¸…æ´—å¤„ç†å·¥å…·&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--host&#x27;, default=&#x27;127.0.0.1&#x27;, help=&#x27;ä¸»æœºåœ°å€&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--port&#x27;, type=int, default=5000, help=&#x27;ç«¯å£å·&#x27;)</span><br><span class="line">    parser.add_argument(&#x27;--debug&#x27;, action=&#x27;store_true&#x27;, help=&#x27;è°ƒè¯•æ¨¡å¼&#x27;)</span><br><span class="line">    </span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    </span><br><span class="line">    print(f&quot;æ•°æ®æ¸…æ´—å·¥å…·å·²å¯åŠ¨ï¼&quot;)</span><br><span class="line">    print(f&quot;è¯·åœ¨æµè§ˆå™¨ä¸­è®¿é—®: http://&#123;args.host&#125;:&#123;args.port&#125;&quot;)</span><br><span class="line">    print(f&quot;æŒ‰ Ctrl+C åœæ­¢æœåŠ¡&quot;)</span><br><span class="line">    </span><br><span class="line">    app.run(host=args.host, port=args.port, debug=args.debug)</span><br></pre></td></tr></table></figure>



<h2 id="ğŸš€-å¦‚ä½•è¿è¡Œ"><a href="#ğŸš€-å¦‚ä½•è¿è¡Œ" class="headerlink" title="ğŸš€ å¦‚ä½•è¿è¡Œ"></a>ğŸš€ <strong>å¦‚ä½•è¿è¡Œ</strong></h2><h3 id="1-å®‰è£…ä¾èµ–"><a href="#1-å®‰è£…ä¾èµ–" class="headerlink" title="1. å®‰è£…ä¾èµ–"></a>1. <strong>å®‰è£…ä¾èµ–</strong></h3><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirements.txt</span><br></pre></td></tr></table></figure>



<h3 id="2-å¯åŠ¨Webåº”ç”¨"><a href="#2-å¯åŠ¨Webåº”ç”¨" class="headerlink" title="2. å¯åŠ¨Webåº”ç”¨"></a>2. <strong>å¯åŠ¨Webåº”ç”¨</strong></h3><p>bash</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># åŸºæœ¬å¯åŠ¨</span><br><span class="line">python app.py</span><br><span class="line"></span><br><span class="line"># æŒ‡å®šç«¯å£</span><br><span class="line">python app.py --port 8080</span><br><span class="line"></span><br><span class="line"># è°ƒè¯•æ¨¡å¼</span><br><span class="line">python app.py --debug</span><br><span class="line"></span><br><span class="line"># å…è®¸å¤–éƒ¨è®¿é—®</span><br><span class="line">python app.py --host 0.0.0.0 --port 80</span><br></pre></td></tr></table></figure>



<h3 id="3-åœ¨æµè§ˆå™¨ä¸­è®¿é—®"><a href="#3-åœ¨æµè§ˆå™¨ä¸­è®¿é—®" class="headerlink" title="3. åœ¨æµè§ˆå™¨ä¸­è®¿é—®"></a>3. <strong>åœ¨æµè§ˆå™¨ä¸­è®¿é—®</strong></h3><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ï¼š<code>http://localhost:5000</code></p>
<h2 id="ğŸŒ-ä¸»è¦åŠŸèƒ½"><a href="#ğŸŒ-ä¸»è¦åŠŸèƒ½" class="headerlink" title="ğŸŒ ä¸»è¦åŠŸèƒ½"></a>ğŸŒ <strong>ä¸»è¦åŠŸèƒ½</strong></h2><h3 id="1-æ•°æ®ä¸Šä¼ "><a href="#1-æ•°æ®ä¸Šä¼ " class="headerlink" title="1. æ•°æ®ä¸Šä¼ "></a><strong>1. æ•°æ®ä¸Šä¼ </strong></h3><ul>
<li>æ”¯æŒå¤šç§æ ¼å¼ï¼šCSVã€Excelã€JSONã€Parquet</li>
<li>æ‹–æ‹½ä¸Šä¼ æˆ–é€‰æ‹©æ–‡ä»¶</li>
<li>å®æ—¶é¢„è§ˆå‰100è¡Œæ•°æ®</li>
</ul>
<h3 id="2-æ•°æ®æ¢ç´¢"><a href="#2-æ•°æ®æ¢ç´¢" class="headerlink" title="2. æ•°æ®æ¢ç´¢"></a><strong>2. æ•°æ®æ¢ç´¢</strong></h3><ul>
<li><strong>æ•°æ®æ¦‚è§ˆ</strong>ï¼šæ˜¾ç¤ºè¡Œæ•°ã€åˆ—æ•°ã€æ•°æ®ç±»å‹ã€å†…å­˜ä½¿ç”¨</li>
<li><strong>ç¼ºå¤±å€¼åˆ†æ</strong>ï¼šæŒ‰åˆ—ç»Ÿè®¡ç¼ºå¤±å€¼ï¼Œæä¾›å¤„ç†å»ºè®®</li>
<li><strong>åˆ—åˆ†æ</strong>ï¼šæŸ¥çœ‹æ¯åˆ—çš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆæœ€å°å€¼ã€æœ€å¤§å€¼ã€å‡å€¼ã€å”¯ä¸€å€¼ç­‰ï¼‰</li>
</ul>
<h3 id="3-æ•°æ®æ¸…æ´—æ“ä½œ"><a href="#3-æ•°æ®æ¸…æ´—æ“ä½œ" class="headerlink" title="3. æ•°æ®æ¸…æ´—æ“ä½œ"></a><strong>3. æ•°æ®æ¸…æ´—æ“ä½œ</strong></h3><ul>
<li><strong>å¤„ç†ç¼ºå¤±å€¼</strong>ï¼šå‡å€¼&#x2F;ä¸­ä½æ•°&#x2F;ä¼—æ•°å¡«å……ã€å‰å‘&#x2F;åå‘å¡«å……ã€åˆ é™¤ã€è‡ªå®šä¹‰å€¼å¡«å……</li>
<li><strong>å»é™¤é‡å¤</strong>ï¼šåŸºäºå…¨éƒ¨åˆ—æˆ–æŒ‡å®šåˆ—å»é‡</li>
<li><strong>é‡å‘½ååˆ—</strong>ï¼šæ‰¹é‡é‡å‘½ååˆ—å</li>
<li><strong>æ›´æ”¹æ•°æ®ç±»å‹</strong>ï¼šæ•´æ•°ã€æµ®ç‚¹æ•°ã€å­—ç¬¦ä¸²ã€æ—¥æœŸã€åˆ†ç±»ã€å¸ƒå°”å€¼</li>
<li><strong>æ•°æ®è¿‡æ»¤</strong>ï¼šä½¿ç”¨PandasæŸ¥è¯¢è¯­æ³•è¿‡æ»¤æ•°æ®</li>
<li><strong>åˆ é™¤åˆ—</strong>ï¼šæ‰¹é‡é€‰æ‹©å¹¶åˆ é™¤åˆ—</li>
<li><strong>æ•°æ®æ ‡å‡†åŒ–</strong>ï¼šMin-Maxæ ‡å‡†åŒ–ã€Z-Scoreæ ‡å‡†åŒ–ã€å¯¹æ•°å˜æ¢</li>
<li><strong>å¤„ç†å¼‚å¸¸å€¼</strong>ï¼šIQRæ–¹æ³•ã€Z-Scoreæ–¹æ³•ã€ç›´æ¥ç§»é™¤</li>
<li><strong>ç¼–ç åˆ†ç±»å˜é‡</strong>ï¼šOne-Hotç¼–ç ã€Labelç¼–ç ã€é¢‘ç‡ç¼–ç </li>
<li><strong>æå–æ—¥æœŸç‰¹å¾</strong>ï¼šä»æ—¥æœŸåˆ—æå–å¹´ã€æœˆã€æ—¥ã€æ˜ŸæœŸã€å°æ—¶ç­‰ç‰¹å¾</li>
</ul>
<h3 id="4-æ•°æ®å¯¼å‡º"><a href="#4-æ•°æ®å¯¼å‡º" class="headerlink" title="4. æ•°æ®å¯¼å‡º"></a><strong>4. æ•°æ®å¯¼å‡º</strong></h3><ul>
<li>å¯¼å‡ºä¸ºCSVã€Excelã€JSONæ ¼å¼</li>
<li>è‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶åå’Œæ—¶é—´æˆ³</li>
<li>ç›´æ¥ä¸‹è½½åˆ°æœ¬åœ°</li>
</ul>
<h3 id="5-å…¶ä»–åŠŸèƒ½"><a href="#5-å…¶ä»–åŠŸèƒ½" class="headerlink" title="5. å…¶ä»–åŠŸèƒ½"></a><strong>5. å…¶ä»–åŠŸèƒ½</strong></h3><ul>
<li><strong>æ“ä½œå†å²</strong>ï¼šè®°å½•æ‰€æœ‰æ“ä½œï¼Œå¯éšæ—¶æŸ¥çœ‹</li>
<li><strong>æ’¤é”€åŠŸèƒ½</strong>ï¼šæ’¤é”€ä¸Šä¸€æ­¥æ“ä½œ</li>
<li><strong>ç”ŸæˆæŠ¥å‘Š</strong>ï¼šç”Ÿæˆè¯¦ç»†çš„æ•°æ®æ¸…æ´—æŠ¥å‘Š</li>
<li><strong>å“åº”å¼è®¾è®¡</strong>ï¼šé€‚é…ä¸åŒå±å¹•å¤§å°</li>
<li><strong>å®æ—¶åé¦ˆ</strong>ï¼šæ“ä½œåç«‹å³æ˜¾ç¤ºç»“æœ</li>
</ul>
<h2 id="ğŸ¨-ç•Œé¢ç‰¹ç‚¹"><a href="#ğŸ¨-ç•Œé¢ç‰¹ç‚¹" class="headerlink" title="ğŸ¨ ç•Œé¢ç‰¹ç‚¹"></a>ğŸ¨ <strong>ç•Œé¢ç‰¹ç‚¹</strong></h2><ol>
<li><strong>ç›´è§‚çš„æ­¥éª¤æŒ‡ç¤ºå™¨</strong>ï¼šå¼•å¯¼ç”¨æˆ·å®Œæˆæ•°æ®æ¸…æ´—æµç¨‹</li>
<li><strong>ç°ä»£åŒ–UIè®¾è®¡</strong>ï¼šä½¿ç”¨Bootstrap 5ï¼Œç•Œé¢ç¾è§‚å‹å¥½</li>
<li><strong>å®æ—¶æ•°æ®é¢„è§ˆ</strong>ï¼šéšæ—¶æŸ¥çœ‹æ•°æ®å˜åŒ–</li>
<li><strong>æ“ä½œç»“æœåé¦ˆ</strong>ï¼šæ¯æ¬¡æ“ä½œéƒ½æœ‰æ˜ç¡®çš„æˆåŠŸ&#x2F;å¤±è´¥æç¤º</li>
<li><strong>æ“ä½œå†å²è®°å½•</strong>ï¼šæ‰€æœ‰æ“ä½œéƒ½è¢«è®°å½•ï¼Œæ–¹ä¾¿è¿½æº¯</li>
<li><strong>æ™ºèƒ½å»ºè®®</strong>ï¼šæ ¹æ®æ•°æ®ç‰¹å¾æä¾›å¤„ç†å»ºè®®</li>
</ol>
<h2 id="ğŸ“Š-ä½¿ç”¨ç¤ºä¾‹"><a href="#ğŸ“Š-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ğŸ“Š ä½¿ç”¨ç¤ºä¾‹"></a>ğŸ“Š <strong>ä½¿ç”¨ç¤ºä¾‹</strong></h2><p>python</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># ç¨‹åºåŒ–APIä½¿ç”¨ç¤ºä¾‹ï¼ˆé™¤äº†Webç•Œé¢ï¼Œè¿˜å¯ä»¥é€šè¿‡Python APIä½¿ç”¨ï¼‰</span><br><span class="line">cleaner = DataCleaner()</span><br><span class="line">cleaner.load_data(&quot;data.csv&quot;)</span><br><span class="line">cleaner.handle_missing_values(strategy=&#x27;median&#x27;)</span><br><span class="line">cleaner.normalize_column(&#x27;salary&#x27;, method=&#x27;minmax&#x27;)</span><br><span class="line">cleaner.save_to_bytes(&#x27;csv&#x27;)</span><br></pre></td></tr></table></figure>



<h2 id="ğŸ”§-æŠ€æœ¯æ¶æ„"><a href="#ğŸ”§-æŠ€æœ¯æ¶æ„" class="headerlink" title="ğŸ”§ æŠ€æœ¯æ¶æ„"></a>ğŸ”§ <strong>æŠ€æœ¯æ¶æ„</strong></h2><ol>
<li><strong>åç«¯</strong>ï¼šFlask + Pandas + NumPy</li>
<li><strong>å‰ç«¯</strong>ï¼šHTML5 + JavaScript + Bootstrap 5 + Axios</li>
<li><strong>æ•°æ®å¤„ç†</strong>ï¼šPandasæä¾›å¼ºå¤§çš„æ•°æ®æ“ä½œèƒ½åŠ›</li>
<li><strong>å¯è§†åŒ–</strong>ï¼šå†…ç½®æ•°æ®ç»Ÿè®¡å’Œå¯è§†åŒ–åŠŸèƒ½</li>
<li><strong>æ–‡ä»¶å¤„ç†</strong>ï¼šæ”¯æŒå¤šç§æ•°æ®æ ¼å¼</li>
</ol>
<p>è¿™ä¸ªWebå·¥å…·æ—¢é€‚åˆæ•°æ®åˆ†æå¸ˆè¿›è¡Œé«˜æ•ˆçš„æ•°æ®æ¸…æ´—ï¼Œä¹Ÿé€‚åˆéæŠ€æœ¯ç”¨æˆ·é€šè¿‡å‹å¥½çš„ç•Œé¢è¿›è¡Œæ“ä½œã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨æµè§ˆå™¨ä¸­å®Œæˆï¼Œæ— éœ€å®‰è£…ä»»ä½•é¢å¤–è½¯ä»¶ã€‚</p>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css">
    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/post/8bc3f557.html" rel="prev" title="JavaScriptæ—¥è®°æœ¬è®¾è®¡ä¸å®ç°">
                  <i class="fa fa-angle-left"></i> JavaScriptæ—¥è®°æœ¬è®¾è®¡ä¸å®ç°
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa-regular fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder"></span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="Word count total">368k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">22:18</span>
  </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.9.0/mermaid.min.js","integrity":"sha256-stuqcu2FrjYCXDOytWFA5SoUE/r3nkp6gTglzNSlavU="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>

  <script class="next-config" data-name="wavedrom" type="application/json">{"enable":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.5.0/wavedrom.min.js","integrity":"sha256-INLAoJc6quTNfiMWkGZniYO2cxE8mHpddnLow1m6RFs="}}</script>
  <script class="next-config" data-name="wavedrom_skin" type="application/json">{"enable":true,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/wavedrom/3.5.0/skins/default.js","integrity":"sha256-fduc/Zszk5ezWws2uInY/ALWVmIrmV6VTgXbsYSReFI="}}</script>
  <script src="/js/third-party/tags/wavedrom.js"></script>




  





</body>
</html>
